import{r as u,j as a,s as ee,e as q,l as R}from"./index-BqTI3VMm.js";const ae=function(){const M=u.useRef(null),z=u.useRef(0),m=u.useRef(new Map),y=u.useRef([]),_=u.useRef([]),v=u.useRef([]),[S,L]=u.useState(!0),[p,E]=u.useState(1),[F,B]=u.useState(.5),[l,$]=u.useState("network"),[w,I]=u.useState("load"),[j,P]=u.useState("round_robin"),[C,D]=u.useState(!0),[b,k]=u.useState("normal"),c={network:{bg:"#001122",text:"#00CCFF",load:"#FFAA00",error:"#FF4444",success:"#44FF44",data:"#8844FF"},traffic:{bg:"#110011",text:"#FFFFFF",load:"#FF8800",error:"#FF0000",success:"#00FF00",data:"#0088FF"},neon:{bg:"#000000",text:"#00FFFF",load:"#FF00FF",error:"#FF4040",success:"#40FF40",data:"#4040FF"},classic:{bg:"#000011",text:"#00FF00",load:"#FFFF00",error:"#FF0000",success:"#00AA00",data:"#0000FF"}};return u.useEffect(()=>{const i=new Map;[{name:"WEB-01",x:70,y:8},{name:"WEB-02",x:70,y:15},{name:"WEB-03",x:70,y:22},{name:"WEB-04",x:70,y:29},{name:"API-01",x:85,y:12},{name:"API-02",x:85,y:20}].forEach(g=>{i.set(g.name,{id:g.name,name:g.name,x:g.x,y:g.y,load:Math.random()*50,health:.8+Math.random()*.2,response_time:50+Math.random()*100,connections:Math.floor(Math.random()*20),status:"healthy",queue_size:0,max_connections:50+Math.floor(Math.random()*50),alert_flash:0})}),m.current=i,y.current=[{id:"LB-PRIMARY",x:45,y:18,algorithm:"round_robin",total_requests:0,requests_per_second:0,failed_requests:0,active_connections:0,status:"active"},{id:"LB-BACKUP",x:45,y:25,algorithm:"least_connections",total_requests:0,requests_per_second:0,failed_requests:0,active_connections:0,status:"failover"}],v.current=[{id:"WEB-USERS",x:10,y:10,request_rate:2,is_active:!0,type:"web"},{id:"MOBILE-APP",x:10,y:16,request_rate:3,is_active:!0,type:"mobile"},{id:"API-CLIENTS",x:10,y:22,request_rate:1.5,is_active:!0,type:"api"},{id:"BOTS",x:10,y:28,request_rate:.5,is_active:!0,type:"bot"}]},[]),u.useEffect(()=>{const i=M.current;if(!i)return;const r=i.getContext("2d");if(!r)return;const g=()=>{i.width=i.offsetWidth,i.height=i.offsetHeight};let N=0,T=0;const H=s=>{const t=Array.from(m.current.values()).filter(e=>e.status!=="down");if(t.length===0)return null;switch(j){case"round_robin":const e=t[N%t.length];return N++,e;case"least_connections":return t.reduce((h,f)=>f.connections<h.connections?f:h);case"weighted":const n=t.filter(h=>h.health>.5);return n.length>0?n[Math.floor(Math.random()*n.length)]:t[0];case"health_based":const o=t.filter(h=>h.health>.7&&h.load<80);return o.length>0?o[Math.floor(Math.random()*o.length)]:t[0];default:return t[0]}},W=()=>{const s=y.current.find(t=>t.status==="active");if(s&&(v.current.forEach(t=>{if(!t.is_active)return;let n=t.request_rate*F*p;if(b==="traffic_spike"?n*=3:b==="ddos_attack"?t.type==="bot"&&(n*=10):b==="low_traffic"&&(n*=.3),Math.random()<n*.1){T++;const o=H();o&&(_.current.push({id:`req-${T}`,source_x:t.x,source_y:t.y,target_x:s.x,target_y:s.y,current_x:t.x,current_y:t.y,progress:0,type:"request",size:1+Math.floor(Math.random()*3),server_id:o.id}),s.total_requests++,s.requests_per_second++)}}),C&&Math.random()<.05*p)){const t=y.current.find(e=>e.status==="active");t&&m.current.forEach(e=>{_.current.push({id:`health-${Date.now()}-${e.id}`,source_x:t.x,source_y:t.y,target_x:e.x,target_y:e.y,current_x:t.x,current_y:t.y,progress:0,type:"health_check",size:1,server_id:e.id})})}},O=()=>{const s=m.current,t=Date.now()/1e3;s.forEach(e=>{const n=20+30*ee(t*.1+e.x*.01),o=e.connections/e.max_connections*50;e.load=q(n+o+(Math.random()-.5)*10,0,100),e.load>80?e.health=Math.max(.1,e.health-.01):e.health=Math.min(1,e.health+.005),e.response_time=30+e.load*2+(Math.random()-.5)*20,e.response_time=q(e.response_time,10,500),e.health<.2?(e.status="down",e.alert_flash=Math.max(e.alert_flash,20)):e.load>90||e.health<.5?(e.status="overloaded",e.alert_flash=Math.max(e.alert_flash,10)):e.load>70||e.health<.7?(e.status="degraded",e.alert_flash=Math.max(e.alert_flash,5)):e.status="healthy",e.alert_flash>0&&e.alert_flash--,e.queue_size=Math.max(0,e.queue_size+(Math.random()-.8)*2)})},U=()=>{const s=.03*p;_.current.forEach(t=>{if(t.progress+=s,t.current_x=R(t.source_x,t.target_x,t.progress),t.current_y=R(t.source_y,t.target_y,t.progress),t.progress>=1){if(t.type==="request"&&t.server_id){const e=m.current.get(t.server_id),n=y.current.find(o=>o.status==="active");e&&n&&(e.connections++,_.current.push({id:`fwd-${t.id}`,source_x:n.x,source_y:n.y,target_x:e.x,target_y:e.y,current_x:n.x,current_y:n.y,progress:0,type:"request",size:t.size,server_id:e.id}))}else if(t.type==="request"&&t.target_x>60){const e=m.current.get(t.server_id||""),n=y.current.find(o=>o.status==="active");if(e&&n){const o=Math.random()>.05&&e.status!=="down";o||n.failed_requests++,setTimeout(()=>{_.current.push({id:`resp-${t.id}`,source_x:e.x,source_y:e.y,target_x:n.x,target_y:n.y,current_x:e.x,current_y:e.y,progress:0,type:o?"response":"error",size:t.size,server_id:e.id})},e.response_time),e.connections=Math.max(0,e.connections-1)}}else if(t.type==="health_check"&&t.server_id){const e=m.current.get(t.server_id);if(e){const n=y.current.find(o=>o.status==="active");n&&_.current.push({id:`health-resp-${t.id}`,source_x:e.x,source_y:e.y,target_x:n.x,target_y:n.y,current_x:e.x,current_y:e.y,progress:0,type:e.status==="healthy"?"response":"error",size:1})}}}}),_.current=_.current.filter(t=>t.progress<1)},Y=s=>{const e=s.x,n=s.y;let o="👥";s.type==="mobile"?o="📱":s.type==="api"?o="🔌":s.type==="bot"&&(o="🤖"),r.fillStyle=s.is_active?c[l].text:c[l].text+"60",r.fillText(`${o} ${s.id}`,e*10,n*10),r.fillText(`Rate: ${s.request_rate.toFixed(1)} req/s`,e*10,(n+1)*10)},K=s=>{const e=s.x,n=s.y;let o=c[l].success;s.status==="failover"?o=c[l].load:s.status==="maintenance"&&(o=c[l].error),r.fillStyle=o,["┌─────────┐","│ ⚖️  LB   │","│ ←→←→←→  │","│ BALANCE │","└─────────┘"].forEach((f,d)=>{r.fillText(f,e*10,(n+d-2)*10)}),r.fillStyle=c[l].text,r.fillText(s.id,e*10,(n-3)*10),r.fillText(`${s.status.toUpperCase()}`,(e+12)*10,(n-3)*10),r.fillText(`RPS: ${s.requests_per_second}`,e*10,(n+4)*10),r.fillText(`Fails: ${s.failed_requests}`,e*10,(n+5)*10)},G=s=>{const e=s.x,n=s.y;let o=c[l].success;s.status==="down"||s.status==="overloaded"?o=c[l].error:s.status==="degraded"&&(o=c[l].load),s.alert_flash>0&&s.alert_flash%6<3?r.fillStyle=s.status==="down"?"#FF0000":"#FFAA00":r.fillStyle=o,["┌─────┐","│ ███ │","│ ○○○ │","└─────┘"].forEach((X,Z)=>{r.fillText(X,e*10,(n+Z-1)*10)}),r.fillStyle=c[l].text,r.fillText(s.name,e*10,(n-2)*10);const f=s.status==="healthy"?"●":s.status==="degraded"?"▲":s.status==="overloaded"?"■":"✕";r.fillStyle=o,r.fillText(f,(e+8)*10,(n-2)*10);let d=0,x="";switch(w){case"load":d=s.load,x=`Load: ${d.toFixed(1)}%`;break;case"connections":d=s.connections,x=`Conn: ${d}/${s.max_connections}`;break;case"health":d=s.health*100,x=`Health: ${d.toFixed(1)}%`;break;case"response_time":d=s.response_time,x=`RT: ${d.toFixed(0)}ms`;break}r.fillStyle=c[l].text,r.fillText(x,e*10,(n+4)*10)},J=()=>{_.current.forEach(t=>{let e="●",n=c[l].data;t.type==="request"?(e="→",n=c[l].text):t.type==="response"?(e="←",n=c[l].success):t.type==="error"?(e="✕",n=c[l].error):t.type==="health_check"&&(e="♥",n=c[l].load),r.fillStyle=n,r.fillText(e,t.current_x*10,t.current_y*10)})},Q=()=>{const t=y.current.find(e=>e.status==="active");t&&(r.strokeStyle=c[l].text+"40",r.lineWidth=1,r.setLineDash([2,2]),v.current.forEach(e=>{e.is_active&&(r.beginPath(),r.moveTo(e.x*10+100,e.y*10),r.lineTo(t.x*10,(t.y+1)*10),r.stroke())}),m.current.forEach(e=>{e.status!=="down"&&(r.beginPath(),r.moveTo((t.x+10)*10,(t.y+1)*10),r.lineTo(e.x*10,(e.y+1)*10),r.stroke())}),r.setLineDash([]))},V=()=>{const s=y.current.find(d=>d.status==="active"),t=Array.from(m.current.values()),e=t.reduce((d,x)=>d+x.connections,0),n=t.reduce((d,x)=>d+x.load,0)/t.length,o=t.filter(d=>d.status==="healthy").length,h=t.reduce((d,x)=>d+x.response_time,0)/t.length;r.fillStyle=c[l].text;const f=i.height-100;r.fillText("┌─ LOAD BALANCER DASHBOARD ─┐",10,f),r.fillText(`│ Algorithm: ${j.toUpperCase()} | Mode: ${b}`,10,f+15),r.fillText(`│ Total Connections: ${e} | Avg Load: ${n.toFixed(1)}%`,10,f+30),r.fillText(`│ Healthy Servers: ${o}/${t.length} | Avg Response: ${h.toFixed(0)}ms`,10,f+45),s&&r.fillText(`│ Requests: ${s.total_requests} | RPS: ${s.requests_per_second} | Failures: ${s.failed_requests}`,10,f+60),r.fillText("└─────────────────────────────┘",10,f+75)},A=()=>{if(!S)return;const s=c[l];r.fillStyle=s.bg,r.fillRect(0,0,i.width,i.height),r.font='10px "Courier New", monospace',r.textBaseline="top",W(),U(),Math.random()<.1*p&&O(),Math.random()<.02&&y.current.forEach(t=>{t.requests_per_second=0}),Q(),v.current.forEach(t=>Y(t)),y.current.forEach(t=>K(t)),m.current.forEach(t=>G(t)),J(),V(),z.current=requestAnimationFrame(A)};return g(),window.addEventListener("resize",g),S&&A(),()=>{window.removeEventListener("resize",g),z.current&&cancelAnimationFrame(z.current)}},[S,p,F,l,w,j,C,b]),a.jsxs("div",{className:"flex flex-col h-screen bg-black",children:[a.jsxs("div",{className:"flex-shrink-0 bg-gray-900 p-4 border-b border-gray-700",children:[a.jsx("h1",{className:"text-2xl font-bold text-cyan-400 mb-4",children:"⚖️ ASCII Load Balancer Traffic Monitor"}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 text-sm mb-4",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-cyan-300 mb-2",children:"Animation"}),a.jsx("button",{onClick:()=>L(!S),className:`px-3 py-2 rounded font-medium transition-colors ${S?"bg-red-600 hover:bg-red-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,children:S?"Pause":"Play"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"text-cyan-300 mb-2",children:["Speed: ",p.toFixed(1),"x"]}),a.jsx("input",{type:"range",min:"0.1",max:"3",step:"0.1",value:p,onChange:i=>E(Number.parseFloat(i.target.value)),className:"w-full"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"text-cyan-300 mb-2",children:["Traffic: ",Math.round(F*100),"%"]}),a.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:F,onChange:i=>B(Number.parseFloat(i.target.value)),className:"w-full"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-cyan-300 mb-2",children:"Algorithm"}),a.jsxs("select",{value:j,onChange:i=>P(i.target.value),className:"px-2 py-1 bg-gray-800 text-cyan-300 rounded border border-gray-600",children:[a.jsx("option",{value:"round_robin",children:"Round Robin"}),a.jsx("option",{value:"least_connections",children:"Least Connections"}),a.jsx("option",{value:"weighted",children:"Weighted"}),a.jsx("option",{value:"health_based",children:"Health Based"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-cyan-300 mb-2",children:"Display Mode"}),a.jsxs("select",{value:w,onChange:i=>I(i.target.value),className:"px-2 py-1 bg-gray-800 text-cyan-300 rounded border border-gray-600",children:[a.jsx("option",{value:"load",children:"Server Load"}),a.jsx("option",{value:"connections",children:"Connections"}),a.jsx("option",{value:"health",children:"Health"}),a.jsx("option",{value:"response_time",children:"Response Time"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-cyan-300 mb-2",children:"Simulation"}),a.jsxs("select",{value:b,onChange:i=>k(i.target.value),className:"px-2 py-1 bg-gray-800 text-cyan-300 rounded border border-gray-600",children:[a.jsx("option",{value:"normal",children:"Normal Traffic"}),a.jsx("option",{value:"traffic_spike",children:"Traffic Spike"}),a.jsx("option",{value:"ddos_attack",children:"DDoS Attack"}),a.jsx("option",{value:"low_traffic",children:"Low Traffic"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-cyan-300 mb-2",children:"Color Scheme"}),a.jsxs("select",{value:l,onChange:i=>$(i.target.value),className:"px-2 py-1 bg-gray-800 text-cyan-300 rounded border border-gray-600",children:[a.jsx("option",{value:"network",children:"Network Blue"}),a.jsx("option",{value:"traffic",children:"Traffic Light"}),a.jsx("option",{value:"neon",children:"Neon"}),a.jsx("option",{value:"classic",children:"Classic Terminal"})]})]}),a.jsx("div",{className:"flex flex-col",children:a.jsxs("label",{className:"flex items-center text-cyan-300 text-xs",children:[a.jsx("input",{type:"checkbox",checked:C,onChange:i=>D(i.target.checked),className:"mr-1"}),"Health Checks"]})})]}),a.jsxs("div",{className:"mt-4 text-cyan-400 text-sm",children:[a.jsxs("p",{children:["⚖️ ",a.jsx("strong",{children:"Real-time load balancer monitoring"})," with multiple distribution algorithms!"]}),a.jsxs("p",{children:["📊 ",a.jsx("strong",{children:"Watch traffic flow"})," from clients through load balancers to backend servers!"]}),a.jsxs("p",{children:["🔧 ",a.jsx("strong",{children:"Test different algorithms"})," and simulate traffic spikes, DDoS attacks, and failover scenarios!"]}),a.jsx("p",{children:"Monitor server health, response times, and connection distribution in real-time ASCII visualization"})]})]}),a.jsx("div",{className:"flex-1 relative",children:a.jsx("canvas",{ref:M,className:"absolute inset-0 w-full h-full",style:{background:c[l].bg}})})]})};export{ae as component};
