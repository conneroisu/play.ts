import{r as p,j as s,L as U,v as j,l as B,f as q,g as F,i as A,e as O,d as X,h as _,T as k,k as H,s as J}from"./index-BqTI3VMm.js";const Z=function(){const g=p.useRef(null),b=p.useRef(),u=p.useRef({x:0,y:0,down:!1,radius:50}),[v,S]=p.useState(!1),[x,M]=p.useState([]),[N,P]=p.useState([]),[a,y]=p.useState({gravity:.5,damping:.99,iterations:3,stiffness:.8,pressure:.1,showConstraints:!0,showPoints:!0,colorMode:"pressure"}),L=(n,e,t,h)=>{const i=[],c=[];for(let r=0;r<h;r++){const d=r/h*k,l=n+H(d)*t,o=e+J(d)*t;i.push({x:l,y:o,oldX:l,oldY:o,pinned:!1,id:r})}for(let r=0;r<h;r++){const d=i[r],l=i[(r+1)%h],o=j(d,l);c.push({p1:d,p2:l,restLength:o,stiffness:a.stiffness})}for(let r=0;r<h;r++){const d=i[r],l=i[(r+2)%h],o=j(d,l);c.push({p1:d,p2:l,restLength:o,stiffness:a.stiffness*.5})}return{points:i,constraints:c}},T=(n,e,t,h,i)=>{const c=[],r=[];for(let d=0;d<=i;d++){const l=d/i,o=B(n,t,l),m=B(e,h,l);c.push({x:o,y:m,oldX:o,oldY:m,pinned:d===0||d===i,id:d})}for(let d=0;d<i;d++){const l=c[d],o=c[d+1],m=j(l,o);r.push({p1:l,p2:o,restLength:m,stiffness:a.stiffness})}return{points:c,constraints:r}},D=(n,e,t,h,i,c)=>{const r=[],d=[];for(let l=0;l<=c;l++)for(let o=0;o<=i;o++){const m=n+o/i*t,f=e+l/c*h;r.push({x:m,y:f,oldX:m,oldY:f,pinned:l===0&&(o===0||o===i),id:l*(i+1)+o})}for(let l=0;l<=c;l++)for(let o=0;o<i;o++){const m=r[l*(i+1)+o],f=r[l*(i+1)+o+1],C=j(m,f);d.push({p1:m,p2:f,restLength:C,stiffness:a.stiffness})}for(let l=0;l<c;l++)for(let o=0;o<=i;o++){const m=r[l*(i+1)+o],f=r[(l+1)*(i+1)+o],C=j(m,f);d.push({p1:m,p2:f,restLength:C,stiffness:a.stiffness})}return{points:r,constraints:d}},I=()=>{const n=g.current;if(n){x.forEach(e=>{if(e.pinned)return;const t=(e.x-e.oldX)*a.damping,h=(e.y-e.oldY)*a.damping;e.oldX=e.x,e.oldY=e.y,e.x+=t,e.y+=h+a.gravity,e.x<10&&(e.x=10,e.oldX=e.x+t*.8),e.x>n.width-10&&(e.x=n.width-10,e.oldX=e.x+t*.8),e.y<10&&(e.y=10,e.oldY=e.y+h*.8),e.y>n.height-10&&(e.y=n.height-10,e.oldY=e.y+h*.8)}),u.current.down&&x.forEach(e=>{const t=j(e,u.current);if(t<u.current.radius){const h=(u.current.radius-t)/u.current.radius,i=q(F(e,u.current)),c=A(i,h*10);e.x+=c.x,e.y+=c.y}});for(let e=0;e<a.iterations;e++)N.forEach(t=>{const h=F(t.p2,t.p1),i=j(t.p1,t.p2),c=(t.restLength-i)/i,r=A(h,c*t.stiffness*.5);t.p1.pinned||(t.p1.x-=r.x,t.p1.y-=r.y),t.p2.pinned||(t.p2.x+=r.x,t.p2.y+=r.y)})}},Y=()=>{const n=g.current,e=n==null?void 0:n.getContext("2d");if(!(!n||!e)){if(e.clearRect(0,0,n.width,n.height),a.showConstraints&&(e.strokeStyle="rgba(100, 100, 100, 0.3)",e.lineWidth=1,N.forEach(t=>{e.beginPath(),e.moveTo(t.p1.x,t.p1.y),e.lineTo(t.p2.x,t.p2.y),e.stroke()})),x.length>0&&(e.fillStyle=(a.colorMode==="solid","rgba(100, 150, 255, 0.7)"),e.strokeStyle="#4A90E2",e.lineWidth=2,x.length<=20)){e.beginPath(),e.moveTo(x[0].x,x[0].y);for(let t=1;t<x.length;t++)e.lineTo(x[t].x,x[t].y);if(e.closePath(),a.colorMode==="pressure"){let t=0;for(let c=0;c<x.length;c++){const r=(c+1)%x.length;t+=x[c].x*x[r].y-x[r].x*x[c].y}t=Math.abs(t)/2;const h=O(1-t/1e4,0,1),i=X(_(h*60,80,60));e.fillStyle=`rgba(${i.r}, ${i.g}, ${i.b}, 0.7)`}e.fill(),e.stroke()}a.showPoints&&x.forEach(t=>{e.fillStyle=t.pinned?"#FF6B6B":"#4ECDC4",e.beginPath(),e.arc(t.x,t.y,t.pinned?6:4,0,k),e.fill()}),u.current.down&&(e.strokeStyle="rgba(255, 255, 255, 0.5)",e.lineWidth=2,e.beginPath(),e.arc(u.current.x,u.current.y,u.current.radius,0,k),e.stroke())}},E=()=>{I(),Y(),v&&(b.current=requestAnimationFrame(E))},W=()=>{S(!0)},V=()=>{S(!1),b.current&&cancelAnimationFrame(b.current)},z=()=>{M([]),P([])},w=n=>{const e=g.current;if(!e)return;let t;switch(n){case"blob":t=L(e.width/2,e.height/3,80,12);break;case"rope":t=T(100,100,e.width-100,100,20);break;case"cloth":t=D(e.width/2-100,50,200,150,8,6);break}M(t.points),P(t.constraints)},G=n=>{const e=g.current;if(!e)return;const t=e.getBoundingClientRect();u.current.x=n.clientX-t.left,u.current.y=n.clientY-t.top,u.current.down=!0},$=n=>{const e=g.current;if(!e)return;const t=e.getBoundingClientRect();u.current.x=n.clientX-t.left,u.current.y=n.clientY-t.top},R=()=>{u.current.down=!1};return p.useEffect(()=>{const n=g.current;if(n)return n.width=800,n.height=600,w("blob"),()=>{b.current&&cancelAnimationFrame(b.current)}},[]),p.useEffect(()=>(v&&E(),()=>{b.current&&cancelAnimationFrame(b.current)}),[v,a]),p.useEffect(()=>{N.forEach(n=>{n.stiffness=a.stiffness})},[a.stiffness,N]),s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Verlet Integration Soft Body Physics"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Three body types with interactive manipulation, real-time physics parameters, and pressure visualization."}),s.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:s.jsx("p",{className:"text-purple-800",children:"üéà Interactive physics simulation - drag to push objects, watch realistic deformation"})})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[s.jsx("button",{type:"button",onClick:W,disabled:v,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 transition-colors",children:v?"Running...":"Start Simulation"}),s.jsx("button",{type:"button",onClick:V,disabled:!v,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 transition-colors",children:"Stop Simulation"}),s.jsx("button",{type:"button",onClick:z,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:"Reset"})]}),s.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[s.jsx("button",{type:"button",onClick:()=>w("blob"),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Create Blob"}),s.jsx("button",{type:"button",onClick:()=>w("rope"),className:"px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 transition-colors",children:"Create Rope"}),s.jsx("button",{type:"button",onClick:()=>w("cloth"),className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",children:"Create Cloth"})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Gravity: ",a.gravity.toFixed(2)]}),s.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:a.gravity,onChange:n=>y(e=>({...e,gravity:Number(n.target.value)})),className:"w-full"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Damping: ",a.damping.toFixed(3)]}),s.jsx("input",{type:"range",min:"0.9",max:"0.999",step:"0.001",value:a.damping,onChange:n=>y(e=>({...e,damping:Number(n.target.value)})),className:"w-full"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Stiffness: ",a.stiffness.toFixed(2)]}),s.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:a.stiffness,onChange:n=>y(e=>({...e,stiffness:Number(n.target.value)})),className:"w-full"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Iterations: ",a.iterations]}),s.jsx("input",{type:"range",min:"1",max:"10",step:"1",value:a.iterations,onChange:n=>y(e=>({...e,iterations:Number(n.target.value)})),className:"w-full"})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:a.showConstraints,onChange:n=>y(e=>({...e,showConstraints:n.target.checked})),className:"mr-2"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Show Constraints"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:a.showPoints,onChange:n=>y(e=>({...e,showPoints:n.target.checked})),className:"mr-2"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Show Points"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Color Mode"}),s.jsxs("select",{value:a.colorMode,onChange:n=>y(e=>({...e,colorMode:n.target.value})),className:"px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"solid",children:"Solid Color"}),s.jsx("option",{value:"pressure",children:"Pressure Based"}),s.jsx("option",{value:"velocity",children:"Velocity Based"})]})]})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("canvas",{ref:g,className:"border border-gray-300 rounded-lg bg-gray-50 cursor-crosshair",style:{maxWidth:"100%",height:"auto"},onMouseDown:G,onMouseMove:$,onMouseUp:R,onMouseLeave:R}),s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Click and drag to interact with the soft bodies"})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2 text-blue-800",children:"Physics Concepts"}),s.jsxs("ul",{className:"text-blue-700 space-y-1",children:[s.jsxs("li",{children:["‚Ä¢ ",s.jsx("strong",{children:"Verlet Integration"}),": Position-based dynamics for stability"]}),s.jsxs("li",{children:["‚Ä¢ ",s.jsx("strong",{children:"Constraint Satisfaction"}),": Iterative relaxation method"]}),s.jsxs("li",{children:["‚Ä¢ ",s.jsx("strong",{children:"Mass-Spring System"}),": Network of connected particles"]}),s.jsxs("li",{children:["‚Ä¢ ",s.jsx("strong",{children:"Collision Response"}),": Boundary and object interaction"]})]})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2 text-green-800",children:"Simulation Features"}),s.jsxs("ul",{className:"text-green-700 space-y-1",children:[s.jsxs("li",{children:["‚Ä¢ ",s.jsx("strong",{children:"Multiple Body Types"}),": Blobs, ropes, cloth simulation"]}),s.jsxs("li",{children:["‚Ä¢ ",s.jsx("strong",{children:"Interactive Forces"}),": Mouse-based object manipulation"]}),s.jsxs("li",{children:["‚Ä¢ ",s.jsx("strong",{children:"Real-time Parameters"}),": Adjustable physics properties"]}),s.jsxs("li",{children:["‚Ä¢ ",s.jsx("strong",{children:"Visual Feedback"}),": Pressure and constraint visualization"]})]})]})]}),s.jsxs("div",{className:"mt-6 bg-purple-50 border border-purple-200 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2 text-purple-800",children:"Applications"}),s.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-purple-700",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Game Development:"}),s.jsxs("ul",{className:"text-sm mt-1",children:[s.jsx("li",{children:"‚Ä¢ Character animation"}),s.jsx("li",{children:"‚Ä¢ Environmental effects"}),s.jsx("li",{children:"‚Ä¢ Destructible objects"})]})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Computer Graphics:"}),s.jsxs("ul",{className:"text-sm mt-1",children:[s.jsx("li",{children:"‚Ä¢ Fluid simulation"}),s.jsx("li",{children:"‚Ä¢ Cloth simulation"}),s.jsx("li",{children:"‚Ä¢ Deformable surfaces"})]})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Scientific Modeling:"}),s.jsxs("ul",{className:"text-sm mt-1",children:[s.jsx("li",{children:"‚Ä¢ Material science"}),s.jsx("li",{children:"‚Ä¢ Biomechanics"}),s.jsx("li",{children:"‚Ä¢ Engineering analysis"})]})]})]})]}),s.jsx("div",{className:"mt-6",children:s.jsx(U,{to:"/examples/visual",className:"inline-block px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"‚Üê Back to Examples"})})]})};export{Z as component};
