import{r as y,j as t,P as j,b as te,s as M,k as se}from"./index-BqTI3VMm.js";const oe=function(){const D=y.useRef(null),E=y.useRef(null),S=y.useRef(),k=y.useRef(0),[F,R]=y.useState(!1),[i,P]=y.useState({time:[],displacement:[],velocity:[],acceleration:[],force:[],energy:[]}),[m,v]=y.useState({mass:10,stiffness:1e4,damping:100,naturalFrequency:0,dampingRatio:0,dampedFrequency:0,criticalDamping:0}),[g,N]=y.useState({type:"harmonic",amplitude:100,frequency:5,phase:0,duration:10,enabled:!0}),[c,w]=y.useState({timeStep:.001,duration:5,samplingRate:1e3,freqRangeMin:.1,freqRangeMax:100,showDisplacement:!0,showVelocity:!1,showAcceleration:!1,showForce:!1,showFFT:!0,showTransmissibility:!1,logScale:!1,autoScale:!0,gridEnabled:!0}),[ae,ie]=y.useState("forced"),[_,H]=y.useState("sdof"),[le,I]=y.useState(null),W=(s,e,r)=>{const o=Math.sqrt(e/s)/(2*j),d=2*Math.sqrt(s*e),l=r/d,u=o*Math.sqrt(1-l*l);return{mass:s,stiffness:e,damping:r,naturalFrequency:o,dampingRatio:l,dampedFrequency:u>0?u:0,criticalDamping:d}},z=s=>{if(!g.enabled||s>g.duration)return 0;const e=2*j*g.frequency,r=g.phase*j/180;switch(g.type){case"harmonic":return g.amplitude*M(e*s+r);case"impulse":return s<c.timeStep?g.amplitude/c.timeStep:0;case"step":return s>1?g.amplitude:0;case"chirp":const o=.1,l=o+(50-o)*s/g.duration;return g.amplitude*M(2*j*l*s);case"impact":const u=.01;return s<=u?g.amplitude*M(j*s/u):0;case"random":return g.amplitude*te(-1,1);default:return 0}},L=(s,e)=>{const{mass:r,stiffness:o,damping:d}=m,l=c.timeStep,u=.5,h=.25,p=(e-d*s.v-o*s.x)/r,a=s.v+l*((1-u)*s.a+u*p),n=s.x+l*s.v+l*l*((.5-h)*s.a+h*p),x=(e-d*a-o*n)/r;return{x:n,v:a,a:x}},O=()=>{const s=[],e=[],r=[],o=[],{mass:d,stiffness:l,damping:u,naturalFrequency:h}=m,p=200;for(let a=0;a<p;a++){const n=c.freqRangeMin+a/(p-1)*(c.freqRangeMax-c.freqRangeMin),x=2*j*n,f=2*j*h,T=m.dampingRatio,b=x/f,C=l*(1-b*b),A=u*x,J=C*C+A*A,K=1/Math.sqrt(J/(l*l)),Q=-Math.atan2(A,C)*180/j,Z=Math.sqrt(1+2*T*b*(2*T*b)),V=Math.sqrt((1-b*b)*(1-b*b)+2*T*b*(2*T*b)),ee=V>0?Z/V:0;s.push(n),e.push(K),r.push(Q),o.push(ee)}return{frequencies:s,magnitude:e,phase:r,transmissibility:o}},Y=s=>{const e=Math.min(s.length,1024),r=[],o=[];for(let d=0;d<e/2;d++){let l=0,u=0;for(let p=0;p<e;p++){const a=-2*j*d*p/e;l+=s[p]*se(a),u+=s[p]*M(a)}const h=Math.sqrt(l*l+u*u)/e;r.push(h),o.push(d*c.samplingRate/e)}return{frequencies:o,magnitude:r}},B=()=>{if(!F)return;const s=k.current,e=c.timeStep,r=i.time.length-1,o={x:r>=0?i.displacement[r]:0,v:r>=0?i.velocity[r]:0,a:r>=0?i.acceleration[r]:0},d=z(s),l=L(o,d),u=.5*m.mass*l.v*l.v,h=.5*m.stiffness*l.x*l.x,p=u+h;P(a=>{const n=Math.floor(c.duration/c.timeStep);return{time:[...a.time.slice(-n),s],displacement:[...a.displacement.slice(-n),l.x],velocity:[...a.velocity.slice(-n),l.v],acceleration:[...a.acceleration.slice(-n),l.a],force:[...a.force.slice(-n),d],energy:[...a.energy.slice(-n),p]}}),k.current+=e,s>=c.duration&&R(!1)},$=()=>{R(!1),k.current=0,P({time:[],displacement:[],velocity:[],acceleration:[],force:[],energy:[]})},U=s=>{switch(s){case"automotive_suspension":v(e=>({...e,mass:300,stiffness:2e4,damping:2e3})),N(e=>({...e,type:"random",amplitude:500,frequency:10}));break;case"machine_foundation":v(e=>({...e,mass:5e3,stiffness:1e6,damping:1e4})),N(e=>({...e,type:"harmonic",amplitude:2e3,frequency:25}));break;case"building_structure":v(e=>({...e,mass:1e5,stiffness:5e7,damping:1e5})),N(e=>({...e,type:"impact",amplitude:1e4,frequency:1}));break;case"rotating_machinery":v(e=>({...e,mass:50,stiffness:5e4,damping:200})),N(e=>({...e,type:"harmonic",amplitude:200,frequency:30}));break}},X=()=>{const s=D.current;if(!s)return;const e=s.getContext("2d");if(!e)return;const r=s.width,o=s.height;if(e.clearRect(0,0,r,o),i.time.length<2)return;const d=a=>{if(c.autoScale){const n=Math.min(...a),x=Math.max(...a),f=Math.abs(x-n)*.1;return{min:n-f,max:x+f}}return{min:-.01,max:.01}},l=Math.max(...i.time);if(c.gridEnabled){e.strokeStyle="rgba(200, 200, 200, 0.5)",e.lineWidth=1;for(let a=0;a<=l;a+=l/10){const n=a/l*r;e.beginPath(),e.moveTo(n,0),e.lineTo(n,o),e.stroke()}for(let a=0;a<=8;a++){const n=a/8*o;e.beginPath(),e.moveTo(0,n),e.lineTo(r,n),e.stroke()}}const u=a=>a/l*r,h=(a,n)=>o-(a-n.min)/(n.max-n.min)*o;if(c.showDisplacement){const a=d(i.displacement);e.strokeStyle="rgba(59, 130, 246, 1)",e.lineWidth=2,e.beginPath();for(let n=0;n<i.time.length;n++){const x=u(i.time[n]),f=h(i.displacement[n],a);n===0?e.moveTo(x,f):e.lineTo(x,f)}e.stroke()}if(c.showVelocity){const a=d(i.velocity);e.strokeStyle="rgba(34, 197, 94, 0.8)",e.lineWidth=2,e.beginPath();for(let n=0;n<i.time.length;n++){const x=u(i.time[n]),f=h(i.velocity[n],a);n===0?e.moveTo(x,f):e.lineTo(x,f)}e.stroke()}if(c.showAcceleration){const a=d(i.acceleration);e.strokeStyle="rgba(239, 68, 68, 0.8)",e.lineWidth=2,e.beginPath();for(let n=0;n<i.time.length;n++){const x=u(i.time[n]),f=h(i.acceleration[n],a);n===0?e.moveTo(x,f):e.lineTo(x,f)}e.stroke()}if(c.showForce){const a=d(i.force);e.strokeStyle="rgba(168, 85, 247, 0.8)",e.lineWidth=2,e.beginPath();for(let n=0;n<i.time.length;n++){const x=u(i.time[n]),f=h(i.force[n],a);n===0?e.moveTo(x,f):e.lineTo(x,f)}e.stroke()}e.fillStyle="rgba(0, 0, 0, 0.8)",e.font="12px monospace",e.textAlign="left";let p=20;c.showDisplacement&&(e.fillStyle="rgba(59, 130, 246, 1)",e.fillText("Displacement (m)",10,p),p+=20),c.showVelocity&&(e.fillStyle="rgba(34, 197, 94, 0.8)",e.fillText("Velocity (m/s)",10,p),p+=20),c.showAcceleration&&(e.fillStyle="rgba(239, 68, 68, 0.8)",e.fillText("Acceleration (m/s²)",10,p),p+=20),c.showForce&&(e.fillStyle="rgba(168, 85, 247, 0.8)",e.fillText("Force (N)",10,p))},G=()=>{const s=E.current;if(!s||!c.showFFT)return;const e=s.getContext("2d");if(!e)return;const r=s.width,o=s.height;if(e.clearRect(0,0,r,o),i.displacement.length<64)return;const d=Y(i.displacement);if(d.frequencies.length===0)return;const l=Math.max(...d.frequencies),u=Math.max(...d.magnitude);e.strokeStyle="rgba(59, 130, 246, 1)",e.lineWidth=2,e.beginPath();for(let h=0;h<d.frequencies.length;h++){const p=d.frequencies[h]/l*r,a=o-d.magnitude[h]/u*o;h===0?e.moveTo(p,a):e.lineTo(p,a)}if(e.stroke(),m.naturalFrequency>0){const h=m.naturalFrequency/l*r;e.strokeStyle="rgba(239, 68, 68, 0.8)",e.lineWidth=2,e.setLineDash([5,5]),e.beginPath(),e.moveTo(h,0),e.lineTo(h,o),e.stroke(),e.setLineDash([]),e.fillStyle="rgba(239, 68, 68, 0.8)",e.font="10px Arial",e.fillText(`fn=${m.naturalFrequency.toFixed(1)}Hz`,h+5,15)}e.fillStyle="black",e.font="12px Arial",e.textAlign="center",e.fillText("Frequency (Hz)",r/2,o-5),e.save(),e.translate(15,o/2),e.rotate(-j/2),e.fillText("Magnitude",0,0),e.restore()};y.useEffect(()=>{const s=W(m.mass,m.stiffness,m.damping);v(s);const e=O();I(e)},[m.mass,m.stiffness,m.damping]),y.useEffect(()=>{if(F){const s=setInterval(B,16);return()=>clearInterval(s)}},[F,m,g,c]),y.useEffect(()=>{const s=()=>{X(),G(),S.current=requestAnimationFrame(s)};return S.current=requestAnimationFrame(s),()=>{S.current&&cancelAnimationFrame(S.current)}},[i,c,m]);const q=(()=>{if(i.displacement.length<10)return null;const s=Math.sqrt(i.displacement.reduce((u,h)=>u+h*h,0)/i.displacement.length),e=Math.max(...i.displacement.map(Math.abs)),r=e/s;let o=i.time[i.time.length-1]||0;const d=i.displacement[i.displacement.length-1]||0,l=.02*Math.abs(d);for(let u=i.displacement.length-1;u>=0;u--)if(Math.abs(i.displacement[u]-d)>l){o=i.time[u];break}return{rms:s,peak:e,crestFactor:r,settlingTime:o,naturalFrequency:m.naturalFrequency,dampingRatio:m.dampingRatio,dampedFrequency:m.dampedFrequency}})();return t.jsx("div",{className:"w-full max-w-6xl mx-auto p-6 bg-gradient-to-br from-purple-50 to-indigo-50 min-h-screen",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[t.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-purple-500 to-indigo-500 rounded-full"}),t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Vibration Analysis & Modal Testing"}),t.jsx("div",{className:"text-sm text-gray-600 bg-gray-100 px-3 py-1 rounded-full",children:"Mechanical Engineering Tool"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"lg:col-span-2",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Time Domain Response"}),t.jsx("canvas",{ref:D,width:700,height:300,className:"border border-gray-300 rounded-lg bg-white w-full"})]}),c.showFFT&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Frequency Domain Analysis"}),t.jsx("canvas",{ref:E,width:700,height:250,className:"border border-gray-300 rounded-lg bg-white w-full"})]}),t.jsxs("div",{className:"flex gap-2 mb-4",children:[t.jsxs("button",{onClick:()=>R(!F),className:`px-4 py-2 rounded-lg font-medium ${F?"bg-red-500 text-white hover:bg-red-600":"bg-green-500 text-white hover:bg-green-600"}`,children:[F?"Stop":"Start"," Analysis"]}),t.jsx("button",{onClick:$,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600",children:"Reset"})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"System Properties"}),t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"System Type"}),t.jsxs("select",{value:_,onChange:s=>{H(s.target.value),U(s.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent mb-3",children:[t.jsx("option",{value:"sdof",children:"Single DOF System"}),t.jsx("option",{value:"automotive_suspension",children:"Automotive Suspension"}),t.jsx("option",{value:"machine_foundation",children:"Machine Foundation"}),t.jsx("option",{value:"building_structure",children:"Building Structure"}),t.jsx("option",{value:"rotating_machinery",children:"Rotating Machinery"}),t.jsx("option",{value:"custom",children:"Custom"})]}),t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Mass: ",m.mass.toFixed(1)," kg"]}),t.jsx("input",{type:"range",min:"0.1",max:"10000",step:"0.1",value:m.mass,onChange:s=>v(e=>({...e,mass:Number.parseFloat(s.target.value)})),className:"w-full mb-3"}),t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Stiffness: ",m.stiffness.toFixed(0)," N/m"]}),t.jsx("input",{type:"range",min:"100",max:"100000000",step:"100",value:m.stiffness,onChange:s=>v(e=>({...e,stiffness:Number.parseFloat(s.target.value)})),className:"w-full mb-3"}),t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Damping: ",m.damping.toFixed(1)," N⋅s/m"]}),t.jsx("input",{type:"range",min:"0",max:"10000",step:"1",value:m.damping,onChange:s=>v(e=>({...e,damping:Number.parseFloat(s.target.value)})),className:"w-full"})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Excitation Force"}),t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Excitation Type"}),t.jsxs("select",{value:g.type,onChange:s=>N(e=>({...e,type:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent mb-3",children:[t.jsx("option",{value:"harmonic",children:"Harmonic"}),t.jsx("option",{value:"impulse",children:"Impulse"}),t.jsx("option",{value:"step",children:"Step"}),t.jsx("option",{value:"chirp",children:"Chirp (Sweep)"}),t.jsx("option",{value:"impact",children:"Impact"}),t.jsx("option",{value:"random",children:"Random"})]}),t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Amplitude: ",g.amplitude.toFixed(1)," N"]}),t.jsx("input",{type:"range",min:"0",max:"10000",step:"10",value:g.amplitude,onChange:s=>N(e=>({...e,amplitude:Number.parseFloat(s.target.value)})),className:"w-full mb-3"}),t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Frequency: ",g.frequency.toFixed(1)," Hz"]}),t.jsx("input",{type:"range",min:"0.1",max:"100",step:"0.1",value:g.frequency,onChange:s=>N(e=>({...e,frequency:Number.parseFloat(s.target.value)})),className:"w-full"})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Display Options"}),t.jsxs("div",{className:"space-y-2 mb-3",children:[t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",checked:c.showDisplacement,onChange:s=>w(e=>({...e,showDisplacement:s.target.checked})),className:"mr-2"}),"Displacement"]}),t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",checked:c.showVelocity,onChange:s=>w(e=>({...e,showVelocity:s.target.checked})),className:"mr-2"}),"Velocity"]}),t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",checked:c.showAcceleration,onChange:s=>w(e=>({...e,showAcceleration:s.target.checked})),className:"mr-2"}),"Acceleration"]}),t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",checked:c.showForce,onChange:s=>w(e=>({...e,showForce:s.target.checked})),className:"mr-2"}),"Applied Force"]}),t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",checked:c.showFFT,onChange:s=>w(e=>({...e,showFFT:s.target.checked})),className:"mr-2"}),"FFT Analysis"]})]}),t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Duration: ",c.duration.toFixed(1)," s"]}),t.jsx("input",{type:"range",min:"1",max:"20",step:"0.1",value:c.duration,onChange:s=>w(e=>({...e,duration:Number.parseFloat(s.target.value)})),className:"w-full"})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"System Analysis"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Natural Frequency:"}),t.jsxs("span",{className:"font-mono",children:[m.naturalFrequency.toFixed(2)," Hz"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Damping Ratio:"}),t.jsx("span",{className:"font-mono",children:m.dampingRatio.toFixed(4)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Damped Frequency:"}),t.jsxs("span",{className:"font-mono",children:[m.dampedFrequency.toFixed(2)," Hz"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Critical Damping:"}),t.jsxs("span",{className:"font-mono",children:[m.criticalDamping.toFixed(1)," N⋅s/m"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"System Type:"}),t.jsx("span",{className:"font-mono",children:m.dampingRatio<1?"Underdamped":m.dampingRatio===1?"Critical":"Overdamped"})]})]})]}),q&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Vibration Metrics"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"RMS:"}),t.jsxs("span",{className:"font-mono",children:[q.rms.toFixed(6)," m"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Peak:"}),t.jsxs("span",{className:"font-mono",children:[q.peak.toFixed(6)," m"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Crest Factor:"}),t.jsx("span",{className:"font-mono",children:q.crestFactor.toFixed(2)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Settling Time:"}),t.jsxs("span",{className:"font-mono",children:[q.settlingTime.toFixed(3)," s"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Simulation Time:"}),t.jsxs("span",{className:"font-mono",children:[k.current.toFixed(2)," s"]})]})]})]})]})]}),t.jsxs("div",{className:"mt-6 bg-purple-50 rounded-lg p-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-purple-800 mb-2",children:"Mechanical Engineering Applications"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-purple-700",children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Machinery & Equipment:"}),t.jsxs("ul",{className:"mt-1 space-y-1",children:[t.jsx("li",{children:"• Rotating machinery analysis"}),t.jsx("li",{children:"• Foundation design"}),t.jsx("li",{children:"• Vibration isolation systems"}),t.jsx("li",{children:"• Modal testing and validation"})]})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Structural & Automotive:"}),t.jsxs("ul",{className:"mt-1 space-y-1",children:[t.jsx("li",{children:"• Suspension system design"}),t.jsx("li",{children:"• Building seismic analysis"}),t.jsx("li",{children:"• Machine tool dynamics"}),t.jsx("li",{children:"• Condition monitoring"})]})]})]})]})]})})};export{oe as component};
