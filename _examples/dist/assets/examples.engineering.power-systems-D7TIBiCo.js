import{r as g,j as t,L as Q,P as A,k as j,s as B,b as X,T as k}from"./index-BqTI3VMm.js";const Z=function(){const v=g.useRef(null),L=g.useRef(null),w=g.useRef(),W=g.useRef(0),[x,R]=g.useState([{id:"bus1",name:"Generation",type:"slack",x:100,y:200,voltage:{magnitude:1,angle:0},power:{real:0,reactive:0},baseKV:138,isSelected:!1},{id:"bus2",name:"Transmission",type:"PV",x:300,y:150,voltage:{magnitude:1.02,angle:-2},power:{real:50,reactive:0},baseKV:138,isSelected:!1},{id:"bus3",name:"Distribution",type:"PQ",x:500,y:200,voltage:{magnitude:.98,angle:-5},power:{real:-30,reactive:-10},baseKV:69,isSelected:!1},{id:"bus4",name:"Industrial",type:"PQ",x:400,y:350,voltage:{magnitude:.95,angle:-8},power:{real:-40,reactive:-15},baseKV:69,isSelected:!1}]),[N,$]=g.useState([{id:"line1",fromBus:"bus1",toBus:"bus2",resistance:.02,reactance:.08,susceptance:.005,rating:100,current:{magnitude:0,angle:0},power:{real:0,reactive:0}},{id:"line2",fromBus:"bus2",toBus:"bus3",resistance:.03,reactance:.12,susceptance:.008,rating:80,current:{magnitude:0,angle:0},power:{real:0,reactive:0}},{id:"line3",fromBus:"bus2",toBus:"bus4",resistance:.025,reactance:.1,susceptance:.006,rating:90,current:{magnitude:0,angle:0},power:{real:0,reactive:0}},{id:"line4",fromBus:"bus3",toBus:"bus4",resistance:.015,reactance:.06,susceptance:.004,rating:60,current:{magnitude:0,angle:0},power:{real:0,reactive:0}}]),[M,U]=g.useState([{id:"gen1",busId:"bus1",capacity:100,voltage:138,powerFactor:.85,status:"online",efficiency:.92},{id:"gen2",busId:"bus2",capacity:75,voltage:138,powerFactor:.9,status:"online",efficiency:.88}]),[V,H]=g.useState([{id:"load1",busId:"bus3",realPower:30,reactivePower:10,loadFactor:.8,priority:"high"},{id:"load2",busId:"bus4",realPower:40,reactivePower:15,loadFactor:.75,priority:"critical"}]),[h,E]=g.useState("load-flow"),[p,G]=g.useState(!1),[S,C]=g.useState(""),[I,D]=g.useState("three-phase"),[u,_]=g.useState({totalGeneration:0,totalLoad:0,losses:0,frequency:60,stability:"stable"}),q=()=>{const a=x.length,e=Array(a).fill(null).map(()=>Array(a).fill({real:0,imag:0}));N.forEach(r=>{const i=x.findIndex(n=>n.id===r.fromBus),c=x.findIndex(n=>n.id===r.toBus);if(i!==-1&&c!==-1){const n={real:r.resistance/(r.resistance*r.resistance+r.reactance*r.reactance),imag:-r.reactance/(r.resistance*r.resistance+r.reactance*r.reactance)};e[i][i]={real:e[i][i].real+n.real,imag:e[i][i].imag+n.imag+r.susceptance/2},e[c][c]={real:e[c][c].real+n.real,imag:e[c][c].imag+n.imag+r.susceptance/2},e[i][c]={real:e[i][c].real-n.real,imag:e[i][c].imag-n.imag},e[c][i]={real:e[c][i].real-n.real,imag:e[c][i].imag-n.imag}}});const s=x.map((r,i)=>{const c={real:0,reactive:0};for(let n=0;n<a;n++){const f=r.voltage.magnitude,b=x[n].voltage.magnitude,y=(r.voltage.angle-x[n].voltage.angle)*A/180,T=e[i][n].real,F=e[i][n].imag;c.real+=f*b*(T*j(y)+F*B(y)),c.reactive+=f*b*(T*B(y)-F*j(y))}return{...r,power:c}});R(s);const l=N.map(r=>{const i=s.find(n=>n.id===r.fromBus),c=s.find(n=>n.id===r.toBus);if(i&&c){const n=i.voltage.magnitude,f=c.voltage.magnitude,b=(i.voltage.angle-c.voltage.angle)*A/180,y=Math.sqrt(r.resistance*r.resistance+r.reactance*r.reactance),T=Math.abs(n-f*j(b))/y,F={real:n*f*j(b)/y,reactive:n*f*B(b)/y};return{...r,current:{magnitude:T,angle:0},power:F}}return r});$(l);const d=M.reduce((r,i)=>i.status==="online"?r+i.capacity:r,0),o=V.reduce((r,i)=>r+i.realPower,0),m=l.reduce((r,i)=>r+Math.abs(i.power.real)*.02,0);_({totalGeneration:d,totalLoad:o,losses:m,frequency:60+X(-.1,.1),stability:m<5?"stable":m<10?"marginal":"unstable"})},K=()=>{const a=v.current,e=a==null?void 0:a.getContext("2d");if(!(!a||!e)&&(e.clearRect(0,0,a.width,a.height),e.fillStyle="#f8fafc",e.fillRect(0,0,a.width,a.height),N.forEach(s=>{const l=x.find(o=>o.id===s.fromBus),d=x.find(o=>o.id===s.toBus);if(l&&d){const o=Math.abs(s.power.real)/s.rating;let m="#4ade80";o>.8?m="#f87171":o>.6&&(m="#fbbf24"),e.strokeStyle=m,e.lineWidth=3+o*2,e.beginPath(),e.moveTo(l.x,l.y),e.lineTo(d.x,d.y),e.stroke();const r=(l.x+d.x)/2,i=(l.y+d.y)/2,c=Math.atan2(d.y-l.y,d.x-l.x);Math.abs(s.power.real)>1&&(e.fillStyle=m,e.save(),e.translate(r,i),e.rotate(c),e.beginPath(),e.moveTo(-5,-3),e.lineTo(5,0),e.lineTo(-5,3),e.closePath(),e.fill(),e.restore()),e.fillStyle="#374151",e.font="12px Arial",e.textAlign="center",e.fillText(`${Math.abs(s.power.real).toFixed(1)} MW`,r,i-10),e.fillText(`${(o*100).toFixed(0)}%`,r,i+15)}}),x.forEach(s=>{let l="#3b82f6";s.type==="slack"?l="#10b981":s.type==="PV"&&(l="#f59e0b");const o=15+s.voltage.magnitude*5;e.fillStyle=l,e.beginPath(),e.arc(s.x,s.y,o,0,k),e.fill(),e.strokeStyle=s.isSelected?"#ef4444":"#1f2937",e.lineWidth=s.isSelected?3:2,e.stroke(),e.fillStyle="#1f2937",e.font="bold 14px Arial",e.textAlign="center",e.fillText(s.name,s.x,s.y-o-5),e.font="12px Arial",e.fillText(`${s.voltage.magnitude.toFixed(3)} pu`,s.x,s.y+o+15),e.fillText(`∠${s.voltage.angle.toFixed(1)}°`,s.x,s.y+o+30),e.fillText(`${s.baseKV} kV`,s.x,s.y+o+45)}),M.forEach(s=>{const l=x.find(d=>d.id===s.busId);l&&s.status==="online"&&(e.fillStyle=s.status==="online"?"#10b981":"#6b7280",e.beginPath(),e.arc(l.x-25,l.y-25,8,0,k),e.fill(),e.fillStyle="#1f2937",e.font="10px Arial",e.textAlign="center",e.fillText("G",l.x-25,l.y-22),e.fillText(`${s.capacity}MW`,l.x-25,l.y-35))}),V.forEach(s=>{const l=x.find(d=>d.id===s.busId);if(l){const d=s.priority==="critical"?"#ef4444":s.priority==="high"?"#f59e0b":"#6b7280";e.fillStyle=d,e.beginPath(),e.rect(l.x+15,l.y-30,20,15),e.fill(),e.fillStyle="#1f2937",e.font="10px Arial",e.textAlign="center",e.fillText("L",l.x+25,l.y-22),e.fillText(`${s.realPower}MW`,l.x+25,l.y-35)}}),h==="fault-analysis"&&S)){const s=x.find(l=>l.id===S);s&&(e.strokeStyle="#dc2626",e.lineWidth=4,e.setLineDash([5,5]),e.beginPath(),e.arc(s.x,s.y,25,0,k),e.stroke(),e.setLineDash([]),e.fillStyle="#dc2626",e.font="bold 12px Arial",e.textAlign="center",e.fillText("FAULT",s.x,s.y+40))}},Y=()=>{const a=L.current,e=a==null?void 0:a.getContext("2d");if(!a||!e)return;e.clearRect(0,0,a.width,a.height),e.fillStyle="#f8fafc",e.fillRect(0,0,a.width,a.height);const s=a.width/2,l=a.height/2,d=100;e.strokeStyle="#e5e7eb",e.lineWidth=1;for(let o=50;o<=150;o+=50)e.beginPath(),e.arc(s,l,o,0,k),e.stroke();e.strokeStyle="#374151",e.lineWidth=2,e.beginPath(),e.moveTo(s-200,l),e.lineTo(s+200,l),e.moveTo(s,l-200),e.lineTo(s,l+200),e.stroke(),x.forEach((o,m)=>{const r=["#ef4444","#3b82f6","#10b981","#f59e0b"],i=o.voltage.magnitude*d,c=o.voltage.angle*A/180,n=s+i*j(c),f=l-i*B(c);e.strokeStyle=r[m%r.length],e.lineWidth=3,e.beginPath(),e.moveTo(s,l),e.lineTo(n,f),e.stroke(),e.fillStyle=r[m%r.length],e.save(),e.translate(n,f),e.rotate(c),e.beginPath(),e.moveTo(-8,-4),e.lineTo(0,0),e.lineTo(-8,4),e.closePath(),e.fill(),e.restore(),e.fillStyle="#1f2937",e.font="12px Arial",e.textAlign="left",e.fillText(`${o.name}: ${o.voltage.magnitude.toFixed(3)}∠${o.voltage.angle.toFixed(1)}°`,n+10,f)}),e.fillStyle="#1f2937",e.font="bold 14px Arial",e.textAlign="center",e.fillText("Voltage Phasor Diagram",s,30),e.font="12px Arial",e.fillText("Real (pu)",s+180,l+15),e.save(),e.translate(s-15,l-180),e.rotate(-A/2),e.fillText("Imaginary (pu)",0,0),e.restore()},P=()=>{W.current+=.02,(h==="load-flow"||h==="stability")&&q(),K(),h==="phasor"&&Y(),p&&(w.current=requestAnimationFrame(P))},O=a=>{const e=v.current;if(!e)return;const s=e.getBoundingClientRect(),l=a.clientX-s.left,d=a.clientY-s.top,o=x.find(m=>Math.sqrt((l-m.x)**2+(d-m.y)**2)<=20);o&&(R(x.map(m=>({...m,isSelected:m.id===o.id?!m.isSelected:!1}))),h==="fault-analysis"&&C(o.id))};return g.useEffect(()=>{const a=v.current,e=L.current;!a||!e||(a.width=800,a.height=600,e.width=400,e.height=400,P())},[]),g.useEffect(()=>{p||P()},[x,N,h,S,I]),t.jsxs("div",{className:"container mx-auto px-4 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Power Systems Analysis"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Comprehensive power systems analysis including load flow, fault analysis, and system stability visualization."}),t.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:t.jsx("p",{className:"text-yellow-800",children:"⚡ Interactive power grid analysis with real-time monitoring and fault simulation capabilities"})})]}),t.jsx("div",{className:"mb-6 bg-white rounded-lg border border-gray-200 p-4",children:t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Analysis Mode"}),t.jsxs("select",{value:h,onChange:a=>E(a.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500",children:[t.jsx("option",{value:"load-flow",children:"Load Flow"}),t.jsx("option",{value:"fault-analysis",children:"Fault Analysis"}),t.jsx("option",{value:"stability",children:"Stability Analysis"}),t.jsx("option",{value:"phasor",children:"Phasor Diagram"})]})]}),h==="fault-analysis"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fault Bus"}),t.jsxs("select",{value:S,onChange:a=>C(a.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500",children:[t.jsx("option",{value:"",children:"Select Bus"}),x.map(a=>t.jsx("option",{value:a.id,children:a.name},a.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fault Type"}),t.jsxs("select",{value:I,onChange:a=>D(a.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500",children:[t.jsx("option",{value:"three-phase",children:"Three-Phase"}),t.jsx("option",{value:"line-to-ground",children:"Line-to-Ground"}),t.jsx("option",{value:"line-to-line",children:"Line-to-Line"})]})]})]}),t.jsx("div",{className:"flex items-end",children:t.jsxs("button",{type:"button",onClick:()=>{G(!p),p?w.current&&cancelAnimationFrame(w.current):w.current=requestAnimationFrame(P)},className:`px-4 py-2 rounded-md transition-colors ${p?"bg-red-600 text-white hover:bg-red-700":"bg-green-600 text-white hover:bg-green-700"}`,children:[p?"Stop":"Start"," Real-time"]})})]})}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-3",children:"System Metrics"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsx("h4",{className:"font-medium text-blue-800",children:"Total Generation"}),t.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:[u.totalGeneration.toFixed(1)," MW"]})]}),t.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[t.jsx("h4",{className:"font-medium text-green-800",children:"Total Load"}),t.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[u.totalLoad.toFixed(1)," MW"]})]}),t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[t.jsx("h4",{className:"font-medium text-yellow-800",children:"System Losses"}),t.jsxs("p",{className:"text-2xl font-bold text-yellow-900",children:[u.losses.toFixed(2)," MW"]})]}),t.jsxs("div",{className:`border rounded-lg p-4 ${u.stability==="stable"?"bg-green-50 border-green-200":u.stability==="marginal"?"bg-yellow-50 border-yellow-200":"bg-red-50 border-red-200"}`,children:[t.jsx("h4",{className:`font-medium ${u.stability==="stable"?"text-green-800":u.stability==="marginal"?"text-yellow-800":"text-red-800"}`,children:"System Status"}),t.jsx("p",{className:`text-2xl font-bold ${u.stability==="stable"?"text-green-900":u.stability==="marginal"?"text-yellow-900":"text-red-900"}`,children:u.stability.toUpperCase()})]})]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Power System One-Line Diagram"}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-4",children:[t.jsx("canvas",{ref:v,onClick:O,className:"border border-gray-300 rounded-lg bg-white cursor-pointer",style:{maxWidth:"100%",height:"auto"}}),t.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Legend:"}),"Green circles = Slack bus (reference), Orange circles = PV bus (generator), Blue circles = PQ bus (load)"]}),t.jsx("p",{children:"Line colors: Green = Normal loading, Yellow = High loading (>60%), Red = Overloaded (>80%)"}),h==="fault-analysis"&&t.jsx("p",{children:"Click on a bus to simulate a fault"})]})]})]}),h==="phasor"&&t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Voltage Phasor Diagram"}),t.jsx("div",{className:"bg-white rounded-lg border border-gray-300 p-4",children:t.jsx("canvas",{ref:L,className:"border border-gray-300 rounded-lg bg-white mx-auto block",style:{maxWidth:"100%",height:"auto"}})})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Bus Data"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full bg-white border border-gray-300 rounded-lg",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:"Bus"}),t.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:"Type"}),t.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:"Voltage (pu)"}),t.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:"Angle (°)"}),t.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:"P (MW)"}),t.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:"Q (MVAr)"}),t.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:"Base kV"})]})}),t.jsx("tbody",{children:x.map(a=>t.jsxs("tr",{className:a.isSelected?"bg-yellow-50":"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-2 border-t",children:a.name}),t.jsx("td",{className:"px-4 py-2 border-t",children:t.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${a.type==="slack"?"bg-green-100 text-green-800":a.type==="PV"?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"}`,children:a.type})}),t.jsx("td",{className:"px-4 py-2 border-t",children:a.voltage.magnitude.toFixed(4)}),t.jsx("td",{className:"px-4 py-2 border-t",children:a.voltage.angle.toFixed(2)}),t.jsx("td",{className:"px-4 py-2 border-t",children:a.power.real.toFixed(2)}),t.jsx("td",{className:"px-4 py-2 border-t",children:a.power.reactive.toFixed(2)}),t.jsx("td",{className:"px-4 py-2 border-t",children:a.baseKV})]},a.id))})]})})]}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[t.jsx("h3",{className:"text-lg font-semibold mb-2 text-yellow-800",children:"Power Systems Features"}),t.jsxs("ul",{className:"text-yellow-700 space-y-1",children:[t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Load Flow Analysis"}),": Newton-Raphson method for steady-state"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Fault Analysis"}),": Short circuit calculations and voltage profiles"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Stability Assessment"}),": Real-time system stability monitoring"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Phasor Visualization"}),": Complex voltage relationships"]})]})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsx("h3",{className:"text-lg font-semibold mb-2 text-blue-800",children:"Engineering Applications"}),t.jsxs("ul",{className:"text-blue-700 space-y-1",children:[t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Grid Planning"}),": Transmission system expansion"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Operations"}),": Real-time monitoring and control"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Protection"}),": Relay coordination and fault clearing"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Reliability"}),": Contingency analysis and risk assessment"]})]})]})]}),t.jsx("div",{className:"mt-6",children:t.jsx(Q,{to:"/examples/engineering",className:"inline-block px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors",children:"← Back to Examples"})})]})};export{Z as component};
