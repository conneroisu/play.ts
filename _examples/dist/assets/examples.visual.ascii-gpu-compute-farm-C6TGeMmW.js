import{r as c,j as r,l as d}from"./index-BqTI3VMm.js";const X=function(){const S=c.useRef(null),g=c.useRef(),v=c.useRef(!1),y=c.useRef(0),[b,k]=c.useState(!1),P=c.useRef([{id:"gpu-0",name:"RTX 4090",temperature:35,utilization:0,memory:0,powerDraw:100,fanSpeed:30,status:"idle",currentTask:null,x:5,y:5},{id:"gpu-1",name:"RTX 4090",temperature:38,utilization:0,memory:0,powerDraw:95,fanSpeed:28,status:"idle",currentTask:null,x:25,y:5},{id:"gpu-2",name:"RTX 4090",temperature:36,utilization:0,memory:0,powerDraw:98,fanSpeed:32,status:"idle",currentTask:null,x:45,y:5},{id:"gpu-3",name:"RTX 4090",temperature:40,utilization:0,memory:0,powerDraw:102,fanSpeed:35,status:"idle",currentTask:null,x:65,y:5},{id:"gpu-4",name:"A100 80GB",temperature:42,utilization:0,memory:0,powerDraw:250,fanSpeed:40,status:"idle",currentTask:null,x:5,y:15},{id:"gpu-5",name:"A100 80GB",temperature:41,utilization:0,memory:0,powerDraw:245,fanSpeed:38,status:"idle",currentTask:null,x:25,y:15},{id:"gpu-6",name:"H100 80GB",temperature:45,utilization:0,memory:0,powerDraw:300,fanSpeed:45,status:"idle",currentTask:null,x:45,y:15},{id:"gpu-7",name:"H100 80GB",temperature:43,utilization:0,memory:0,powerDraw:295,fanSpeed:42,status:"idle",currentTask:null,x:65,y:15}]),w=c.useRef({waiting:[],running:[],completed:[]}),[T,U]=c.useState({totalTasks:0,runningTasks:0,completedTasks:0,avgTemperature:0,totalPowerDraw:0,avgUtilization:0}),j=["ml-training","crypto-mining","render","simulation","ai-inference"],N=["low","normal","high","critical"],F=()=>{const e=j[Math.floor(Math.random()*j.length)],i=N[Math.floor(Math.random()*N.length)];let t=5+Math.random()*15;return i==="critical"&&(t*=.5),i==="low"&&(t*=1.5),{id:Math.random().toString(36).substr(2,8),type:e,priority:i,progress:0,estimatedTime:t,startTime:0}},$=(e,i)=>{e.currentTask=i,e.status="computing",i.startTime=y.current;const t=w.current;t.waiting=t.waiting.filter(s=>s.id!==i.id),t.running.push(i)},C=(e,i)=>{if(e.currentTask){const t=e.currentTask,s=y.current-t.startTime;t.progress=Math.min(100,s/t.estimatedTime*100);let n=0;switch(t.type){case"ml-training":n=85+Math.random()*10;break;case"crypto-mining":n=95+Math.random()*5;break;case"render":n=70+Math.random()*20;break;case"simulation":n=80+Math.random()*15;break;case"ai-inference":n=60+Math.random()*25;break}e.utilization=d(e.utilization,n,.05),e.memory=d(e.memory,n*.8,.03);const l=40,a=e.utilization*.6,f=l+a+Math.random()*5;e.temperature=d(e.temperature,f,.02);const p=Math.min(100,30+(e.temperature-40)*2);e.fanSpeed=d(e.fanSpeed,p,.1);const x=e.name.includes("H100")?300:e.name.includes("A100")?250:100,m=x+e.utilization/100*(x*.5);if(e.powerDraw=d(e.powerDraw,m,.05),e.temperature>85?(e.status="throttling",e.utilization*=.7):e.temperature>95&&(e.status="error",e.utilization=0),t.progress>=100){const o=w.current;o.running=o.running.filter(u=>u.id!==t.id),o.completed.push(t),e.currentTask=null,e.status="idle",o.completed.length>20&&o.completed.shift()}}else{e.utilization=d(e.utilization,0,.1),e.memory=d(e.memory,0,.05),e.temperature=d(e.temperature,35+Math.random()*5,.01),e.fanSpeed=d(e.fanSpeed,30,.05);const t=e.name.includes("H100")?50:e.name.includes("A100")?40:20;e.powerDraw=d(e.powerDraw,t+Math.random()*10,.02)}},G=(e,i,t,s)=>{const n=i.x,l=i.y;let a="#00ff00",f="●";switch(i.status){case"idle":a="#888888",f="○";break;case"computing":a="#00ff00",f="●";break;case"throttling":a="#ffaa00",f="◐";break;case"error":a="#ff0000",f="✗";break}if(e.fillStyle=a,e.fillText("╭─────────────────╮",n*t,l*s),e.fillText("│",n*t,(l+1)*s),e.fillText("│",(n+18)*t,(l+1)*s),e.fillStyle="#ffffff",e.fillText(`${i.name}`,(n+2)*t,(l+1)*s),e.fillStyle=a,e.fillText(f,(n+16)*t,(l+1)*s),e.fillStyle=a,e.fillText("│",n*t,(l+2)*s),e.fillText("│",(n+18)*t,(l+2)*s),e.fillStyle="#ffffff",e.fillText(`Util: ${i.utilization.toFixed(0)}%`,(n+2)*t,(l+2)*s),e.fillText(`${i.temperature.toFixed(0)}°C`,(n+12)*t,(l+2)*s),e.fillStyle=a,e.fillText("│",n*t,(l+3)*s),e.fillText("│",(n+18)*t,(l+3)*s),e.fillStyle="#ffffff",e.fillText(`Mem: ${i.memory.toFixed(0)}%`,(n+2)*t,(l+3)*s),e.fillText(`${i.powerDraw.toFixed(0)}W`,(n+12)*t,(l+3)*s),e.fillStyle=a,e.fillText("│",n*t,(l+4)*s),e.fillText("│",(n+18)*t,(l+4)*s),i.currentTask){e.fillStyle="#00ffff";const p=i.currentTask.type.replace("-"," ").substr(0,12);e.fillText(p,(n+2)*t,(l+4)*s);const x=Math.floor(i.currentTask.progress/10);e.fillStyle="#444444";for(let m=0;m<10;m++)e.fillText("░",(n+2+m)*t,(l+5)*s);e.fillStyle="#00ff00";for(let m=0;m<x;m++)e.fillText("█",(n+2+m)*t,(l+5)*s);e.fillStyle="#ffffff",e.fillText(`${i.currentTask.progress.toFixed(0)}%`,(n+13)*t,(l+5)*s)}else e.fillStyle="#666666",e.fillText("idle",(n+2)*t,(l+4)*s);if(e.fillStyle=a,e.fillText("│",n*t,(l+5)*s),e.fillText("│",(n+18)*t,(l+5)*s),e.fillText("╰─────────────────╯",n*t,(l+6)*s),i.fanSpeed>50){const p=["◐","◓","◑","◒"],x=Math.floor(y.current*(i.fanSpeed/10))%p.length;e.fillStyle="#00aaff",e.fillText(p[x],(n+17)*t,(l+5)*s)}},A=(e,i,t)=>{const s=w.current,n=5;let l=27;e.fillStyle="#ffffff",e.fillText("TASK QUEUE",n*i,l*t),l++,e.fillStyle="#888888",e.fillText("─".repeat(30),n*i,l*t),l++,e.fillStyle="#ffaa00",e.fillText(`Waiting (${s.waiting.length}):`,n*i,l*t),l++,s.waiting.slice(0,3).forEach(a=>{e.fillStyle="#666666";const f=a.priority==="critical"?"#ff0000":a.priority==="high"?"#ffaa00":a.priority==="normal"?"#00ff00":"#888888";e.fillStyle=f,e.fillText(`• ${a.type} [${a.priority}]`,(n+1)*i,l*t),l++}),s.waiting.length>3&&(e.fillStyle="#666666",e.fillText(`... +${s.waiting.length-3} more`,(n+1)*i,l*t),l++),l++,e.fillStyle="#00ff00",e.fillText(`Running (${s.running.length}):`,n*i,l*t),l++,s.running.slice(0,3).forEach(a=>{e.fillStyle="#00ffff",e.fillText(`• ${a.type} ${a.progress.toFixed(0)}%`,(n+1)*i,l*t),l++})},R=()=>{if(!v.current)return;const e=S.current;if(!e)return;const i=e.getContext("2d");if(!i)return;y.current+=.016,i.fillStyle="#000000",i.fillRect(0,0,e.width,e.height);const t=8,s=16;i.font="12px monospace",i.fillStyle="#ffffff",i.fillText("GPU Compute Farm Dashboard",10,20),i.fillText("════════════════════════════════════════════════════════════════",10,35);const n=P.current,l=w.current;Math.random()<.02&&l.waiting.length<10&&l.waiting.push(F());const a=n.filter(o=>o.status==="idle");if(a.length>0&&l.waiting.length>0){l.waiting.sort((E,q)=>{const D={critical:4,high:3,normal:2,low:1};return D[q.priority]-D[E.priority]});const o=a[0],u=l.waiting[0];$(o,u)}n.forEach(o=>C(o)),n.forEach(o=>G(i,o,t,s)),A(i,t,s);const f=l.waiting.length+l.running.length+l.completed.length,p=n.reduce((o,u)=>o+u.temperature,0)/n.length,x=n.reduce((o,u)=>o+u.powerDraw,0),m=n.reduce((o,u)=>o+u.utilization,0)/n.length;U({totalTasks:f,runningTasks:l.running.length,completedTasks:l.completed.length,avgTemperature:p,totalPowerDraw:x,avgUtilization:m}),g.current=requestAnimationFrame(R)},z=()=>{k(!0),v.current=!0,R()},M=()=>{k(!1),v.current=!1,g.current&&cancelAnimationFrame(g.current)};return c.useEffect(()=>(z(),()=>M()),[]),r.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold mb-2",children:"GPU Compute Farm"}),r.jsx("p",{className:"text-gray-600",children:"Real-time monitoring of GPU cluster computing various workloads including ML training, AI inference, rendering, and simulations with thermal management."})]}),r.jsxs("div",{className:"mb-4 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[r.jsxs("div",{className:"bg-blue-100 p-3 rounded",children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Running Tasks"}),r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:T.runningTasks})]}),r.jsxs("div",{className:"bg-green-100 p-3 rounded",children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Completed"}),r.jsx("div",{className:"text-2xl font-bold text-green-600",children:T.completedTasks})]}),r.jsxs("div",{className:"bg-purple-100 p-3 rounded",children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Avg Temp"}),r.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[T.avgTemperature.toFixed(0),"°C"]})]}),r.jsxs("div",{className:"bg-red-100 p-3 rounded",children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Total Power"}),r.jsxs("div",{className:"text-2xl font-bold text-red-600",children:[T.totalPowerDraw.toFixed(0),"W"]})]}),r.jsxs("div",{className:"bg-yellow-100 p-3 rounded",children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Avg Util"}),r.jsxs("div",{className:"text-2xl font-bold text-yellow-600",children:[T.avgUtilization.toFixed(0),"%"]})]}),r.jsxs("div",{className:"bg-gray-100 p-3 rounded",children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Total Tasks"}),r.jsx("div",{className:"text-2xl font-bold",children:T.totalTasks})]})]}),r.jsx("div",{className:"mb-4",children:r.jsxs("button",{onClick:b?M:z,className:`px-4 py-2 rounded ${b?"bg-red-500 hover:bg-red-600 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:[b?"Stop":"Start"," Farm"]})}),r.jsx("div",{className:"border rounded-lg p-4 bg-black",children:r.jsx("canvas",{ref:S,width:800,height:600,className:"block",style:{width:"100%",height:"auto",maxWidth:"100%",imageRendering:"pixelated"}})}),r.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[r.jsx("h3",{className:"font-semibold mb-2",children:"Legend:"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsx("div",{children:"○ Idle GPU"}),r.jsx("div",{children:"● Computing"}),r.jsx("div",{children:"◐ Throttling"}),r.jsx("div",{children:"✗ Error/Overheating"}),r.jsx("div",{children:"Progress bars show task completion"}),r.jsx("div",{children:"Fan symbols indicate cooling activity"})]})]})]})};export{X as component};
