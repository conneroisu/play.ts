import{r as c,j as e,L as gt,s as P,T as _,k as ut,b as q,e as G,t as k,h as S,P as H}from"./index-BqTI3VMm.js";const ft=function(){const b=c.useRef(null),y=c.useRef(),$=c.useRef(0),[d,U]=c.useState([]),[m,X]=c.useState([]),[j,M]=c.useState(!1),[v,L]=c.useState(!1),[h,f]=c.useState({layers:[3,4,3,2],activationFunction:"sigmoid",learningRate:.1,momentum:.9}),[I,A]=c.useState(0),[Y,B]=c.useState(0),[g,J]=c.useState([]),[x,T]=c.useState(0),[p,K]=c.useState("classification"),[N,Q]=c.useState(!0),[w,Z]=c.useState(!0),[C,tt]=c.useState(!1),et={sigmoid:i=>1/(1+Math.exp(-i)),tanh:i=>Math.tanh(i),relu:i=>Math.max(0,i),leaky_relu:i=>i>0?i:.01*i},W={sigmoid:i=>i*(1-i),tanh:i=>1-i*i,relu:i=>i>0?1:0,leaky_relu:i=>i>0?1:.01},it=i=>{const t=[];switch(i){case"classification":t.push({inputs:[0,0,1],outputs:[0,1],name:"Class A"},{inputs:[0,1,1],outputs:[1,0],name:"Class B"},{inputs:[1,0,1],outputs:[1,0],name:"Class B"},{inputs:[1,1,1],outputs:[0,1],name:"Class A"});break;case"regression":for(let r=0;r<8;r++){const a=r/7,s=P(a*H*2),n=ut(a*H*2);t.push({inputs:[a,.5,1],outputs:[s,n],name:`Point ${r}`})}break;case"autoencoder":for(let r=0;r<6;r++){const a=Array(3).fill(0);a[r%3]=1,t.push({inputs:a,outputs:a,name:`Pattern ${r}`})}break}return t},at=i=>{const t=b.current;if(!t)return[];const r=[],a=(t.width-100)/(i.length-1);return i.forEach((s,n)=>{const l=s>1?(t.height-100)/(s-1):0,o=s===1?t.height/2:50;for(let u=0;u<s;u++){const R=50+n*a,F=o+u*l;r.push({x:R,y:F,activation:0,bias:q(-.5,.5),layer:n,index:u,id:`${n}-${u}`,error:0})}}),r},st=i=>{const t=[];for(let r=0;r<i.length;r++){const a=i[r];for(let s=0;s<i.length;s++){const n=i[s];n.layer===a.layer+1&&t.push({from:a,to:n,weight:q(-1,1),id:`${a.id}-${n.id}`,activity:0})}}return t},D=i=>{switch(i){case"classification":f(r=>({...r,layers:[3,4,3,2]}));break;case"regression":f(r=>({...r,layers:[3,5,4,2]}));break;case"autoencoder":f(r=>({...r,layers:[3,2,3]}));break}const t=it(i);J(t),T(0)},z=i=>{d.filter(a=>a.layer===0).forEach((a,s)=>{a.activation=i[s]||0});const r=Math.max(...d.map(a=>a.layer));for(let a=1;a<=r;a++)d.filter(n=>n.layer===a).forEach(n=>{let l=n.bias;m.forEach(o=>{o.to.id===n.id&&(l+=o.from.activation*o.weight,o.activity=Math.abs(o.from.activation*o.weight))}),n.activation=et[h.activationFunction](l)})},rt=i=>{const t=Math.max(...d.map(a=>a.layer));d.filter(a=>a.layer===t).forEach((a,s)=>{const n=i[s]||0,l=n-a.activation;a.error=l*W[h.activationFunction](a.activation),a.targetActivation=n});for(let a=t-1;a>=0;a--)d.filter(n=>n.layer===a).forEach(n=>{let l=0;m.forEach(o=>{o.from.id===n.id&&(l+=o.to.error*o.weight)}),n.error=l*W[h.activationFunction](n.activation)});m.forEach(a=>{const s=h.learningRate*a.to.error*a.from.activation;a.weight+=s,a.weight=G(a.weight,-5,5)}),d.forEach(a=>{a.layer>0&&(a.bias+=h.learningRate*a.error,a.bias=G(a.bias,-3,3))})},nt=async()=>{M(!0),A(0);for(let i=0;i<200;i++){let t=0;for(let r=0;r<g.length;r++){const a=g[r];T(r),z(a.inputs),rt(a.outputs),d.filter(n=>n.layer===Math.max(...d.map(l=>l.layer))).forEach((n,l)=>{const o=a.outputs[l]||0;t+=Math.pow(o-n.activation,2)}),await new Promise(n=>setTimeout(n,50))}if(A(i+1),B(t/g.length),t<.01)break}M(!1)},ot=i=>{const t=i.weight,r=i.activity;if(!N)return`rgba(100, 100, 100, ${.3+r*.7})`;const a=.3+r*.7;return t>0?`rgba(100, 255, 100, ${a})`:`rgba(255, 100, 100, ${a})`},lt=i=>{if(!w)return"#4A90E2";const t=i.activation,r=Math.abs(t);if(i.layer===0)return k(S(220,80,30+r*50));if(i.layer===Math.max(...d.map(a=>a.layer))){if(i.targetActivation!==void 0){const s=Math.abs(i.targetActivation-t)<.1?120:0;return k(S(s,80,30+r*50))}return k(S(120,80,30+r*50))}else return k(S(280,80,30+r*50))},O=()=>{const i=b.current,t=i==null?void 0:i.getContext("2d");if(!i||!t)return;t.clearRect(0,0,i.width,i.height);const r=t.createLinearGradient(0,0,i.width,i.height);r.addColorStop(0,"#1a1a2e"),r.addColorStop(1,"#16213e"),t.fillStyle=r,t.fillRect(0,0,i.width,i.height);const a=$.current;if(m.forEach(s=>{const{from:n,to:l}=s;t.strokeStyle=ot(s),t.lineWidth=1+Math.abs(s.weight)*2,t.lineCap="round";const o=P(a*3+s.weight*10)*.5+.5,u=s.activity*o;if(u>.1&&(t.globalAlpha=u,t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(l.x,l.y),t.stroke(),N&&Math.abs(s.weight)>.5)){const R=(n.x+l.x)/2,F=(n.y+l.y)/2;t.fillStyle="rgba(255, 255, 255, 0.8)",t.font="10px Arial",t.textAlign="center",t.fillText(s.weight.toFixed(1),R,F)}t.globalAlpha=1}),d.forEach(s=>{const l=15+(2+P(a*2+s.activation*5)*s.activation*3);if(t.fillStyle=lt(s),t.beginPath(),t.arc(s.x,s.y,l,0,_),t.fill(),t.strokeStyle="#ffffff",t.lineWidth=2,t.stroke(),w&&(t.fillStyle="#ffffff",t.font="12px Arial",t.textAlign="center",t.fillText(s.activation.toFixed(2),s.x,s.y+4)),C&&s.layer>0&&(t.fillStyle=s.bias>0?"#90EE90":"#FFB6C1",t.beginPath(),t.arc(s.x+20,s.y-20,8,0,_),t.fill(),t.fillStyle="#000000",t.font="8px Arial",t.textAlign="center",t.fillText("B",s.x+20,s.y-16)),s.index===0){t.fillStyle="#ffffff",t.font="14px Arial",t.textAlign="center";let o="";s.layer===0?o="Input":s.layer===Math.max(...d.map(u=>u.layer))?o="Output":o=`Hidden ${s.layer}`,t.fillText(o,s.x,s.y-40)}}),(j||I>0)&&(t.fillStyle="rgba(0, 0, 0, 0.7)",t.fillRect(10,10,250,100),t.fillStyle="#ffffff",t.font="14px Arial",t.textAlign="left",t.fillText(`Epoch: ${I}`,20,30),t.fillText(`Error: ${Y.toFixed(4)}`,20,50),t.fillText(`Learning Rate: ${h.learningRate}`,20,70),g[x]&&t.fillText(`Training: ${g[x].name}`,20,90),j&&t.fillText("Training...",20,110)),g[x]){const s=g[x];t.fillStyle="rgba(0, 0, 0, 0.7)",t.fillRect(i.width-200,10,180,80),t.fillStyle="#ffffff",t.font="12px Arial",t.textAlign="left",t.fillText("Current Pattern:",i.width-190,30),t.fillText(`Input: [${s.inputs.map(n=>n.toFixed(1)).join(", ")}]`,i.width-190,50),t.fillText(`Target: [${s.outputs.map(n=>n.toFixed(1)).join(", ")}]`,i.width-190,70)}},V=()=>{$.current+=.02,O(),v&&(y.current=requestAnimationFrame(V))},ct=()=>{L(!0),y.current=requestAnimationFrame(V)},dt=()=>{L(!1),y.current&&cancelAnimationFrame(y.current)},E=()=>{const i=at(h.layers),t=st(i);U(i),X(t),A(0),B(0)},ht=i=>{g[i]&&(T(i),z(g[i].inputs))};return c.useEffect(()=>{const i=b.current;i&&(i.width=900,i.height=600,D(p),E())},[]),c.useEffect(()=>{p!=="custom"&&D(p)},[p]),c.useEffect(()=>{E()},[h.layers]),c.useEffect(()=>{v||O()},[d,m,N,w,C,x]),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Neural Network Visualization"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Interactive neural network with real-time learning visualization, backpropagation, and customizable architectures."}),e.jsx("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:e.jsx("p",{className:"text-indigo-800",children:"🧠 Watch neurons learn patterns through training, see weights update, explore different network types"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[e.jsx("button",{type:"button",onClick:ct,disabled:v,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50 transition-colors",children:"Start Animation"}),e.jsx("button",{type:"button",onClick:dt,disabled:!v,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 transition-colors",children:"Stop Animation"}),e.jsx("button",{type:"button",onClick:nt,disabled:j,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 transition-colors",children:j?"Training...":"Train Network"}),e.jsx("button",{type:"button",onClick:E,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Reset Network"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Network Type"}),e.jsxs("select",{value:p,onChange:i=>K(i.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"classification",children:"Classification (XOR)"}),e.jsx("option",{value:"regression",children:"Function Approximation"}),e.jsx("option",{value:"autoencoder",children:"Autoencoder"}),e.jsx("option",{value:"custom",children:"Custom"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Activation Function"}),e.jsxs("select",{value:h.activationFunction,onChange:i=>f(t=>({...t,activationFunction:i.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"sigmoid",children:"Sigmoid"}),e.jsx("option",{value:"tanh",children:"Tanh"}),e.jsx("option",{value:"relu",children:"ReLU"}),e.jsx("option",{value:"leaky_relu",children:"Leaky ReLU"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Learning Rate: ",h.learningRate.toFixed(2)]}),e.jsx("input",{type:"range",min:"0.01",max:"1",step:"0.01",value:h.learningRate,onChange:i=>f(t=>({...t,learningRate:Number(i.target.value)})),className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:N,onChange:i=>Q(i.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Show Weights"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:w,onChange:i=>Z(i.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Show Activations"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:C,onChange:i=>tt(i.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Show Bias"})]})]})]}),g.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Test Patterns"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:g.map((i,t)=>e.jsx("button",{type:"button",onClick:()=>ht(t),className:`px-3 py-1 text-sm rounded-md transition-colors ${t===x?"bg-indigo-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:i.name},t))})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("canvas",{ref:b,className:"border border-gray-300 rounded-lg bg-gradient-to-br from-gray-900 to-blue-900",style:{maxWidth:"100%",height:"auto"}}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Neural network with animated learning and real-time weight visualization"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-purple-800",children:"Machine Learning Concepts"}),e.jsxs("ul",{className:"text-purple-700 space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Forward Propagation"}),": Signal flows from input to output"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Backpropagation"}),": Error gradients update weights"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Activation Functions"}),": Non-linear transformations"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Learning Rate"}),": Controls speed of weight updates"]})]})]}),e.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-indigo-800",children:"Visualization Features"}),e.jsxs("ul",{className:"text-indigo-700 space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Weight Visualization"}),": Green for positive, red for negative"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Activation Patterns"}),": Neuron brightness shows activity"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Training Progress"}),": Real-time error and epoch tracking"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Interactive Testing"}),": Test different input patterns"]})]})]})]}),e.jsxs("div",{className:"mt-6 bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-orange-800",children:"Applications"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-orange-700",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Computer Vision:"}),e.jsxs("ul",{className:"text-sm mt-1",children:[e.jsx("li",{children:"• Image classification"}),e.jsx("li",{children:"• Object detection"}),e.jsx("li",{children:"• Feature extraction"})]})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Natural Language:"}),e.jsxs("ul",{className:"text-sm mt-1",children:[e.jsx("li",{children:"• Text classification"}),e.jsx("li",{children:"• Language translation"}),e.jsx("li",{children:"• Sentiment analysis"})]})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Data Science:"}),e.jsxs("ul",{className:"text-sm mt-1",children:[e.jsx("li",{children:"• Pattern recognition"}),e.jsx("li",{children:"• Predictive modeling"}),e.jsx("li",{children:"• Anomaly detection"})]})]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(gt,{to:"/examples/visual",className:"inline-block px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:"← Back to Examples"})})]})};export{ft as component};
