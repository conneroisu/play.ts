import{j as s,r as h,P as A,T as P}from"./index-BqTI3VMm.js";const J=()=>s.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-orange-500"}),s.jsx("span",{className:"ml-4 text-lg text-gray-600",children:"Loading Circuit Analysis..."})]});function K(){const F=h.useRef(null),T=h.useRef();h.useRef(0);const[b,C]=h.useState([{id:"V1",type:"voltage_source",value:12,unit:"V",x:100,y:200,rotation:0,node1:"n1",node2:"gnd",isSelected:!1},{id:"R1",type:"resistor",value:1e3,unit:"Ω",x:200,y:150,rotation:0,node1:"n1",node2:"n2",isSelected:!1},{id:"R2",type:"resistor",value:2e3,unit:"Ω",x:300,y:200,rotation:90,node1:"n2",node2:"gnd",isSelected:!1},{id:"C1",type:"capacitor",value:.001,unit:"F",x:400,y:200,rotation:90,node1:"n2",node2:"gnd",isSelected:!1}]),[V,w]=h.useState([{id:"n1",x:150,y:150,voltage:0,connections:[]},{id:"n2",x:250,y:150,voltage:0,connections:[]},{id:"gnd",x:200,y:300,voltage:0,connections:[]}]),[R,L]=h.useState([]),[Q,U]=h.useState("select"),[m,$]=h.useState(null),[p,E]=h.useState(!1),[c,x]=h.useState({analysisType:"dc",frequency:1e3,timeStep:.001,duration:.01,tolerance:1e-6,maxIterations:100,showVoltages:!0,showCurrents:!1,showPower:!1,showGrid:!0,gridSize:25,autoScale:!0}),[M,z]=h.useState("voltage_divider"),_=e=>{switch(e){case"voltage_divider":C([{id:"V1",type:"voltage_source",value:12,unit:"V",x:100,y:200,rotation:0,node1:"n1",node2:"gnd",isSelected:!1},{id:"R1",type:"resistor",value:1e3,unit:"Ω",x:200,y:150,rotation:0,node1:"n1",node2:"n2",isSelected:!1},{id:"R2",type:"resistor",value:2e3,unit:"Ω",x:300,y:200,rotation:90,node1:"n2",node2:"gnd",isSelected:!1}]),w([{id:"n1",x:150,y:150,voltage:0,connections:[]},{id:"n2",x:250,y:150,voltage:0,connections:[]},{id:"gnd",x:200,y:300,voltage:0,connections:[]}]);break;case"rc_filter":C([{id:"V1",type:"voltage_source",value:5,unit:"V",x:100,y:200,rotation:0,node1:"n1",node2:"gnd",isSelected:!1},{id:"R1",type:"resistor",value:1e3,unit:"Ω",x:200,y:150,rotation:0,node1:"n1",node2:"n2",isSelected:!1},{id:"C1",type:"capacitor",value:1e-6,unit:"F",x:300,y:200,rotation:90,node1:"n2",node2:"gnd",isSelected:!1}]),w([{id:"n1",x:150,y:150,voltage:0,connections:[]},{id:"n2",x:250,y:150,voltage:0,connections:[]},{id:"gnd",x:200,y:300,voltage:0,connections:[]}]),x(n=>({...n,analysisType:"ac",frequency:1e3}));break;case"rlc_resonant":C([{id:"V1",type:"voltage_source",value:10,unit:"V",x:100,y:200,rotation:0,node1:"n1",node2:"gnd",isSelected:!1},{id:"R1",type:"resistor",value:100,unit:"Ω",x:200,y:150,rotation:0,node1:"n1",node2:"n2",isSelected:!1},{id:"L1",type:"inductor",value:.001,unit:"H",x:300,y:150,rotation:0,node1:"n2",node2:"n3",isSelected:!1},{id:"C1",type:"capacitor",value:1e-6,unit:"F",x:400,y:200,rotation:90,node1:"n3",node2:"gnd",isSelected:!1}]),w([{id:"n1",x:150,y:150,voltage:0,connections:[]},{id:"n2",x:250,y:150,voltage:0,connections:[]},{id:"n3",x:350,y:150,voltage:0,connections:[]},{id:"gnd",x:200,y:300,voltage:0,connections:[]}]),x(n=>({...n,analysisType:"ac",frequency:5e3}));break}},D=(e,n)=>{const o=2*A*n;switch(e.type){case"resistor":return{magnitude:e.value,phase:0};case"capacitor":return{magnitude:1/(o*e.value),phase:-90};case"inductor":return{magnitude:o*e.value,phase:90};default:return{magnitude:0,phase:0}}},k=async()=>{const e=new Map,n=new Map,o=new Map,l=new Map,d=[...new Set(b.flatMap(a=>[a.node1,a.node2].filter(Boolean)))].filter(a=>a!=="gnd");if(d.length===0)return{nodeVoltages:e,branchCurrents:n,power:o,totalPower:0,impedances:l,frequency:0,analysisType:"dc"};await new Promise(a=>setTimeout(a,0)),e.set("gnd",0);const v=b.filter(a=>a.type==="voltage_source"),j=new Set(["gnd"]);v.forEach(a=>{a.node2==="gnd"?(e.set(a.node1,a.value),j.add(a.node1)):a.node1==="gnd"&&(e.set(a.node2,-a.value),j.add(a.node2))});const u=d.filter(a=>!j.has(a));if(u.length>0){const a=Array(u.length).fill(null).map(()=>Array(u.length).fill(0)),f=Array(u.length).fill(0);b.forEach(g=>{if(g.type==="resistor"){const t=1/g.value,i=u.indexOf(g.node1),r=u.indexOf(g.node2);i>=0&&j.has(g.node2)?(a[i][i]+=t,f[i]+=t*(e.get(g.node2)||0)):r>=0&&j.has(g.node1)?(a[r][r]+=t,f[r]+=t*(e.get(g.node1)||0)):i>=0&&r>=0&&(a[i][i]+=t,a[i][r]-=t,a[r][r]+=t,a[r][i]-=t)}});try{for(let t=0;t<u.length;t++){let i=t;for(let r=t+1;r<u.length;r++)Math.abs(a[r][t])>Math.abs(a[i][t])&&(i=r);if(i!==t&&([a[t],a[i]]=[a[i],a[t]],[f[t],f[i]]=[f[i],f[t]]),!(Math.abs(a[t][t])<1e-10))for(let r=t+1;r<u.length;r++){const W=a[r][t]/a[t][t];f[r]-=W*f[t];for(let S=t;S<u.length;S++)a[r][S]-=W*a[t][S]}}const g=Array(u.length).fill(0);for(let t=u.length-1;t>=0;t--){g[t]=f[t];for(let i=t+1;i<u.length;i++)g[t]-=a[t][i]*g[i];Math.abs(a[t][t])>1e-10&&(g[t]/=a[t][t])}u.forEach((t,i)=>{e.set(t,g[i]||0)})}catch(g){console.warn("Circuit analysis failed:",g),u.forEach(t=>{e.set(t,0)})}}let N=0;return b.forEach(a=>{const f=e.get(a.node1)||0,g=e.get(a.node2)||0,t=f-g;let i=0,r=0;switch(a.type){case"resistor":i=t/a.value,r=i*t;break;case"voltage_source":i=0,r=0;break;case"current_source":i=a.value,r=i*t;break}n.set(a.id,i),o.set(a.id,r),N+=Math.abs(r),a.type!=="voltage_source"&&a.type!=="current_source"&&l.set(a.id,{magnitude:a.value,phase:0})}),{nodeVoltages:e,branchCurrents:n,power:o,totalPower:N,impedances:l,frequency:0,analysisType:"dc"}},G=async e=>{const n=await k();return b.forEach(o=>{const l=D(o,e);n.impedances.set(o.id,l)}),n.frequency=e,n.analysisType="ac",n},O=async()=>{E(!0);try{let e;switch(c.analysisType){case"dc":e=await k();break;case"ac":e=await G(c.frequency);break;case"transient":e=await k();break;default:e=await k()}$(e),w(n=>n.map(o=>({...o,voltage:e.nodeVoltages.get(o.id)||0})))}catch(e){console.error("Circuit analysis failed:",e)}finally{E(!1)}},B=(e,n)=>{const{x:o,y:l,rotation:d,type:y,value:v,unit:j,isSelected:u}=n;switch(e.save(),e.translate(o,l),e.rotate(d*A/180),u?(e.strokeStyle="red",e.lineWidth=3):(e.strokeStyle="black",e.lineWidth=2),y){case"resistor":e.beginPath(),e.moveTo(-30,0),e.lineTo(-20,0),e.lineTo(-15,-10),e.lineTo(-5,10),e.lineTo(5,-10),e.lineTo(15,10),e.lineTo(20,0),e.lineTo(30,0),e.stroke();break;case"capacitor":e.beginPath(),e.moveTo(-30,0),e.lineTo(-5,0),e.moveTo(-5,-15),e.lineTo(-5,15),e.moveTo(5,-15),e.lineTo(5,15),e.moveTo(5,0),e.lineTo(30,0),e.stroke();break;case"inductor":e.beginPath(),e.moveTo(-30,0),e.lineTo(-15,0);for(let N=0;N<4;N++)e.arc(-15+N*7.5,0,3.75,0,A,!1);e.moveTo(15,0),e.lineTo(30,0),e.stroke();break;case"voltage_source":e.beginPath(),e.arc(0,0,15,0,P),e.stroke(),e.font="12px Arial",e.textAlign="center",e.fillText("+",-5,-5),e.fillText("-",5,5),e.beginPath(),e.moveTo(-30,0),e.lineTo(-15,0),e.moveTo(15,0),e.lineTo(30,0),e.stroke();break;case"current_source":e.beginPath(),e.arc(0,0,15,0,P),e.stroke(),e.beginPath(),e.moveTo(-8,0),e.lineTo(8,0),e.lineTo(5,-3),e.moveTo(8,0),e.lineTo(5,3),e.stroke();break}e.fillStyle=u?"red":"black",e.font="10px Arial",e.textAlign="center",e.fillText(`${n.id}`,0,-25),e.fillText(`${v}${j}`,0,40),e.restore()},X=(e,n)=>{const{x:o,y:l,voltage:d,id:y}=n;e.fillStyle=y==="gnd"?"black":"blue",e.beginPath(),e.arc(o,l,4,0,P),e.fill(),c.showVoltages&&m&&(e.fillStyle="blue",e.font="10px Arial",e.textAlign="center",e.fillText(`${d.toFixed(2)}V`,o,l-10)),e.fillStyle="black",e.font="8px Arial",e.fillText(y,o,l+15)},H=(e,n,o)=>{if(c.showGrid){e.strokeStyle="rgba(200, 200, 200, 0.3)",e.lineWidth=1;for(let l=0;l<=n;l+=c.gridSize)e.beginPath(),e.moveTo(l,0),e.lineTo(l,o),e.stroke();for(let l=0;l<=o;l+=c.gridSize)e.beginPath(),e.moveTo(0,l),e.lineTo(n,l),e.stroke()}},q=()=>{const e=F.current;if(!e)return;const n=e.getContext("2d");if(!n)return;const o=e.width,l=e.height;n.clearRect(0,0,o,l),H(n,o,l),R.forEach(d=>{if(n.strokeStyle="gray",n.lineWidth=2,n.beginPath(),d.points.length>=2){n.moveTo(d.points[0].x,d.points[0].y);for(let y=1;y<d.points.length;y++)n.lineTo(d.points[y].x,d.points[y].y)}if(n.stroke(),c.showCurrents&&m){const y=m.branchCurrents.get(d.id)||0;if(Math.abs(y)>.001){const v=d.points[Math.floor(d.points.length/2)];n.fillStyle="green",n.font="10px Arial",n.textAlign="center",n.fillText(`${y.toFixed(3)}A`,v.x,v.y-5)}}}),b.forEach(d=>B(n,d)),V.forEach(d=>X(n,d)),c.showPower&&m&&(n.fillStyle="purple",n.font="12px Arial",n.textAlign="left",n.fillText(`Total Power: ${m.totalPower.toFixed(3)} W`,10,l-20))},I=(e,n)=>Math.abs(e)>=1e6?`${(e/1e6).toFixed(2)}M${n}`:Math.abs(e)>=1e3?`${(e/1e3).toFixed(2)}k${n}`:Math.abs(e)>=1?`${e.toFixed(2)}${n}`:Math.abs(e)>=.001?`${(e*1e3).toFixed(2)}m${n}`:Math.abs(e)>=1e-6?`${(e*1e6).toFixed(2)}μ${n}`:Math.abs(e)>=1e-9?`${(e*1e9).toFixed(2)}n${n}`:`${(e*1e12).toFixed(2)}p${n}`;return h.useEffect(()=>{q()},[b,V,R,c,m]),h.useEffect(()=>{if(!p)return;const e=()=>{q(),p&&(T.current=requestAnimationFrame(e))};return T.current=requestAnimationFrame(e),()=>{T.current&&cancelAnimationFrame(T.current)}},[p]),h.useEffect(()=>{_(M)},[]),s.jsx("div",{className:"w-full max-w-6xl mx-auto p-6 bg-gradient-to-br from-yellow-50 to-orange-50 min-h-screen",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Circuit Analysis & Design"}),s.jsx("div",{className:"text-sm text-gray-600 bg-gray-100 px-3 py-1 rounded-full",children:"Electrical Engineering Tool"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-2",children:[s.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:s.jsx("canvas",{ref:F,width:700,height:500,className:"border border-gray-300 rounded-lg bg-white w-full cursor-crosshair"})}),s.jsxs("div",{className:"flex gap-2 mb-4",children:[s.jsx("button",{onClick:O,disabled:p,className:`px-4 py-2 rounded-lg font-medium transition-all ${p?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 text-white"}`,children:p?"Analyzing...":"Analyze Circuit"}),s.jsx("button",{onClick:()=>{C([]),w([]),L([]),$(null)},disabled:p,className:`px-4 py-2 rounded-lg transition-all ${p?"bg-gray-400 cursor-not-allowed":"bg-gray-500 hover:bg-gray-600 text-white"}`,children:"Clear Circuit"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Circuit Presets"}),s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Load Circuit"}),s.jsxs("select",{value:M,onChange:e=>{z(e.target.value),_(e.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent mb-3",children:[s.jsx("option",{value:"voltage_divider",children:"Voltage Divider"}),s.jsx("option",{value:"rc_filter",children:"RC Low-Pass Filter"}),s.jsx("option",{value:"rlc_resonant",children:"RLC Resonant Circuit"}),s.jsx("option",{value:"bridge",children:"Wheatstone Bridge"}),s.jsx("option",{value:"amplifier",children:"Op-Amp Circuit"}),s.jsx("option",{value:"custom",children:"Custom"})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Analysis Settings"}),s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Analysis Type"}),s.jsxs("select",{value:c.analysisType,onChange:e=>x(n=>({...n,analysisType:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent mb-3",children:[s.jsx("option",{value:"dc",children:"DC Analysis"}),s.jsx("option",{value:"ac",children:"AC Analysis"}),s.jsx("option",{value:"transient",children:"Transient Analysis"})]}),c.analysisType==="ac"&&s.jsxs(s.Fragment,{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Frequency: ",I(c.frequency,"Hz")]}),s.jsx("input",{type:"range",min:"1",max:"1000000",step:"1",value:c.frequency,onChange:e=>x(n=>({...n,frequency:Number.parseInt(e.target.value)})),className:"w-full mb-3"})]}),s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tolerance: ",c.tolerance]}),s.jsx("input",{type:"range",min:"1e-9",max:"1e-3",step:"1e-9",value:c.tolerance,onChange:e=>x(n=>({...n,tolerance:Number.parseFloat(e.target.value)})),className:"w-full"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Display Options"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:c.showVoltages,onChange:e=>x(n=>({...n,showVoltages:e.target.checked})),className:"mr-2"}),"Node Voltages"]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:c.showCurrents,onChange:e=>x(n=>({...n,showCurrents:e.target.checked})),className:"mr-2"}),"Branch Currents"]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:c.showPower,onChange:e=>x(n=>({...n,showPower:e.target.checked})),className:"mr-2"}),"Power Calculations"]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:c.showGrid,onChange:e=>x(n=>({...n,showGrid:e.target.checked})),className:"mr-2"}),"Grid"]})]})]}),m&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Analysis Results"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Node Voltages"}),s.jsx("div",{className:"space-y-1 text-sm",children:Array.from(m.nodeVoltages.entries()).map(([e,n])=>s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:[e,":"]}),s.jsxs("span",{className:"font-mono",children:[n.toFixed(3)," V"]})]},e))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Branch Currents"}),s.jsx("div",{className:"space-y-1 text-sm",children:Array.from(m.branchCurrents.entries()).map(([e,n])=>s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:[e,":"]}),s.jsxs("span",{className:"font-mono",children:[n.toFixed(6)," A"]})]},e))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Power Dissipation"}),s.jsxs("div",{className:"space-y-1 text-sm",children:[Array.from(m.power.entries()).map(([e,n])=>s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:[e,":"]}),s.jsxs("span",{className:"font-mono",children:[n.toFixed(6)," W"]})]},e)),s.jsxs("div",{className:"flex justify-between font-medium pt-2 border-t",children:[s.jsx("span",{children:"Total:"}),s.jsxs("span",{className:"font-mono",children:[m.totalPower.toFixed(6)," W"]})]})]})]}),c.analysisType==="ac"&&s.jsxs("div",{children:[s.jsxs("h4",{className:"font-medium text-gray-700 mb-2",children:["Impedances @"," ",I(m.frequency,"Hz")]}),s.jsx("div",{className:"space-y-1 text-sm",children:Array.from(m.impedances.entries()).map(([e,n])=>s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:[e,":"]}),s.jsxs("span",{className:"font-mono",children:[n.magnitude.toFixed(2),"Ω ∠",n.phase.toFixed(1),"°"]})]},e))})]})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Component Library"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[s.jsxs("div",{className:"bg-white p-2 rounded border",children:[s.jsx("strong",{children:"Passive:"}),s.jsxs("ul",{className:"mt-1 space-y-1",children:[s.jsx("li",{children:"• Resistors (R)"}),s.jsx("li",{children:"• Capacitors (C)"}),s.jsx("li",{children:"• Inductors (L)"})]})]}),s.jsxs("div",{className:"bg-white p-2 rounded border",children:[s.jsx("strong",{children:"Sources:"}),s.jsxs("ul",{className:"mt-1 space-y-1",children:[s.jsx("li",{children:"• Voltage Source (V)"}),s.jsx("li",{children:"• Current Source (I)"}),s.jsx("li",{children:"• AC Sources"})]})]})]})]})]})]}),s.jsxs("div",{className:"mt-6 bg-yellow-50 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"Electrical Engineering Applications"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-yellow-700",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Circuit Design:"}),s.jsxs("ul",{className:"mt-1 space-y-1",children:[s.jsx("li",{children:"• Filter design and analysis"}),s.jsx("li",{children:"• Power supply circuits"}),s.jsx("li",{children:"• Amplifier design"}),s.jsx("li",{children:"• Impedance matching"})]})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Educational & Analysis:"}),s.jsxs("ul",{className:"mt-1 space-y-1",children:[s.jsx("li",{children:"• Circuit theory validation"}),s.jsx("li",{children:"• Frequency response analysis"}),s.jsx("li",{children:"• Node and mesh analysis"}),s.jsx("li",{children:"• Component selection"})]})]})]})]})]})})}const Z=()=>s.jsx(h.Suspense,{fallback:s.jsx(J,{}),children:s.jsx(K,{})});export{Z as component};
