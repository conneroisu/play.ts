import{r as m,j as s,L as _,C as ee,t as P,h as L,b as j,D as u,i as l,E as x,f as g,e as D,g as d,F as T,v as te}from"./index-BqTI3VMm.js";const ae=function(){const p=m.useRef(null),f=m.useRef(),y=m.useRef([]),h=m.useRef({x:0,y:0,pressed:!1}),[S,E]=m.useState(!1),[k,B]=m.useState(50),[W,z]=m.useState(!1),[C,I]=m.useState(!0),[N,$]=m.useState(!1),[i,v]=m.useState({separationRadius:25,alignmentRadius:50,cohesionRadius:50,separationWeight:1.5,alignmentWeight:1,cohesionWeight:1,maxSpeed:2,maxForce:.03,edgeBehavior:"wrap"}),M=(e,t)=>{const n=p.current;return n?{position:{x:e??j(0,n.width),y:t??j(0,n.height)},velocity:{x:j(-1,1),y:j(-1,1)},acceleration:{x:0,y:0},maxSpeed:i.maxSpeed,maxForce:i.maxForce,size:j(4,8),color:L(j(180,240),70,60),trail:[]}:q()},q=()=>({position:{x:0,y:0},velocity:{x:0,y:0},acceleration:{x:0,y:0},maxSpeed:2,maxForce:.03,size:6,color:L(200,70,60),trail:[]}),R=()=>{const e=[];for(let t=0;t<k;t++)e.push(M());y.current=e},b=(e,t)=>y.current.filter(n=>n===e?!1:te(e.position,n.position)<t),V=e=>{const t=b(e,i.separationRadius);if(t.length===0)return{x:0,y:0};let n={x:0,y:0};return t.forEach(a=>{const r=d(e.position,a.position),o=x(r);if(o>0){const c=g(r),F=T(c,o);n=u(n,F)}}),x(n)>0&&(n=g(n),n=l(n,e.maxSpeed),n=d(n,e.velocity),n=l(n,Math.min(x(n),e.maxForce))),n},X=e=>{const t=b(e,i.alignmentRadius);if(t.length===0)return{x:0,y:0};let n={x:0,y:0};t.forEach(r=>{n=u(n,r.velocity)}),n=T(n,t.length);let a=g(n);return a=l(a,e.maxSpeed),a=d(a,e.velocity),a=l(a,Math.min(x(a),e.maxForce)),a},Y=(e,t)=>{let n=d(t,e.position);n=g(n),n=l(n,e.maxSpeed);let a=d(n,e.velocity);return a=l(a,Math.min(x(a),e.maxForce)),a},H=(e,t)=>{let n=d(e.position,t);if(x(n)<100){n=g(n),n=l(n,e.maxSpeed);let r=d(n,e.velocity);return r=l(r,Math.min(x(r),e.maxForce*2)),r}return{x:0,y:0}},U=e=>{const t=p.current;if(!t)return{x:0,y:0};const n=50;let a={x:0,y:0};return e.position.x<n?a.x=e.maxSpeed:e.position.x>t.width-n&&(a.x=-e.maxSpeed),e.position.y<n?a.y=e.maxSpeed:e.position.y>t.height-n&&(a.y=-e.maxSpeed),x(a)>0&&(a=g(a),a=l(a,e.maxSpeed),a=d(a,e.velocity),a=l(a,Math.min(x(a),e.maxForce))),a},G=e=>{const t=p.current;if(!t)return;e.acceleration={x:0,y:0};const n=V(e),a=X(e),r=r(e);if(e.acceleration=u(e.acceleration,l(n,i.separationWeight)),e.acceleration=u(e.acceleration,l(a,i.alignmentWeight)),e.acceleration=u(e.acceleration,l(r,i.cohesionWeight)),h.current.pressed){const c=N?H(e,h.current):Y(e,h.current);e.acceleration=u(e.acceleration,l(c,2))}if(i.edgeBehavior==="avoid"){const c=U(e);e.acceleration=u(e.acceleration,l(c,2))}e.velocity=u(e.velocity,e.acceleration),x(e.velocity)>e.maxSpeed&&(e.velocity=l(g(e.velocity),e.maxSpeed)),e.position=u(e.position,e.velocity),i.edgeBehavior==="wrap"?(e.position.x<0&&(e.position.x=t.width),e.position.x>t.width&&(e.position.x=0),e.position.y<0&&(e.position.y=t.height),e.position.y>t.height&&(e.position.y=0)):i.edgeBehavior==="bounce"&&((e.position.x<0||e.position.x>t.width)&&(e.velocity.x*=-1,e.position.x=D(e.position.x,0,t.width)),(e.position.y<0||e.position.y>t.height)&&(e.velocity.y*=-1,e.position.y=D(e.position.y,0,t.height))),C&&(e.trail.push({x:e.position.x,y:e.position.y,alpha:1}),e.trail.forEach(c=>{c.alpha*=.95}),e.trail=e.trail.filter(c=>c.alpha>.1),e.trail.length>20&&e.trail.shift()),e.maxSpeed=i.maxSpeed,e.maxForce=i.maxForce},w=()=>{const e=p.current,t=e==null?void 0:e.getContext("2d");!e||!t||(t.fillStyle="rgba(15, 23, 42, 0.1)",t.fillRect(0,0,e.width,e.height),y.current.forEach(n=>{if(C&&n.trail.length>1){t.strokeStyle=`hsla(${n.color.h}, ${n.color.s}%, ${n.color.l}%, 0.3)`,t.lineWidth=1,t.beginPath(),t.moveTo(n.trail[0].x,n.trail[0].y);for(let o=1;o<n.trail.length;o++)t.globalAlpha=n.trail[o].alpha*.5,t.lineTo(n.trail[o].x,n.trail[o].y);t.stroke(),t.globalAlpha=1}const a=ee(n.velocity),r=n.size;t.save(),t.translate(n.position.x,n.position.y),t.rotate(a),t.fillStyle=P(n.color),t.beginPath(),t.moveTo(r,0),t.lineTo(-r,-r/2),t.lineTo(-r/2,0),t.lineTo(-r,r/2),t.closePath(),t.fill(),t.strokeStyle=P({...n.color,l:n.color.l-20}),t.lineWidth=1,t.stroke(),t.restore(),W&&(t.strokeStyle="rgba(255, 0, 0, 0.2)",t.lineWidth=1,t.beginPath(),t.arc(n.position.x,n.position.y,i.separationRadius,0,Math.PI*2),t.stroke(),t.strokeStyle="rgba(0, 255, 0, 0.2)",t.beginPath(),t.arc(n.position.x,n.position.y,i.alignmentRadius,0,Math.PI*2),t.stroke(),t.strokeStyle="rgba(0, 0, 255, 0.2)",t.beginPath(),t.arc(n.position.x,n.position.y,i.cohesionRadius,0,Math.PI*2),t.stroke())}),h.current.pressed&&(t.fillStyle=N?"rgba(220, 53, 69, 0.5)":"rgba(40, 167, 69, 0.5)",t.beginPath(),t.arc(h.current.x,h.current.y,N?20:15,0,Math.PI*2),t.fill()))},A=()=>{S&&(y.current.forEach(G),w(),f.current=requestAnimationFrame(A))},J=()=>{E(!0),f.current=requestAnimationFrame(A)},K=()=>{E(!1),f.current&&cancelAnimationFrame(f.current)},O=()=>{R(),w()};return m.useEffect(()=>{const e=p.current;if(!e)return;e.width=800,e.height=600;const t=o=>{const c=e.getBoundingClientRect();h.current.x=o.clientX-c.left,h.current.y=o.clientY-c.top},n=()=>{h.current.pressed=!0},a=()=>{h.current.pressed=!1},r=o=>{const c=e.getBoundingClientRect(),F=o.clientX-c.left,Q=o.clientY-c.top;if(!N){const Z=M(F,Q);y.current.push(Z),B(y.current.length)}};return e.addEventListener("mousemove",t),e.addEventListener("mousedown",n),e.addEventListener("mouseup",a),e.addEventListener("click",r),R(),w(),()=>{e.removeEventListener("mousemove",t),e.removeEventListener("mousedown",n),e.removeEventListener("mouseup",a),e.removeEventListener("click",r),f.current&&cancelAnimationFrame(f.current)}},[]),m.useEffect(()=>{R(),S||w()},[k]),s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Craig Reynolds Boids Flocking"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Complete emergent behavior simulation with interactive forces, real-time parameters, and visual debugging."}),s.jsx("div",{className:"bg-cyan-50 border border-cyan-200 rounded-lg p-4",children:s.jsx("p",{className:"text-cyan-800",children:"üê¶ Watch boids flock together! Click to add boids, hold mouse to attract/repel"})})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[s.jsx("button",{type:"button",onClick:J,disabled:S,className:"px-4 py-2 bg-cyan-600 text-white rounded-md hover:bg-cyan-700 disabled:opacity-50 transition-colors",children:"Start Simulation"}),s.jsx("button",{type:"button",onClick:K,disabled:!S,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 transition-colors",children:"Stop Simulation"}),s.jsx("button",{type:"button",onClick:O,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:"Reset Boids"})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[s.jsx("div",{className:"flex items-center",children:s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:W,onChange:e=>z(e.target.checked),className:"mr-2"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Show Debug"})]})}),s.jsx("div",{className:"flex items-center",children:s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:C,onChange:e=>I(e.target.checked),className:"mr-2"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Show Trails"})]})}),s.jsx("div",{className:"flex items-center",children:s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:N,onChange:e=>$(e.target.checked),className:"mr-2"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Predator Mode"})]})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Edge Behavior"}),s.jsxs("select",{value:i.edgeBehavior,onChange:e=>v(t=>({...t,edgeBehavior:e.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500",children:[s.jsx("option",{value:"wrap",children:"Wrap"}),s.jsx("option",{value:"bounce",children:"Bounce"}),s.jsx("option",{value:"avoid",children:"Avoid"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Boid Count: ",k]}),s.jsx("input",{type:"range",min:"10",max:"200",value:k,onChange:e=>B(Number(e.target.value)),className:"w-full"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Max Speed: ",i.maxSpeed.toFixed(1)]}),s.jsx("input",{type:"range",min:"0.5",max:"5",step:"0.1",value:i.maxSpeed,onChange:e=>v(t=>({...t,maxSpeed:Number(e.target.value)})),className:"w-full"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Separation: ",i.separationWeight.toFixed(1)]}),s.jsx("input",{type:"range",min:"0",max:"3",step:"0.1",value:i.separationWeight,onChange:e=>v(t=>({...t,separationWeight:Number(e.target.value)})),className:"w-full"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Alignment: ",i.alignmentWeight.toFixed(1)]}),s.jsx("input",{type:"range",min:"0",max:"3",step:"0.1",value:i.alignmentWeight,onChange:e=>v(t=>({...t,alignmentWeight:Number(e.target.value)})),className:"w-full"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Cohesion: ",i.cohesionWeight.toFixed(1)]}),s.jsx("input",{type:"range",min:"0",max:"3",step:"0.1",value:i.cohesionWeight,onChange:e=>v(t=>({...t,cohesionWeight:Number(e.target.value)})),className:"w-full"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Separation Radius: ",i.separationRadius]}),s.jsx("input",{type:"range",min:"10",max:"100",value:i.separationRadius,onChange:e=>v(t=>({...t,separationRadius:Number(e.target.value)})),className:"w-full"})]})]})]}),s.jsx("div",{className:"mb-6",children:s.jsx("canvas",{ref:p,className:"border border-gray-300 rounded-lg bg-slate-900 cursor-crosshair",style:{maxWidth:"100%",height:"auto"}})}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2 text-yellow-800",children:"Flocking Rules"}),s.jsxs("ul",{className:"text-yellow-700 space-y-1",children:[s.jsxs("li",{children:["‚Ä¢ ",s.jsx("strong",{children:"Separation"}),": Steer to avoid crowding local flockmates"]}),s.jsxs("li",{children:["‚Ä¢ ",s.jsx("strong",{children:"Alignment"}),": Steer towards average heading of neighbors"]}),s.jsxs("li",{children:["‚Ä¢ ",s.jsx("strong",{children:"Cohesion"}),": Steer to move toward average position of neighbors"]}),s.jsxs("li",{children:["‚Ä¢ ",s.jsx("strong",{children:"Emergence"}),": Complex flocking behavior from simple rules"]})]})]}),s.jsxs("div",{className:"bg-cyan-50 border border-cyan-200 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2 text-cyan-800",children:"Interactive Features"}),s.jsxs("ul",{className:"text-cyan-700 space-y-1",children:[s.jsxs("li",{children:["‚Ä¢ ",s.jsx("strong",{children:"Mouse Interaction"}),": Attract or repel boids with mouse"]}),s.jsxs("li",{children:["‚Ä¢ ",s.jsx("strong",{children:"Real-time Controls"}),": Adjust flocking parameters live"]}),s.jsxs("li",{children:["‚Ä¢ ",s.jsx("strong",{children:"Edge Behaviors"}),": Wrap, bounce, or avoid boundaries"]}),s.jsxs("li",{children:["‚Ä¢ ",s.jsx("strong",{children:"Debug Mode"}),": Visualize perception radii and forces"]})]})]})]}),s.jsx("div",{className:"mt-6",children:s.jsx(_,{to:"/examples/visual",className:"inline-block px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 transition-colors",children:"‚Üê Back to Examples"})})]})};export{ae as component};
