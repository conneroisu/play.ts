import{r as p,P as b,j as s,L as le,k as v,s as j,e as Z,t as de,Q as B,h as f}from"./index-BqTI3VMm.js";const me=function(){const T=p.useRef(null),M=p.useRef(),y=p.useRef({x:0,y:0,dragging:!1,lastX:0,lastY:0}),[D,X]=p.useState(!1),[A,I]=p.useState("cube"),[x,R]=p.useState({position:{x:0,y:0,z:5},rotation:{x:0,y:0,z:0},fov:b/4,near:.1,far:100}),[l,S]=p.useState({showWireframe:!0,showFaces:!0,showVertices:!1,backfaceCulling:!0,lighting:!0,autoRotate:!1,renderMode:"both"}),L=()=>[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],$=e=>[[1,0,0,0],[0,v(e),-j(e),0],[0,j(e),v(e),0],[0,0,0,1]],q=e=>[[v(e),0,j(e),0],[0,1,0,0],[-j(e),0,v(e),0],[0,0,0,1]],H=e=>[[v(e),-j(e),0,0],[j(e),v(e),0,0],[0,0,1,0],[0,0,0,1]],U=(e,t,n)=>[[1,0,0,e],[0,1,0,t],[0,0,1,n],[0,0,0,1]],O=(e,t,n,r)=>{const o=1/Math.tan(e/2),i=1/(n-r);return[[o/t,0,0,0],[0,o,0,0],[0,0,(n+r)*i,n*r*i*2],[0,0,-1,0]]},F=(e,t)=>{const n=L();for(let r=0;r<4;r++)for(let o=0;o<4;o++){n[r][o]=0;for(let i=0;i<4;i++)n[r][o]+=e[r][i]*t[i][o]}return n},Q=(e,t)=>{const n=e.x*t[0][0]+e.y*t[0][1]+e.z*t[0][2]+t[0][3],r=e.x*t[1][0]+e.y*t[1][1]+e.z*t[1][2]+t[1][3],o=e.x*t[2][0]+e.y*t[2][1]+e.z*t[2][2]+t[2][3],i=e.x*t[3][0]+e.y*t[3][1]+e.z*t[3][2]+t[3][3];return{x:n/i,y:r/i,z:o/i}},G=(e,t,n)=>({x:(e.x+1)*t/2,y:(1-e.y)*n/2}),Y=()=>({vertices:[{x:-1,y:-1,z:-1},{x:1,y:-1,z:-1},{x:1,y:1,z:-1},{x:-1,y:1,z:-1},{x:-1,y:-1,z:1},{x:1,y:-1,z:1},{x:1,y:1,z:1},{x:-1,y:1,z:1}],edges:[{start:0,end:1},{start:1,end:2},{start:2,end:3},{start:3,end:0},{start:4,end:5},{start:5,end:6},{start:6,end:7},{start:7,end:4},{start:0,end:4},{start:1,end:5},{start:2,end:6},{start:3,end:7}],faces:[{vertices:[0,1,2,3],color:f(0,70,60)},{vertices:[4,7,6,5],color:f(60,70,60)},{vertices:[0,4,5,1],color:f(120,70,60)},{vertices:[2,6,7,3],color:f(180,70,60)},{vertices:[0,3,7,4],color:f(240,70,60)},{vertices:[1,5,6,2],color:f(300,70,60)}],center:{x:0,y:0,z:0}}),J=()=>({vertices:[{x:0,y:1.5,z:0},{x:-1,y:-1,z:1},{x:1,y:-1,z:1},{x:1,y:-1,z:-1},{x:-1,y:-1,z:-1}],edges:[{start:0,end:1},{start:0,end:2},{start:0,end:3},{start:0,end:4},{start:1,end:2},{start:2,end:3},{start:3,end:4},{start:4,end:1}],faces:[{vertices:[0,1,2],color:f(0,70,60)},{vertices:[0,2,3],color:f(90,70,60)},{vertices:[0,3,4],color:f(180,70,60)},{vertices:[0,4,1],color:f(270,70,60)},{vertices:[1,4,3,2],color:f(45,70,60)}],center:{x:0,y:0,z:0}}),K=(e=1,t=12,n=8)=>{const r=[],o=[],i=[];for(let c=0;c<=n;c++){const a=c/n*b;for(let d=0;d<=t;d++){const u=d/t*B;r.push({x:e*j(a)*v(u),y:e*v(a),z:e*j(a)*j(u)})}}for(let c=0;c<n;c++)for(let a=0;a<t;a++){const d=c*(t+1)+a,u=d+t+1;c>0&&i.push({vertices:[d,u,u+1,d+1],color:f(c*a*30%360,70,60)}),a<t&&o.push({start:d,end:d+1}),c<n&&o.push({start:d,end:u})}return{vertices:r,edges:o,faces:i,center:{x:0,y:0,z:0}}},_=e=>{switch(e){case"cube":return Y();case"pyramid":return J();case"sphere":return K();default:return Y()}},ee=(e,t)=>{const n=t[e.vertices[0]],r=t[e.vertices[1]],o=t[e.vertices[2]],i={x:r.x-n.x,y:r.y-n.y,z:r.z-n.z},c={x:o.x-n.x,y:o.y-n.y,z:o.z-n.z},a={x:i.y*c.z-i.z*c.y,y:i.z*c.x-i.x*c.z,z:i.x*c.y-i.y*c.x},d=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);return d>0?{x:a.x/d,y:a.y/d,z:a.z/d}:{x:0,y:0,z:1}},V=()=>{const e=T.current,t=e==null?void 0:e.getContext("2d");if(!e||!t)return;const{width:n,height:r}=e;t.clearRect(0,0,n,r);const o=_(A),i=$(x.rotation.x),c=q(x.rotation.y),a=H(x.rotation.z),d=U(-x.position.x,-x.position.y,-x.position.z);let u=F(d,i);u=F(u,c),u=F(u,a);const ie=n/r,ae=O(x.fov,ie,x.near,x.far),ce=F(ae,u),k=o.vertices.map(m=>Q(m,ce)),P=k.map(m=>G(m,n,r));if(l.showFaces&&l.renderMode!=="wireframe"){const m=o.faces.map(h=>{const g=h.vertices.reduce((N,C)=>N+k[C].z,0)/h.vertices.length,w=h.vertices.map(N=>k[N]),z=ee({...h,vertices:[0,1,2]},w);return{face:h,avgZ:g,normal:z}});m.sort((h,g)=>h.avgZ-g.avgZ),m.forEach(({face:h,normal:g})=>{if(l.backfaceCulling&&g.z<=0)return;t.beginPath(),h.vertices.forEach((z,N)=>{const C=P[z];N===0?t.moveTo(C.x,C.y):t.lineTo(C.x,C.y)}),t.closePath();let w=h.color;if(l.lighting){const z={x:.5,y:.5,z:1},N=Math.max(0,g.x*z.x+g.y*z.y+g.z*z.z);w={...w,l:Z(w.l*(.3+.7*N),10,90)}}t.fillStyle=de(w),t.fill(),l.renderMode==="both"&&(t.strokeStyle="#000000",t.lineWidth=1,t.stroke())})}l.showWireframe&&l.renderMode!=="solid"&&(t.strokeStyle=l.renderMode==="wireframe"?"#ffffff":"#000000",t.lineWidth=l.renderMode==="wireframe"?2:1,o.edges.forEach(m=>{const h=P[m.start],g=P[m.end];k[m.start].z>0&&k[m.end].z>0&&(t.beginPath(),t.moveTo(h.x,h.y),t.lineTo(g.x,g.y),t.stroke())})),l.showVertices&&(t.fillStyle="#ff0000",P.forEach((m,h)=>{k[h].z>0&&(t.beginPath(),t.arc(m.x,m.y,3,0,B),t.fill())})),t.fillStyle="rgba(0, 0, 0, 0.7)",t.fillRect(10,10,200,100),t.fillStyle="#ffffff",t.font="14px Arial",t.fillText(`Mesh: ${A}`,20,30),t.fillText(`Vertices: ${o.vertices.length}`,20,50),t.fillText(`Faces: ${o.faces.length}`,20,70),t.fillText(`Rotation: (${x.rotation.x.toFixed(1)}, ${x.rotation.y.toFixed(1)})`,20,90)},E=()=>{D&&(l.autoRotate&&R(e=>({...e,rotation:{...e.rotation,y:e.rotation.y+.02}})),V(),M.current=requestAnimationFrame(E))},te=()=>{X(!0),M.current=requestAnimationFrame(E)},se=()=>{X(!1),M.current&&cancelAnimationFrame(M.current)},ne=e=>{y.current.dragging=!0,y.current.lastX=e.clientX,y.current.lastY=e.clientY},re=e=>{if(!y.current.dragging)return;const t=e.clientX-y.current.lastX,n=e.clientY-y.current.lastY;R(r=>({...r,rotation:{...r.rotation,y:r.rotation.y+t*.01,x:Z(r.rotation.x+n*.01,-b/2,b/2)}})),y.current.lastX=e.clientX,y.current.lastY=e.clientY},W=()=>{y.current.dragging=!1},oe=()=>{R({position:{x:0,y:0,z:5},rotation:{x:0,y:0,z:0},fov:b/4,near:.1,far:100})};return p.useEffect(()=>{const e=T.current;if(e)return e.width=800,e.height=600,V(),()=>{M.current&&cancelAnimationFrame(M.current)}},[]),p.useEffect(()=>{D||V()},[x,A,l]),s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Advanced 3D Software Renderer"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Complete 3D engine with matrix math, multiple primitives, lighting, and interactive camera controls."}),s.jsx("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:s.jsx("p",{className:"text-indigo-800",children:"🎮 Drag to rotate, explore different meshes and rendering modes"})})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[s.jsx("button",{type:"button",onClick:te,disabled:D,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50 transition-colors",children:"Start Animation"}),s.jsx("button",{type:"button",onClick:se,disabled:!D,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 transition-colors",children:"Stop Animation"}),s.jsx("button",{type:"button",onClick:oe,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Reset Camera"})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"3D Mesh"}),s.jsxs("select",{value:A,onChange:e=>I(e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[s.jsx("option",{value:"cube",children:"Cube"}),s.jsx("option",{value:"pyramid",children:"Pyramid"}),s.jsx("option",{value:"sphere",children:"Sphere"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Render Mode"}),s.jsxs("select",{value:l.renderMode,onChange:e=>S(t=>({...t,renderMode:e.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[s.jsx("option",{value:"wireframe",children:"Wireframe"}),s.jsx("option",{value:"solid",children:"Solid"}),s.jsx("option",{value:"both",children:"Both"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["FOV: ",(x.fov*180/b).toFixed(0),"°"]}),s.jsx("input",{type:"range",min:b/6,max:b/2,step:b/36,value:x.fov,onChange:e=>R(t=>({...t,fov:Number(e.target.value)})),className:"w-full"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Distance: ",x.position.z.toFixed(1)]}),s.jsx("input",{type:"range",min:"2",max:"10",step:"0.1",value:x.position.z,onChange:e=>R(t=>({...t,position:{...t.position,z:Number(e.target.value)}})),className:"w-full"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-4",children:[s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:l.showVertices,onChange:e=>S(t=>({...t,showVertices:e.target.checked})),className:"mr-2"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Show Vertices"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:l.backfaceCulling,onChange:e=>S(t=>({...t,backfaceCulling:e.target.checked})),className:"mr-2"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Backface Culling"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:l.lighting,onChange:e=>S(t=>({...t,lighting:e.target.checked})),className:"mr-2"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Lighting"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:l.autoRotate,onChange:e=>S(t=>({...t,autoRotate:e.target.checked})),className:"mr-2"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Auto Rotate"})]})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("canvas",{ref:T,className:"border border-gray-300 rounded-lg bg-black cursor-move",style:{maxWidth:"100%",height:"auto"},onMouseDown:ne,onMouseMove:re,onMouseUp:W,onMouseLeave:W}),s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Drag to rotate the camera around the object"})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2 text-yellow-800",children:"3D Transformations"}),s.jsxs("ul",{className:"text-yellow-700 space-y-1",children:[s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Matrix Math"}),": 4x4 transformation matrices"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Perspective Projection"}),": 3D to 2D screen mapping"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Rotation Matrices"}),": X, Y, Z axis rotations"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Homogeneous Coordinates"}),": 4D vector transformations"]})]})]}),s.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2 text-indigo-800",children:"Rendering Features"}),s.jsxs("ul",{className:"text-indigo-700 space-y-1",children:[s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Multiple Render Modes"}),": Wireframe, solid, combined"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Backface Culling"}),": Hide faces pointing away from camera"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Depth Sorting"}),": Proper face rendering order"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Basic Lighting"}),": Normal-based shading"]})]})]})]}),s.jsx("div",{className:"mt-6",children:s.jsx(le,{to:"/examples/visual",className:"inline-block px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:"← Back to Examples"})})]})};export{me as component};
