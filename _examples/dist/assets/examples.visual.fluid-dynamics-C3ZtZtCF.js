import{r as u,j as t,L as oe,b as j,T as k,v as R,f as X,g as C,e as M,d as N,h as w,P as F}from"./index-BqTI3VMm.js";const ce=function(){const m=u.useRef(null),p=u.useRef(),a=u.useRef({x:0,y:0,down:!1,radius:30}),[g,T]=u.useState([]),[P,E]=u.useState(!1),[i,d]=u.useState({numParticles:200,viscosity:.1,gravity:300,restDensity:1e3,gasConstant:2e3,particleRadius:4,smoothingRadius:16,timeStep:.016,damping:.9,surfaceTension:.1,colorMode:"velocity",showGrid:!1,showVelocity:!1}),[b,Y]=u.useState("water"),h=u.useRef([]),x=32,D=()=>{const s=m.current;if(!s)return[];const e=[],n=i.particleRadius*2.2,o=s.width*.3,r=s.height*.2,l=Math.floor(Math.sqrt(i.numParticles*1.5));Math.ceil(i.numParticles/l);for(let y=0;y<i.numParticles;y++){const S=y%l,c=Math.floor(y/l);e.push({x:o+S*n+j(-2,2),y:r+c*n+j(-2,2),vx:j(-10,10),vy:j(-10,10),density:i.restDensity,pressure:0,id:y,color:{r:100,g:150,b:255},life:1})}return e},$=s=>{switch(s){case"water":d(e=>({...e,viscosity:.1,gravity:300,gasConstant:2e3,damping:.9,surfaceTension:.1}));break;case"oil":d(e=>({...e,viscosity:.3,gravity:250,gasConstant:1500,damping:.95,surfaceTension:.2}));break;case"gas":d(e=>({...e,viscosity:.01,gravity:50,gasConstant:3e3,damping:.8,surfaceTension:.01}));break;case"honey":d(e=>({...e,viscosity:.8,gravity:200,gasConstant:1e3,damping:.98,surfaceTension:.3}));break}},H=()=>{const s=m.current;if(!s)return;const e=Math.ceil(s.width/x),n=Math.ceil(s.height/x);h.current=Array(n).fill(null).map(()=>Array(e).fill(null).map(()=>({particles:[]})))},B=()=>{h.current.forEach(s=>{s.forEach(e=>{e.particles=[]})})},K=s=>{const e=Math.floor(s.x/x),n=Math.floor(s.y/x);n>=0&&n<h.current.length&&e>=0&&e<h.current[0].length&&h.current[n][e].particles.push(s)},G=s=>{const e=[],n=Math.floor(s.x/x),o=Math.floor(s.y/x);for(let r=o-1;r<=o+1;r++)for(let l=n-1;l<=n+1;l++)r>=0&&r<h.current.length&&l>=0&&l<h.current[0].length&&e.push(...h.current[r][l].particles);return e},L=(s,e)=>{if(s>=e)return 0;const n=s/e;return 315/(64*F*e**9)*(1-n**2)**3},O=(s,e)=>{if(s>=e)return 0;const n=s/e;return-(945/(32*F*e**9))*(1-n**2)**2*n},U=(s,e)=>{if(s>=e)return 0;const n=s/e;return 45/(F*e**6)*(1-n)},_=()=>{B(),g.forEach(K),g.forEach(s=>{const e=G(s);let n=0;e.forEach(o=>{const r=R(s,o);r<i.smoothingRadius&&(n+=L(r,i.smoothingRadius))}),s.density=Math.max(n,i.restDensity*.1),s.pressure=i.gasConstant*(s.density-i.restDensity)})},Z=()=>{g.forEach(s=>{const e=G(s);let n=0,o=0,r=0,l=0;e.forEach(c=>{if(s.id===c.id)return;const f=R(s,c);if(f<i.smoothingRadius&&f>0){const v=X(C(s,c)),q=(s.pressure+c.pressure)/(2*c.density)*O(f,i.smoothingRadius);n+=v.x*q,o+=v.y*q;const I=C({x:c.vx,y:c.vy},{x:s.vx,y:s.vy}),z=i.viscosity*(1/c.density)*U(f,i.smoothingRadius);r+=I.x*z,l+=I.y*z}});const y=-n+r,S=-o+l+i.gravity;if(s.vx+=y*i.timeStep/s.density,s.vy+=S*i.timeStep/s.density,a.current.down){const c=R(s,a.current);if(c<a.current.radius){const f=(a.current.radius-c)/a.current.radius,v=X(C(s,a.current));s.vx+=v.x*f*500*i.timeStep,s.vy+=v.y*f*500*i.timeStep}}})},J=()=>{const s=m.current;s&&g.forEach(e=>{e.vx*=i.damping,e.vy*=i.damping,e.x+=e.vx*i.timeStep,e.y+=e.vy*i.timeStep;const n=i.particleRadius;e.x-n<0&&(e.x=n,e.vx*=-.5),e.x+n>s.width&&(e.x=s.width-n,e.vx*=-.5),e.y-n<0&&(e.y=n,e.vy*=-.3),e.y+n>s.height&&(e.y=s.height-n,e.vy*=-.3)})},Q=()=>{g.forEach(s=>{const e=Math.sqrt(s.vx**2+s.vy**2);switch(i.colorMode){case"velocity":{const n=M(e/200,0,1),o=N(w(240-n*180,80,50));s.color=o;break}case"pressure":{const n=M(s.pressure/5e3,-1,1),o=n>0?0:240,r=Math.abs(n),l=N(w(o,80,30+r*40));s.color=l;break}case"density":{const o=200+s.density/i.restDensity*100,r=N(w(o,70,50));s.color=r;break}case"temperature":{const n=e*s.density/1e4,o=240-M(n,0,1)*240,r=N(w(o,80,50));s.color=r;break}}})},ee=()=>{_(),Z(),J(),Q()},se=()=>{const s=m.current,e=s==null?void 0:s.getContext("2d");if(!(!s||!e)){if(e.clearRect(0,0,s.width,s.height),e.fillStyle="#001122",e.fillRect(0,0,s.width,s.height),i.showGrid){e.strokeStyle="rgba(100, 100, 100, 0.3)",e.lineWidth=1;for(let n=0;n<=s.width;n+=x)e.beginPath(),e.moveTo(n,0),e.lineTo(n,s.height),e.stroke();for(let n=0;n<=s.height;n+=x)e.beginPath(),e.moveTo(0,n),e.lineTo(s.width,n),e.stroke()}g.forEach(n=>{e.fillStyle=`rgb(${n.color.r}, ${n.color.g}, ${n.color.b})`,e.beginPath(),e.arc(n.x,n.y,i.particleRadius,0,k),e.fill(),e.fillStyle="rgba(255, 255, 255, 0.3)",e.beginPath(),e.arc(n.x-1,n.y-1,i.particleRadius*.6,0,k),e.fill(),i.showVelocity&&(e.strokeStyle="rgba(255, 255, 255, 0.7)",e.lineWidth=1,e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(n.x+n.vx*.1,n.y+n.vy*.1),e.stroke())}),a.current.down&&(e.strokeStyle="rgba(255, 255, 255, 0.5)",e.lineWidth=2,e.beginPath(),e.arc(a.current.x,a.current.y,a.current.radius,0,k),e.stroke()),e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(10,10,200,60),e.fillStyle="#ffffff",e.font="14px Arial",e.fillText(`Particles: ${g.length}`,20,30),e.fillText(`Preset: ${b}`,20,50),e.fillText(`Mode: ${i.colorMode}`,20,70)}},V=()=>{P&&ee(),se(),p.current=requestAnimationFrame(V)},te=()=>{E(!0)},ne=()=>{E(!1)},A=()=>{const s=D();T(s)},ie=s=>{const e=m.current;if(!e)return;const n=e.getBoundingClientRect();a.current.x=s.clientX-n.left,a.current.y=s.clientY-n.top,a.current.down=!0},re=s=>{const e=m.current;if(!e)return;const n=e.getBoundingClientRect();a.current.x=s.clientX-n.left,a.current.y=s.clientY-n.top},W=()=>{a.current.down=!1};return u.useEffect(()=>{const s=m.current;if(!s)return;s.width=800,s.height=600,H();const e=D();return T(e),p.current=requestAnimationFrame(V),()=>{p.current&&cancelAnimationFrame(p.current)}},[]),u.useEffect(()=>{b!=="custom"&&$(b)},[b]),u.useEffect(()=>{A()},[i.numParticles]),t.jsxs("div",{className:"container mx-auto px-4 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Fluid Dynamics Simulation"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Real-time particle-based fluid simulation using Smoothed Particle Hydrodynamics (SPH) with interactive controls."}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:t.jsx("p",{className:"text-blue-800",children:"💧 Watch fluid behavior with realistic physics, drag to interact, explore different fluid types"})})]}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[t.jsx("button",{type:"button",onClick:te,disabled:P,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 transition-colors",children:"Start Simulation"}),t.jsx("button",{type:"button",onClick:ne,disabled:!P,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 transition-colors",children:"Stop Simulation"}),t.jsx("button",{type:"button",onClick:A,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"Reset"})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fluid Type"}),t.jsxs("select",{value:b,onChange:s=>Y(s.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"water",children:"Water"}),t.jsx("option",{value:"oil",children:"Oil"}),t.jsx("option",{value:"gas",children:"Gas"}),t.jsx("option",{value:"honey",children:"Honey"}),t.jsx("option",{value:"custom",children:"Custom"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Color Mode"}),t.jsxs("select",{value:i.colorMode,onChange:s=>d(e=>({...e,colorMode:s.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"velocity",children:"Velocity"}),t.jsx("option",{value:"pressure",children:"Pressure"}),t.jsx("option",{value:"density",children:"Density"}),t.jsx("option",{value:"temperature",children:"Temperature"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",checked:i.showGrid,onChange:s=>d(e=>({...e,showGrid:s.target.checked})),className:"mr-2"}),t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Show Grid"})]}),t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",checked:i.showVelocity,onChange:s=>d(e=>({...e,showVelocity:s.target.checked})),className:"mr-2"}),t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Show Velocity"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Particles: ",i.numParticles]}),t.jsx("input",{type:"range",min:"50",max:"400",step:"25",value:i.numParticles,onChange:s=>d(e=>({...e,numParticles:Number(s.target.value)})),className:"w-full"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Viscosity: ",i.viscosity.toFixed(2)]}),t.jsx("input",{type:"range",min:"0.01",max:"1",step:"0.01",value:i.viscosity,onChange:s=>d(e=>({...e,viscosity:Number(s.target.value)})),className:"w-full"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Gravity: ",i.gravity]}),t.jsx("input",{type:"range",min:"0",max:"500",step:"25",value:i.gravity,onChange:s=>d(e=>({...e,gravity:Number(s.target.value)})),className:"w-full"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Gas Constant: ",i.gasConstant]}),t.jsx("input",{type:"range",min:"500",max:"5000",step:"100",value:i.gasConstant,onChange:s=>d(e=>({...e,gasConstant:Number(s.target.value)})),className:"w-full"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Damping: ",i.damping.toFixed(2)]}),t.jsx("input",{type:"range",min:"0.7",max:"0.99",step:"0.01",value:i.damping,onChange:s=>d(e=>({...e,damping:Number(s.target.value)})),className:"w-full"})]})]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("canvas",{ref:m,className:"border border-gray-300 rounded-lg bg-black cursor-crosshair",style:{maxWidth:"100%",height:"auto"},onMouseDown:ie,onMouseMove:re,onMouseUp:W,onMouseLeave:W}),t.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Click and drag to interact with the fluid particles"})]}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-cyan-50 border border-cyan-200 rounded-lg p-4",children:[t.jsx("h3",{className:"text-lg font-semibold mb-2 text-cyan-800",children:"SPH Physics"}),t.jsxs("ul",{className:"text-cyan-700 space-y-1",children:[t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Smoothed Particle Hydrodynamics"}),": Lagrangian fluid simulation"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Density Estimation"}),": Kernel-based neighbor calculations"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Pressure Forces"}),": Gradient-based particle interactions"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Viscosity Modeling"}),": Velocity smoothing between neighbors"]})]})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsx("h3",{className:"text-lg font-semibold mb-2 text-blue-800",children:"Interactive Features"}),t.jsxs("ul",{className:"text-blue-700 space-y-1",children:[t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Fluid Presets"}),": Water, oil, gas, and honey properties"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Color Visualization"}),": Velocity, pressure, density, temperature"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Mouse Interaction"}),": Push and stir the fluid particles"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Real-time Controls"}),": Adjust physics parameters dynamically"]})]})]})]}),t.jsxs("div",{className:"mt-6 bg-purple-50 border border-purple-200 rounded-lg p-4",children:[t.jsx("h3",{className:"text-lg font-semibold mb-2 text-purple-800",children:"Applications"}),t.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-purple-700",children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Computer Graphics:"}),t.jsxs("ul",{className:"text-sm mt-1",children:[t.jsx("li",{children:"• Realistic water simulation"}),t.jsx("li",{children:"• Particle effects systems"}),t.jsx("li",{children:"• Environmental animations"})]})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Engineering:"}),t.jsxs("ul",{className:"text-sm mt-1",children:[t.jsx("li",{children:"• Fluid dynamics analysis"}),t.jsx("li",{children:"• Material behavior studies"}),t.jsx("li",{children:"• Process optimization"})]})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Scientific Research:"}),t.jsxs("ul",{className:"text-sm mt-1",children:[t.jsx("li",{children:"• Oceanographic modeling"}),t.jsx("li",{children:"• Atmospheric simulation"}),t.jsx("li",{children:"• Blood flow analysis"})]})]})]})]}),t.jsx("div",{className:"mt-6",children:t.jsx(oe,{to:"/examples/visual",className:"inline-block px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"← Back to Examples"})})]})};export{ce as component};
