import{r as b,j as t,L as le,P as O,e as U,b as A}from"./index-BqTI3VMm.js";const oe=function(){const D=b.useRef(null),E=b.useRef(null),M=b.useRef(),R=b.useRef(0),[o,k]=b.useState({kp:1,ki:.5,kd:.1,integral:0,previousError:0,output:0,setpoint:1}),[i,T]=b.useState({gain:2,timeConstant:1.5,deadTime:.2,disturbance:0,noise:.01,output:0,states:[0,0,0]}),[N,W]=b.useState({time:[],setpoint:[],output:[],error:[],controlSignal:[],disturbance:[]}),[f,V]=b.useState("PID"),[B,Y]=b.useState("first-order"),[F,Z]=b.useState(!1),[H,K]=b.useState(!1),[w,$]=b.useState({overshoot:0,settlingTime:0,riseTime:0,steadyStateError:0,integralAbsoluteError:0,integralSquaredError:0}),[P,J]=b.useState("time-response"),[S,q]=b.useState({time:0,magnitude:1}),[I,z]=b.useState(0),C=.01,Q=(s,e)=>{const l=o.kp*s;o.integral+=s*e,o.integral=U(o.integral,-10,10);const p=o.ki*o.integral,h=o.kd*(s-o.previousError)/e;o.previousError=s;let m=l+p+h;switch(f){case"P":m=l;break;case"PI":m=l+p;break;case"PID":break;case"manual":m=o.output;break}return U(m,-10,10)},X=(s,e)=>{const l=s;switch(B){case"first-order":return i.states[0]+=(i.gain*l-i.states[0])*e/i.timeConstant,i.states[0]+i.disturbance+A(-i.noise,i.noise);case"second-order":const p=2,h=.3,m=p*p,u=2*h*p,r=m*(i.gain*l)-u*i.states[1]-m*i.states[0];return i.states[1]+=r*e,i.states[0]+=i.states[1]*e,i.states[0]+i.disturbance+A(-i.noise,i.noise);case"integrating":return i.states[0]+=i.gain*l*e,i.states[0]+i.disturbance+A(-i.noise,i.noise);case"unstable":return i.states[0]+=(i.gain*l+i.states[0])*e,i.states[0]+i.disturbance+A(-i.noise,i.noise);default:return 0}},ee=()=>{const s=4/(i.gain*i.timeConstant),e=2*O*Math.sqrt(i.timeConstant);switch(f){case"P":k(l=>({...l,kp:.5*s,ki:0,kd:0}));break;case"PI":k(l=>({...l,kp:.45*s,ki:.54*s/e,kd:0}));break;case"PID":k(l=>({...l,kp:.6*s,ki:1.2*s/e,kd:.075*s*e}));break}},te=s=>{if(s.time.length<10)return;const e=s.setpoint[s.setpoint.length-1],l=.02*Math.abs(e),p=Math.max(...s.output),h=e>0?Math.max(0,(p-e)/e*100):0,m=.1*e,u=.9*e;let r=-1,j=-1;for(let d=0;d<s.output.length;d++)if(r===-1&&Math.abs(s.output[d])>=Math.abs(m)&&(r=d),r!==-1&&j===-1&&Math.abs(s.output[d])>=Math.abs(u)){j=d;break}const n=r!==-1&&j!==-1?s.time[j]-s.time[r]:0;let g=s.time[s.time.length-1];for(let d=s.output.length-1;d>=0;d--)if(Math.abs(s.output[d]-e)>l){g=s.time[d];break}const a=s.output.slice(-10),x=a.reduce((d,L)=>d+L,0)/a.length,c=Math.abs(e-x);let v=0,y=0;for(let d=0;d<s.error.length;d++)v+=Math.abs(s.error[d])*C,y+=s.error[d]*s.error[d]*C;$({overshoot:h,riseTime:n,settlingTime:g,steadyStateError:c,integralAbsoluteError:v,integralSquaredError:y})},se=()=>{const s=R.current;let e=o.setpoint;s>=S.time&&S.time>0&&(e=S.magnitude);let l=i.disturbance;s>=I&&I>0&&(l=.5);const p=e-i.output,h=f!=="manual"?Q(p,C):o.output,m=X(h,C);T(u=>({...u,output:m,disturbance:l})),W(u=>{const r=[...u.time,s].slice(-1e3),j=[...u.setpoint,e].slice(-1e3),n=[...u.output,n].slice(-1e3),g=[...u.error,p].slice(-1e3),a=[...u.controlSignal,h].slice(-1e3),x=[...u.disturbance,l].slice(-1e3),c={time:r,setpoint:j,output:n,error:g,controlSignal:a,disturbance:x};return r.length%100===0&&te(c),c}),R.current+=C},ie=()=>{const s=D.current,e=s==null?void 0:s.getContext("2d");if(!s||!e||(e.clearRect(0,0,s.width,s.height),e.fillStyle="#f8fafc",e.fillRect(0,0,s.width,s.height),N.time.length<2))return;const l=Math.max(20,N.time[N.time.length-1]),p=(s.width-80)/l,h=(s.height-80)/4,m=s.height/2;e.strokeStyle="#e2e8f0",e.lineWidth=1;for(let n=-2;n<=2;n++){const g=m-n*h/2;e.beginPath(),e.moveTo(40,g),e.lineTo(s.width-40,g),e.stroke(),e.fillStyle="#64748b",e.font="12px Arial",e.textAlign="right",e.fillText(n.toString(),35,g+4)}const u=10;for(let n=0;n<=u;n++){const g=40+n*(s.width-80)/u,a=n*l/u;e.beginPath(),e.moveTo(g,40),e.lineTo(g,s.height-40),e.stroke(),e.fillStyle="#64748b",e.font="12px Arial",e.textAlign="center",e.fillText(a.toFixed(1)+"s",g,s.height-20)}e.strokeStyle="#1e293b",e.lineWidth=2,e.beginPath(),e.moveTo(40,m),e.lineTo(s.width-40,m),e.stroke(),e.beginPath(),e.moveTo(40,40),e.lineTo(40,s.height-40),e.stroke();const r=(n,g,a,x)=>{if(!(n.length<2)){e.strokeStyle=g,e.lineWidth=a,e.beginPath();for(let c=0;c<Math.min(n.length,N.time.length);c++){const v=40+N.time[c]*p,y=m-n[c]*h/2;c===0?e.moveTo(v,y):e.lineTo(v,y)}e.stroke()}};e.setLineDash([5,5]),r(N.setpoint,"#ef4444",2),e.setLineDash([]),r(N.output,"#3b82f6",3),r(N.controlSignal,"#10b981",2),N.disturbance.some(n=>n!==0)&&r(N.disturbance,"#f59e0b",2);const j=[{color:"#ef4444",label:"Setpoint",dash:!0},{color:"#3b82f6",label:"Process Output",dash:!1},{color:"#10b981",label:"Control Signal",dash:!1}];N.disturbance.some(n=>n!==0)&&j.push({color:"#f59e0b",label:"Disturbance",dash:!1}),j.forEach((n,g)=>{const a=s.width-200,x=60+g*25;e.strokeStyle=n.color,e.lineWidth=3,n.dash&&e.setLineDash([5,5]),e.beginPath(),e.moveTo(a,x),e.lineTo(a+30,x),e.stroke(),e.setLineDash([]),e.fillStyle="#1e293b",e.font="12px Arial",e.textAlign="left",e.fillText(n.label,a+35,x+4)}),e.fillStyle="#1e293b",e.font="14px Arial",e.textAlign="left",e.fillText("Output",10,25),e.save(),e.translate(s.width/2,s.height-5),e.textAlign="center",e.fillText("Time (seconds)",0,0),e.restore()},ne=()=>{const s=E.current,e=s==null?void 0:s.getContext("2d");if(!s||!e)return;e.clearRect(0,0,s.width,s.height),e.fillStyle="#f8fafc",e.fillRect(0,0,s.width,s.height);const l=.01,p=100,h=[],m=[],u=[];for(let a=0;a<100;a++){const x=l*Math.pow(p/l,a/99);h.push(x);const c=2*O*x,v={real:o.kp-o.kd*c*c,imag:o.ki/c+o.kd*c},y={real:1,imag:i.timeConstant*c},d=Math.sqrt(v.real*v.real+v.imag*v.imag)*i.gain/Math.sqrt(y.real*y.real+y.imag*y.imag),L=Math.atan2(v.imag,v.real)-Math.atan2(y.imag,y.real);m.push(20*Math.log10(d)),u.push(L*180/O)}const r=s.height/2;e.fillStyle="#1e293b",e.font="14px Arial",e.textAlign="center",e.fillText("Bode Plot - Open Loop Response",s.width/2,20),e.fillStyle="#f1f5f9",e.fillRect(40,40,s.width-80,r-60),e.fillStyle="#f1f5f9",e.fillRect(40,r+20,s.width-80,r-60),e.strokeStyle="#3b82f6",e.lineWidth=2,e.beginPath();const j=(s.width-80)/Math.log10(p/l),n=(r-80)/80,g=(r-80)/360;for(let a=0;a<h.length;a++){const x=40+Math.log10(h[a]/l)*j,c=r-20-(m[a]+40)*n;a===0?e.moveTo(x,c):e.lineTo(x,c)}e.stroke(),e.strokeStyle="#ef4444",e.lineWidth=2,e.beginPath();for(let a=0;a<h.length;a++){const x=40+Math.log10(h[a]/l)*j,c=s.height-40-(u[a]+180)*g;a===0?e.moveTo(x,c):e.lineTo(x,c)}e.stroke(),e.strokeStyle="#6b7280",e.setLineDash([3,3]),e.beginPath(),e.moveTo(40,r-20-40*n),e.lineTo(s.width-40,r-20-40*n),e.stroke(),e.beginPath(),e.moveTo(40,s.height-40),e.lineTo(s.width-40,s.height-40),e.stroke(),e.setLineDash([]),e.fillStyle="#1e293b",e.font="12px Arial",e.textAlign="right",e.fillText("Magnitude (dB)",35,r/2),e.fillText("Phase (¬∞)",35,r+r/2),e.textAlign="center",e.fillText("Frequency (Hz)",s.width/2,s.height-5)},_=()=>{F&&se(),P==="time-response"?ie():P==="bode-plot"&&ne(),M.current=requestAnimationFrame(_)},G=()=>{R.current=0,k(s=>({...s,integral:0,previousError:0})),T(s=>({...s,output:0,states:[0,0,0]})),W({time:[],setpoint:[],output:[],error:[],controlSignal:[],disturbance:[]}),q({time:0,magnitude:1}),z(0)};return b.useEffect(()=>{const s=D.current,e=E.current;if(!(!s||!e))return s.width=800,s.height=500,e.width=600,e.height=500,M.current=requestAnimationFrame(_),()=>{M.current&&cancelAnimationFrame(M.current)}},[]),b.useEffect(()=>{H&&(ee(),K(!1))},[H,f]),t.jsxs("div",{className:"container mx-auto px-4 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Process Control Systems"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Advanced PID controller design and analysis with real-time process simulation and performance metrics."}),t.jsx("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:t.jsx("p",{className:"text-indigo-800",children:"üéõÔ∏è Interactive control system design with PID tuning, process modeling, and stability analysis"})})]}),t.jsxs("div",{className:"mb-6 bg-white rounded-lg border border-gray-200 p-4",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Control Type"}),t.jsxs("select",{value:f,onChange:s=>V(s.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[t.jsx("option",{value:"P",children:"Proportional (P)"}),t.jsx("option",{value:"PI",children:"Proportional-Integral (PI)"}),t.jsx("option",{value:"PID",children:"PID Controller"}),t.jsx("option",{value:"manual",children:"Manual Control"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Process Type"}),t.jsxs("select",{value:B,onChange:s=>{Y(s.target.value),G()},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[t.jsx("option",{value:"first-order",children:"First Order"}),t.jsx("option",{value:"second-order",children:"Second Order"}),t.jsx("option",{value:"integrating",children:"Integrating"}),t.jsx("option",{value:"unstable",children:"Unstable"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Mode"}),t.jsxs("select",{value:P,onChange:s=>J(s.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[t.jsx("option",{value:"time-response",children:"Time Response"}),t.jsx("option",{value:"bode-plot",children:"Bode Plot"})]})]}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("button",{type:"button",onClick:()=>Z(!F),className:`px-4 py-2 rounded-md transition-colors ${F?"bg-red-600 text-white hover:bg-red-700":"bg-green-600 text-white hover:bg-green-700"}`,children:F?"Stop":"Start"}),t.jsx("button",{type:"button",onClick:G,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:"Reset"})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Controller Parameters"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Kp (Proportional): ",o.kp.toFixed(3)]}),t.jsx("input",{type:"range",min:"0",max:"10",step:"0.1",value:o.kp,onChange:s=>k(e=>({...e,kp:Number(s.target.value)})),className:"w-full",disabled:f==="manual"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Ki (Integral): ",o.ki.toFixed(3)]}),t.jsx("input",{type:"range",min:"0",max:"5",step:"0.05",value:o.ki,onChange:s=>k(e=>({...e,ki:Number(s.target.value)})),className:"w-full",disabled:f==="P"||f==="manual"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Kd (Derivative): ",o.kd.toFixed(3)]}),t.jsx("input",{type:"range",min:"0",max:"2",step:"0.01",value:o.kd,onChange:s=>k(e=>({...e,kd:Number(s.target.value)})),className:"w-full",disabled:f==="P"||f==="PI"||f==="manual"})]}),t.jsx("div",{className:"flex items-end",children:t.jsx("button",{type:"button",onClick:()=>K(!0),className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors",disabled:f==="manual",children:"Auto-Tune"})})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Process Parameters"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Process Gain: ",i.gain.toFixed(2)]}),t.jsx("input",{type:"range",min:"0.1",max:"5",step:"0.1",value:i.gain,onChange:s=>T(e=>({...e,gain:Number(s.target.value)})),className:"w-full"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Time Constant: ",i.timeConstant.toFixed(2),"s"]}),t.jsx("input",{type:"range",min:"0.1",max:"5",step:"0.1",value:i.timeConstant,onChange:s=>T(e=>({...e,timeConstant:Number(s.target.value)})),className:"w-full"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Dead Time: ",i.deadTime.toFixed(2),"s"]}),t.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:i.deadTime,onChange:s=>T(e=>({...e,deadTime:Number(s.target.value)})),className:"w-full"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Noise Level: ",i.noise.toFixed(3)]}),t.jsx("input",{type:"range",min:"0",max:"0.1",step:"0.001",value:i.noise,onChange:s=>T(e=>({...e,noise:Number(s.target.value)})),className:"w-full"})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Test Inputs"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Setpoint: ",o.setpoint.toFixed(2)]}),t.jsx("input",{type:"range",min:"0",max:"3",step:"0.1",value:o.setpoint,onChange:s=>k(e=>({...e,setpoint:Number(s.target.value)})),className:"w-full"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Step Time: ",S.time.toFixed(1),"s"]}),t.jsx("input",{type:"range",min:"0",max:"20",step:"0.5",value:S.time,onChange:s=>q(e=>({...e,time:Number(s.target.value)})),className:"w-full"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Step Magnitude: ",S.magnitude.toFixed(2)]}),t.jsx("input",{type:"range",min:"0",max:"3",step:"0.1",value:S.magnitude,onChange:s=>q(e=>({...e,magnitude:Number(s.target.value)})),className:"w-full"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Disturbance Time: ",I.toFixed(1),"s"]}),t.jsx("input",{type:"range",min:"0",max:"20",step:"0.5",value:I,onChange:s=>z(Number(s.target.value)),className:"w-full"})]})]})]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Performance Metrics"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[t.jsx("h4",{className:"font-medium text-blue-800 text-sm",children:"Overshoot"}),t.jsxs("p",{className:"text-lg font-bold text-blue-900",children:[w.overshoot.toFixed(1),"%"]})]}),t.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[t.jsx("h4",{className:"font-medium text-green-800 text-sm",children:"Rise Time"}),t.jsxs("p",{className:"text-lg font-bold text-green-900",children:[w.riseTime.toFixed(2),"s"]})]}),t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:[t.jsx("h4",{className:"font-medium text-yellow-800 text-sm",children:"Settling Time"}),t.jsxs("p",{className:"text-lg font-bold text-yellow-900",children:[w.settlingTime.toFixed(2),"s"]})]}),t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[t.jsx("h4",{className:"font-medium text-red-800 text-sm",children:"SS Error"}),t.jsx("p",{className:"text-lg font-bold text-red-900",children:w.steadyStateError.toFixed(3)})]}),t.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3",children:[t.jsx("h4",{className:"font-medium text-purple-800 text-sm",children:"IAE"}),t.jsx("p",{className:"text-lg font-bold text-purple-900",children:w.integralAbsoluteError.toFixed(2)})]}),t.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-3",children:[t.jsx("h4",{className:"font-medium text-indigo-800 text-sm",children:"ISE"}),t.jsx("p",{className:"text-lg font-bold text-indigo-900",children:w.integralSquaredError.toFixed(2)})]})]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-3",children:P==="time-response"?"Time Domain Response":"Frequency Domain Analysis"}),t.jsx("div",{className:"bg-white rounded-lg border border-gray-300 p-4",children:P==="time-response"?t.jsx("canvas",{ref:D,className:"border border-gray-300 rounded-lg bg-white mx-auto block",style:{maxWidth:"100%",height:"auto"}}):t.jsx("canvas",{ref:E,className:"border border-gray-300 rounded-lg bg-white mx-auto block",style:{maxWidth:"100%",height:"auto"}})})]}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:[t.jsx("h3",{className:"text-lg font-semibold mb-2 text-indigo-800",children:"Control Features"}),t.jsxs("ul",{className:"text-indigo-700 space-y-1",children:[t.jsxs("li",{children:["‚Ä¢ ",t.jsx("strong",{children:"PID Controllers"}),": P, PI, and full PID implementations"]}),t.jsxs("li",{children:["‚Ä¢ ",t.jsx("strong",{children:"Auto-Tuning"}),": Ziegler-Nichols tuning methods"]}),t.jsxs("li",{children:["‚Ä¢ ",t.jsx("strong",{children:"Process Models"}),": First/second order, integrating, unstable"]}),t.jsxs("li",{children:["‚Ä¢ ",t.jsx("strong",{children:"Performance Metrics"}),": Overshoot, settling time, IAE, ISE"]})]})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsx("h3",{className:"text-lg font-semibold mb-2 text-blue-800",children:"Applications"}),t.jsxs("ul",{className:"text-blue-700 space-y-1",children:[t.jsxs("li",{children:["‚Ä¢ ",t.jsx("strong",{children:"Process Industries"}),": Temperature, pressure, flow control"]}),t.jsxs("li",{children:["‚Ä¢ ",t.jsx("strong",{children:"Manufacturing"}),": Motor speed, position control"]}),t.jsxs("li",{children:["‚Ä¢ ",t.jsx("strong",{children:"Chemical Plants"}),": Reactor temperature, pH control"]}),t.jsxs("li",{children:["‚Ä¢ ",t.jsx("strong",{children:"Power Systems"}),": Frequency, voltage regulation"]})]})]})]}),t.jsx("div",{className:"mt-6",children:t.jsx(le,{to:"/examples/engineering",className:"inline-block px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:"‚Üê Back to Examples"})})]})};export{oe as component};
