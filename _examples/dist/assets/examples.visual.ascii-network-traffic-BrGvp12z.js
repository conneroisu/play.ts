import{r as x,j as t,e as I,l as V}from"./index-BqTI3VMm.js";const le=function(){const L=x.useRef(null),E=x.useRef(0),j=x.useRef(new Map),A=x.useRef([]),H=x.useRef(new Map),C=x.useRef([]),[M,q]=x.useState(!0),[g,G]=x.useState(1),[b,K]=x.useState("utilization"),[T,O]=x.useState("enterprise"),[w,J]=x.useState("normal"),[f,Q]=x.useState("network"),[W,X]=x.useState(!0),[P,Y]=x.useState(!0),[R,Z]=x.useState(!1),[k,ee]=x.useState("all"),[N,te]=x.useState("normal"),S={network:{bg:"#000011",online:"#00FF00",busy:"#FFAA00",critical:"#FF0000",secure:"#00AAFF",text:"#FFFFFF",packet:"#FFFF00"},cisco:{bg:"#001122",online:"#00AA44",busy:"#FF8800",critical:"#FF0000",secure:"#0066CC",text:"#FFFFFF",packet:"#FFAA00"},security:{bg:"#110000",online:"#00AA00",busy:"#FFAA00",critical:"#FF0000",secure:"#AA00FF",text:"#FFFFFF",packet:"#FF4444"},datacenter:{bg:"#000022",online:"#00FFFF",busy:"#FFAA00",critical:"#FF0000",secure:"#00AA00",text:"#FFFFFF",packet:"#AAFFAA"},terminal:{bg:"#000000",online:"#00FF00",busy:"#FFAA00",critical:"#FF0000",secure:"#00AAFF",text:"#FFFFFF",packet:"#FFFF00"}};return x.useEffect(()=>{const l=new Map,r=new Map;T==="enterprise"&&[{name:"Core-Router",type:"router",x:50,y:10,bandwidth:1e4,connections:["Dist-SW-1","Dist-SW-2","FW-External"]},{name:"Dist-SW-1",type:"switch",x:25,y:20,bandwidth:1e3,connections:["Core-Router","Access-SW-1","Access-SW-2"]},{name:"Dist-SW-2",type:"switch",x:75,y:20,bandwidth:1e3,connections:["Core-Router","Access-SW-3","Access-SW-4"]},{name:"FW-External",type:"firewall",x:50,y:2,bandwidth:5e3,connections:["Core-Router","LB-Web"]},{name:"LB-Web",type:"load_balancer",x:50,y:25,bandwidth:2e3,connections:["FW-External","Web-Srv-1","Web-Srv-2"]},{name:"Access-SW-1",type:"switch",x:10,y:30,bandwidth:100,connections:["Dist-SW-1","Client-1","Client-2"]},{name:"Access-SW-2",type:"switch",x:40,y:30,bandwidth:100,connections:["Dist-SW-1","Client-3","Client-4"]},{name:"Access-SW-3",type:"switch",x:60,y:30,bandwidth:100,connections:["Dist-SW-2","Web-Srv-1","DB-Srv-1"]},{name:"Access-SW-4",type:"switch",x:90,y:30,bandwidth:100,connections:["Dist-SW-2","Web-Srv-2","DB-Srv-2"]},{name:"Web-Srv-1",type:"server",x:55,y:40,bandwidth:1e3,connections:["LB-Web","Access-SW-3","DB-Srv-1"]},{name:"Web-Srv-2",type:"server",x:65,y:40,bandwidth:1e3,connections:["LB-Web","Access-SW-4","DB-Srv-2"]},{name:"DB-Srv-1",type:"server",x:45,y:50,bandwidth:1e3,connections:["Web-Srv-1","Access-SW-3"]},{name:"DB-Srv-2",type:"server",x:75,y:50,bandwidth:1e3,connections:["Web-Srv-2","Access-SW-4"]},{name:"Client-1",type:"client",x:5,y:40,bandwidth:100,connections:["Access-SW-1"]},{name:"Client-2",type:"client",x:15,y:40,bandwidth:100,connections:["Access-SW-1"]},{name:"Client-3",type:"client",x:35,y:40,bandwidth:100,connections:["Access-SW-2"]},{name:"Client-4",type:"client",x:45,y:40,bandwidth:100,connections:["Access-SW-2"]}].forEach(p=>{const B={id:p.name,name:p.name,type:p.type,ip:`192.168.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`,mac:Array.from({length:6},()=>Math.floor(Math.random()*256).toString(16).padStart(2,"0")).join(":"),bandwidth:p.bandwidth,utilization:Math.random()*30,packets_sent:0,packets_received:0,bytes_sent:0,bytes_received:0,connections:p.connections,x:p.x,y:p.y,status:"online",security_level:p.type==="firewall"?"critical":p.type==="server"?"high":"medium",latency:1+Math.random()*10,packet_loss:Math.random()*.1,uptime:Math.random()*1e4};l.set(p.name,B),p.connections.forEach((U,_)=>{const $=`${p.name}-eth${_}`;r.set($,{id:$,node_id:p.name,name:`eth${_}`,type:p.type==="client"&&_===0?"wifi":"ethernet",speed:p.bandwidth,duplex:"full",status:"up",rx_bytes:0,tx_bytes:0,rx_packets:0,tx_packets:0,errors:0,drops:0})})}),j.current=l,H.current=r},[T]),x.useEffect(()=>{const l=L.current;if(!l)return;const r=l.getContext("2d");if(!r)return;const D=()=>{l.width=l.offsetWidth,l.height=l.offsetHeight},p=()=>{const n=j.current,a=A.current,d=H.current,s=C.current,o=Date.now()/1e3;if(n.forEach(e=>{let i=e.utilization;if(w==="ddos_attack")(e.type==="firewall"||e.type==="load_balancer")&&(i=Math.min(95,70+25*Math.sin(o*3)+Math.random()*20));else if(w==="high_traffic")i=Math.min(85,e.utilization+30+20*Math.sin(o*.8));else if(w==="backup_window")e.type==="server"&&(i=Math.min(90,50+30*Math.sin(o*.5)));else if(w==="business_hours"){const h=new Date().getHours(),u=h>=8&&h<=18?1.5:.3;i=e.utilization*u+Math.random()*15}else i=e.utilization+(Math.random()-.5)*10;if(e.utilization=I(i,0,100),e.latency=I(e.latency+(Math.random()-.5)*2,.5,100),e.packet_loss=I(e.packet_loss+(Math.random()-.5)*.02,0,5),e.uptime+=g,e.packet_loss>2||e.latency>50?e.status="error":e.utilization>80||e.latency>20?e.status="congested":e.status="online",Math.random()<e.utilization/100*.3*g&&e.connections.length>0){const h=e.connections[Math.floor(Math.random()*e.connections.length)],u=n.get(h);if(u&&W){const y=["TCP","UDP","HTTP","HTTPS","SSH","DNS","ICMP"];let c=y[Math.floor(Math.random()*y.length)];if(e.type==="client"&&u.type==="server"?c=Math.random()<.6?"HTTP":"HTTPS":e.type==="server"&&u.type==="server"&&(c=Math.random()<.5?"TCP":"SSH"),k==="all"||c===k){const m={id:`packet-${Date.now()}-${Math.random()}`,source:e.id,destination:h,protocol:c,size:64+Math.floor(Math.random()*1472),priority:Math.random()<.1?"high":"normal",progress:0,hop_count:0,ttl:64,port_src:1024+Math.floor(Math.random()*64511),port_dst:c==="HTTP"?80:c==="HTTPS"?443:c==="SSH"?22:Math.floor(Math.random()*65535),security_flag:!1,encrypted:c==="HTTPS"||c==="SSH"};a.push(m),e.packets_sent++,e.bytes_sent+=m.size}}}}),A.current=a.filter(e=>{if(e.progress+=(.05+Math.random()*.05)*g,e.progress>=1){const i=n.get(e.destination);return i&&(i.packets_received++,i.bytes_received+=e.size),!1}return e.hop_count++,e.ttl--,e.ttl>0}),P&&Math.random()<.05*g){const e=["intrusion","ddos","port_scan","unauthorized_access","malware"],i=Array.from(n.values()),h=i[Math.floor(Math.random()*i.length)],u=i[Math.floor(Math.random()*i.length)];if(h.id!==u.id){const y=e[Math.floor(Math.random()*e.length)];let c="medium";N==="under_attack"?c=Math.random()<.7?"high":"critical":N==="high_security"&&(c=Math.random()<.4?"low":"medium");const m={id:`event-${Date.now()}`,timestamp:Date.now(),type:y,source_ip:h.ip,target_ip:u.ip,severity:c,blocked:u.type==="firewall"||Math.random()<.7,description:`${y} detected from ${h.ip} to ${u.ip}`};s.push(m)}}C.current=s.slice(-10),d.forEach(e=>{const i=n.get(e.node_id);i&&(e.rx_packets=i.packets_received,e.tx_packets=i.packets_sent,e.rx_bytes=i.bytes_received,e.tx_bytes=i.bytes_sent,Math.random()<.01&&e.errors++,i.utilization>90&&Math.random()<.05&&e.drops++,e.status=i.status==="error"?"down":i.status==="congested"?"degraded":"up")})},B=n=>{switch(n){case"router":return"◆";case"switch":return"◇";case"server":return"▮";case"client":return"○";case"firewall":return"▲";case"load_balancer":return"⬟";default:return"●"}},U=(n,a)=>{switch(n){case"online":return a.online;case"congested":return a.busy;case"error":return a.critical;case"offline":return a.text+"40";default:return a.text}},_=(n,a)=>{const d=n.x*a,s=n.y*a,o=S[f];r.fillStyle=U(n.status,o),r.fillText(B(n.type),d,s),r.fillStyle=o.text,r.fillText(n.name,d+a,s),n.security_level==="critical"&&(r.fillStyle=o.secure,r.fillText("🔒",d-a,s));let e=0,i="%",h="";switch(b){case"utilization":e=n.utilization,h="CPU";break;case"latency":e=n.latency,i="ms",h="LAT";break;case"packet_loss":e=n.packet_loss,i="%",h="LOSS";break;case"bandwidth":e=(n.bytes_sent+n.bytes_received)/1024/1024,i="MB",h="BW";break}const u=8,c=Math.min(e/(b==="latency"?50:100),1),m=Math.floor(c*u);if(r.fillStyle=o.text+"40",r.fillText("█".repeat(u),d,s+a),m>0){let v=o.online;b==="packet_loss"?v=e>1?o.critical:e>.5?o.busy:o.online:v=c>.8?o.critical:c>.6?o.busy:o.online,r.fillStyle=v,r.fillText("█".repeat(m),d,s+a)}r.fillStyle=o.text,r.fillText(`${h}: ${e.toFixed(b==="bandwidth"?1:0)}${i}`,d+(u+1)*a,s+a),r.fillStyle=o.text+"80",r.fillText(`${n.packets_sent}↑ ${n.packets_received}↓`,d,s+a*2),r.fillText(n.ip,d,s+a*2.5)},$=n=>{const a=j.current,d=S[f];a.forEach(s=>{s.connections.forEach(o=>{const e=a.get(o);if(!e)return;const i=s.x*n,h=s.y*n,u=e.x*n,y=e.y*n;r.strokeStyle=d.text+"60",r.lineWidth=1,r.setLineDash([2,2]),r.beginPath(),r.moveTo(i,h),r.lineTo(u,y),r.stroke(),r.setLineDash([])})})},se=n=>{if(!W)return;const a=j.current,d=S[f];A.current.forEach(s=>{const o=a.get(s.source),e=a.get(s.destination);if(!o||!e)return;const i=o.x*n,h=o.y*n,u=e.x*n,y=e.y*n,c=V(i,u,s.progress),m=V(h,y,s.progress);let v=d.packet;s.priority==="high"?v=d.critical:s.encrypted?v=d.secure:s.security_flag&&(v=d.critical),r.fillStyle=v;let F="●";s.protocol==="TCP"?F="▪":s.protocol==="UDP"?F="▫":s.protocol==="HTTP"?F="H":s.protocol==="HTTPS"?F="S":s.protocol==="SSH"?F="K":s.protocol==="DNS"&&(F="D"),r.fillText(F,c,m)})},re=n=>{if(!P)return;const a=S[f];C.current.forEach((s,o)=>{const e=10*n,i=(l.height/n-15+o)*n;let h=a.text;s.severity==="critical"?h=a.critical:s.severity==="high"?h=a.busy:s.severity==="medium"&&(h=a.packet),r.fillStyle=h;const u=s.blocked?"🛡️":"⚠️",y=s.type==="ddos"?"💥":s.type==="intrusion"?"🔓":s.type==="malware"?"🦠":"👀";r.fillText(`${u} ${y} ${s.type.toUpperCase()}`,e,i),r.fillText(`${s.source_ip} → ${s.target_ip}`,e+n*15,i)})},ne=n=>{if(!R)return;const a=S[f];Array.from(H.current.values()).slice(0,10).forEach((s,o)=>{const e=60*n,i=(5+o*2)*n;r.fillStyle=a.text,r.fillText(`${s.node_id}-${s.name}`,e,i);const h=s.status==="up"?a.online:s.status==="degraded"?a.busy:a.critical;r.fillStyle=h,r.fillText(s.status.toUpperCase(),e+n*15,i),r.fillStyle=a.text,r.fillText(`${s.speed}Mbps ${s.duplex}`,e+n*20,i),(s.errors>0||s.drops>0)&&(r.fillStyle=a.critical,r.fillText(`E:${s.errors} D:${s.drops}`,e,i+n))})},z=()=>{if(!M)return;const n=S[f],a=10;r.fillStyle=n.bg,r.fillRect(0,0,l.width,l.height),r.font='10px "Courier New", monospace',r.textBaseline="top",Math.random()<.1*g&&p(),$(a),j.current.forEach(c=>{_(c,a)}),se(a),re(a),ne(a);const d=Array.from(j.current.values()),s=d.filter(c=>c.status==="online").length,o=d.filter(c=>c.status==="congested").length,e=d.filter(c=>c.status==="error").length,i=A.current.length,h=C.current.length,u=d.reduce((c,m)=>c+m.utilization,0)/d.length,y=d.reduce((c,m)=>c+m.latency,0)/d.length;r.fillStyle=n.text,r.fillText(`Network Traffic Monitor - ${T.toUpperCase()} | Pattern: ${w}`,10,l.height-140),r.fillText(`Nodes: ${s} online | ${o} congested | ${e} error | Total: ${d.length}`,10,l.height-125),r.fillText(`Packets: ${i} active | Security Events: ${h} | Filter: ${k}`,10,l.height-110),r.fillText(`Average: ${u.toFixed(1)}% utilization | ${y.toFixed(1)}ms latency`,10,l.height-95),r.fillText(`Display: ${b} | Security Mode: ${N}`,10,l.height-80),E.current=requestAnimationFrame(z)};return D(),window.addEventListener("resize",D),M&&z(),()=>{window.removeEventListener("resize",D),E.current&&cancelAnimationFrame(E.current)}},[M,g,b,T,w,f,W,P,R,k,N]),t.jsxs("div",{className:"flex flex-col h-screen bg-black",children:[t.jsxs("div",{className:"flex-shrink-0 bg-gray-900 p-4 border-b border-gray-700",children:[t.jsx("h1",{className:"text-2xl font-bold text-green-400 mb-4",children:"🌐 ASCII Network Traffic Monitor"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 text-sm mb-4",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-green-300 mb-2",children:"Animation"}),t.jsx("button",{onClick:()=>q(!M),className:`px-3 py-2 rounded font-medium transition-colors ${M?"bg-red-600 hover:bg-red-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,children:M?"Pause":"Play"})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("label",{className:"text-green-300 mb-2",children:["Speed: ",g.toFixed(1),"x"]}),t.jsx("input",{type:"range",min:"0.1",max:"3",step:"0.1",value:g,onChange:l=>G(Number.parseFloat(l.target.value)),className:"w-full"})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-green-300 mb-2",children:"Topology"}),t.jsxs("select",{value:T,onChange:l=>O(l.target.value),className:"px-2 py-1 bg-gray-800 text-green-300 rounded border border-gray-600",children:[t.jsx("option",{value:"enterprise",children:"Enterprise"}),t.jsx("option",{value:"datacenter",children:"Datacenter"}),t.jsx("option",{value:"campus",children:"Campus"}),t.jsx("option",{value:"cloud",children:"Cloud Native"})]})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-green-300 mb-2",children:"Display Metric"}),t.jsxs("select",{value:b,onChange:l=>K(l.target.value),className:"px-2 py-1 bg-gray-800 text-green-300 rounded border border-gray-600",children:[t.jsx("option",{value:"utilization",children:"Utilization"}),t.jsx("option",{value:"latency",children:"Latency"}),t.jsx("option",{value:"packet_loss",children:"Packet Loss"}),t.jsx("option",{value:"bandwidth",children:"Bandwidth"})]})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-green-300 mb-2",children:"Traffic Pattern"}),t.jsxs("select",{value:w,onChange:l=>J(l.target.value),className:"px-2 py-1 bg-gray-800 text-green-300 rounded border border-gray-600",children:[t.jsx("option",{value:"normal",children:"Normal"}),t.jsx("option",{value:"high_traffic",children:"High Traffic"}),t.jsx("option",{value:"ddos_attack",children:"DDoS Attack"}),t.jsx("option",{value:"backup_window",children:"Backup Window"}),t.jsx("option",{value:"business_hours",children:"Business Hours"})]})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-green-300 mb-2",children:"Protocol Filter"}),t.jsxs("select",{value:k,onChange:l=>ee(l.target.value),className:"px-2 py-1 bg-gray-800 text-green-300 rounded border border-gray-600",children:[t.jsx("option",{value:"all",children:"All Protocols"}),t.jsx("option",{value:"TCP",children:"TCP"}),t.jsx("option",{value:"UDP",children:"UDP"}),t.jsx("option",{value:"HTTP",children:"HTTP"}),t.jsx("option",{value:"HTTPS",children:"HTTPS"}),t.jsx("option",{value:"SSH",children:"SSH"}),t.jsx("option",{value:"DNS",children:"DNS"})]})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-green-300 mb-2",children:"Color Scheme"}),t.jsxs("select",{value:f,onChange:l=>Q(l.target.value),className:"px-2 py-1 bg-gray-800 text-green-300 rounded border border-gray-600",children:[t.jsx("option",{value:"network",children:"Network Green"}),t.jsx("option",{value:"cisco",children:"Cisco Blue"}),t.jsx("option",{value:"security",children:"Security Red"}),t.jsx("option",{value:"datacenter",children:"Datacenter Cyan"}),t.jsx("option",{value:"terminal",children:"Terminal"})]})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-green-300 mb-2",children:"Security Mode"}),t.jsxs("select",{value:N,onChange:l=>te(l.target.value),className:"px-2 py-1 bg-gray-800 text-green-300 rounded border border-gray-600",children:[t.jsx("option",{value:"normal",children:"Normal"}),t.jsx("option",{value:"high_security",children:"High Security"}),t.jsx("option",{value:"under_attack",children:"Under Attack"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm mb-4",children:[t.jsxs("label",{className:"flex items-center text-green-300",children:[t.jsx("input",{type:"checkbox",checked:W,onChange:l=>X(l.target.checked),className:"mr-2"}),"Show Packet Flow"]}),t.jsxs("label",{className:"flex items-center text-green-300",children:[t.jsx("input",{type:"checkbox",checked:P,onChange:l=>Y(l.target.checked),className:"mr-2"}),"Show Security Events"]}),t.jsxs("label",{className:"flex items-center text-green-300",children:[t.jsx("input",{type:"checkbox",checked:R,onChange:l=>Z(l.target.checked),className:"mr-2"}),"Show Interface Details"]})]}),t.jsxs("div",{className:"mt-4 text-green-400 text-sm",children:[t.jsxs("p",{children:["🌐 ",t.jsx("strong",{children:"Real-time network traffic monitoring"})," with packet flow visualization and security events!"]}),t.jsxs("p",{children:["🔒 ",t.jsx("strong",{children:"Security analysis"})," - DDoS detection, intrusion monitoring, and firewall activity!"]}),t.jsxs("p",{children:["📊 ",t.jsx("strong",{children:"Multiple network topologies"})," with protocol filtering and latency/bandwidth monitoring!"]}),t.jsx("p",{children:"Monitor routers, switches, servers, clients with real-time packet flow and network interface statistics"})]})]}),t.jsx("div",{className:"flex-1 relative",children:t.jsx("canvas",{ref:L,className:"absolute inset-0 w-full h-full",style:{background:S[f].bg}})})]})};export{le as component};
