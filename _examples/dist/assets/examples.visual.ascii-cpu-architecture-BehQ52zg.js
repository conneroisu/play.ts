import{r as m,j as t,e as I}from"./index-BqTI3VMm.js";const se=function(){const H=m.useRef(null),L=m.useRef(0),P=m.useRef([]),R=m.useRef(new Map),U=m.useRef(new Map),[T,K]=m.useState(!0),[F,Q]=m.useState(1),[y,X]=m.useState("utilization"),[M,Y]=m.useState("x86_64"),[f,Z]=m.useState("mixed"),[_,J]=m.useState("intel"),[N,ee]=m.useState(!0),[E,te]=m.useState(!0),[k,ae]=m.useState(!1),[$,ie]=m.useState("normal"),[w,le]=m.useState("balanced"),S={intel:{bg:"#001144",core:"#0066CC",active:"#00AAFF",hot:"#FF6600",critical:"#FF0000",text:"#FFFFFF",cache:"#8888CC"},amd:{bg:"#220000",core:"#CC0000",active:"#FF4444",hot:"#FF8800",critical:"#FF0000",text:"#FFFFFF",cache:"#CC8888"},arm:{bg:"#002200",core:"#00CC00",active:"#44FF44",hot:"#FFAA00",critical:"#FF4444",text:"#FFFFFF",cache:"#88CC88"},risc:{bg:"#220022",core:"#CC00CC",active:"#FF44FF",hot:"#FFAA00",critical:"#FF4444",text:"#FFFFFF",cache:"#CC88CC"},thermal:{bg:"#000000",core:"#0000FF",active:"#00FF00",hot:"#FFFF00",critical:"#FF0000",text:"#FFFFFF",cache:"#888888"}};return m.useEffect(()=>{const o=[],a=new Map,g=new Map;let b=8,C=2,j=3.2;M==="x86_64"?(b=8,C=2,j=3.2):M==="amd_zen"?(b=16,C=2,j=3.8):M==="arm_big_little"?(b=8,C=1,j=2.8):M==="risc_v"&&(b=4,C=1,j=2);for(let v=0;v<b;v++){const z={id:`core-${v}`,name:`Core ${v}`,core_id:v,thread_count:C,frequency:j+(Math.random()-.5)*.4,utilization:Math.random()*30,temperature:35+Math.random()*15,cache_l1:32,cache_l2:256,cache_l3:4096/b,instructions_per_cycle:2+Math.random(),pipeline_stages:[{name:"FETCH",instruction:"MOV",progress:Math.random(),stalled:!1,type:"fetch"},{name:"DECODE",instruction:"ADD",progress:Math.random(),stalled:!1,type:"decode"},{name:"EXECUTE",instruction:"MUL",progress:Math.random(),stalled:!1,type:"execute"},{name:"MEMORY",instruction:"LOAD",progress:Math.random(),stalled:!1,type:"memory"},{name:"WRITEBACK",instruction:"STORE",progress:Math.random(),stalled:!1,type:"writeback"}],x:10+v%4*20,y:5+Math.floor(v/4)*12,status:"idle",power_state:"C0",branch_predictor_accuracy:90+Math.random()*10};o.push(z)}a.set("l1_data",{id:"l1_data",type:"L1_CACHE",bandwidth:1e3,utilization:0,latency:1,transactions:[]}),a.set("l2_unified",{id:"l2_unified",type:"L2_CACHE",bandwidth:500,utilization:0,latency:8,transactions:[]}),a.set("l3_shared",{id:"l3_shared",type:"L3_CACHE",bandwidth:200,utilization:0,latency:20,transactions:[]}),a.set("ddr_main",{id:"ddr_main",type:"DDR5",bandwidth:100,utilization:0,latency:80,transactions:[]}),g.set("alu_integer",{name:"Integer ALU",type:"ALU",utilization:0,throughput:4,queue_depth:0}),g.set("fpu_float",{name:"Floating Point",type:"FPU",utilization:0,throughput:2,queue_depth:0}),g.set("simd_vector",{name:"SIMD Vector",type:"SIMD",utilization:0,throughput:1,queue_depth:0}),g.set("branch_pred",{name:"Branch Predictor",type:"BRANCH",utilization:0,throughput:8,queue_depth:0}),g.set("load_store",{name:"Load/Store Unit",type:"LOAD_STORE",utilization:0,throughput:2,queue_depth:0}),P.current=o,R.current=a,U.current=g},[M]),m.useEffect(()=>{const o=H.current;if(!o)return;const a=o.getContext("2d");if(!a)return;const g=()=>{o.width=o.offsetWidth,o.height=o.offsetHeight},b=()=>{const l=P.current,i=R.current,c=U.current,s=Date.now()/1e3;l.forEach(e=>{var d;let n=e.utilization;f==="cpu_intensive"?n=70+25*Math.sin(s*.5+e.core_id)+Math.random()*10:f==="memory_bound"?(n=30+20*Math.sin(s*.8)+Math.random()*15,Math.random()<.3&&E&&((d=i.get("l1_data"))==null||d.transactions.push({id:`tx-${e.core_id}-${Date.now()}`,from_core:e.core_id,address:`0x${Math.floor(Math.random()*65535).toString(16).padStart(4,"0")}`,type:Math.random()<.7?"read":"write",size:64,progress:0,priority:Math.floor(Math.random()*4)}))):f==="floating_point"?(n=50+40*Math.sin(s*1.2)+Math.random()*10,c.get("fpu_float").utilization=Math.min(100,n+20)):f==="vector_simd"?(n=40+30*Math.sin(s*.9)+Math.random()*15,c.get("simd_vector").utilization=Math.min(100,n+30)):f==="branch_heavy"?(n=60+20*Math.sin(s*2)+Math.random()*20,e.branch_predictor_accuracy=85+10*Math.sin(s*.3)):n=30+30*Math.sin(s*.4+e.core_id*.5)+Math.random()*20,w==="performance"?e.frequency=Math.min(5,e.frequency*1.1):w==="powersave"?(e.frequency=Math.max(1,e.frequency*.9),n*=.7):w==="ondemand"&&(n>70?e.frequency=Math.min(4.5,e.frequency+.1):n<30&&(e.frequency=Math.max(1.5,e.frequency-.05))),e.utilization=I(n,0,100);const r=$==="hot"?1.5:$==="overheating"?2:1,u=35,p=e.utilization/100*40*r,A=e.frequency/4*15;e.temperature=I(u+p+A+(Math.random()-.5)*3,25,105),e.temperature>95?(e.status="overheating",e.power_state="C6",e.utilization*=.5):e.temperature>85?(e.status="throttling",e.utilization*=.8):e.utilization>10?(e.status="active",e.power_state="C0"):(e.status="idle",e.power_state=Math.random()<.3?"C1":"C0"),N&&e.pipeline_stages.forEach((h,B)=>{if(e.status==="active"){if(h.progress+=(.1+Math.random()*.1)*F,h.progress>=1){h.progress=0;const x=["MOV","ADD","SUB","MUL","DIV","LOAD","STORE","JMP","CALL","RET"];h.instruction=x[Math.floor(Math.random()*x.length)]}h.stalled=Math.random()<.05&&h.type==="memory"}else h.progress=0,h.stalled=!1}),e.instructions_per_cycle=I(2+e.branch_predictor_accuracy/100+(Math.random()-.5)*.5,.5,4)}),i.forEach(e=>{if(e.transactions=e.transactions.filter(n=>(n.progress+=.1*F,n.progress<1)),e.utilization=Math.min(100,e.transactions.length/10*100),Math.random()<.1*F&&E){const n=l.filter(r=>r.status==="active");if(n.length>0){const r=n[Math.floor(Math.random()*n.length)];e.transactions.push({id:`tx-${e.id}-${Date.now()}`,from_core:r.core_id,address:`0x${Math.floor(Math.random()*16777215).toString(16).padStart(6,"0")}`,type:Math.random()<.6?"read":Math.random()<.8?"write":"prefetch",size:64*(1+Math.floor(Math.random()*4)),progress:0,priority:Math.floor(Math.random()*4)})}}}),c.forEach(e=>{const n=l.filter(u=>u.status==="active"),r=n.reduce((u,p)=>u+p.utilization,0)/Math.max(1,n.length);e.type==="ALU"?e.utilization=r*.8:e.type==="FPU"?e.utilization=f==="floating_point"?r:r*.3:e.type==="SIMD"?e.utilization=f==="vector_simd"?r:r*.2:e.type==="BRANCH"?e.utilization=f==="branch_heavy"?r:r*.4:e.type==="LOAD_STORE"&&(e.utilization=f==="memory_bound"?r*1.2:r*.6),e.utilization=I(e.utilization,0,100),e.queue_depth=Math.floor(e.utilization/25)})},C=(l,i)=>l.status==="overheating"?i.critical:l.status==="throttling"?i.hot:l.status==="active"?i.active:i.core,j=(l,i)=>{const c=l.x*i,s=l.y*i,e=S[_];a.fillStyle=C(l,e),["┌─────────┐","│ ███████ │","│ ███ ███ │","│ ███ ███ │","└─────────┘"].forEach((x,O)=>{a.fillText(x,c,s+O*i)}),a.fillStyle=e.text,a.fillText(l.name,c+i,s-i),a.fillText(`${l.frequency.toFixed(1)}GHz`,c+i*12,s-i),a.fillText(`${l.thread_count}T`,c+i*18,s-i),a.fillStyle=l.power_state==="C0"?e.active:e.core,a.fillText(l.power_state,c-i*2,s);let r=0,u="%",p="";switch(y){case"utilization":r=l.utilization,p="CPU";break;case"temperature":r=l.temperature,u="°C",p="TMP";break;case"frequency":r=l.frequency,u="GHz",p="FREQ";break;case"ipc":r=l.instructions_per_cycle,u="IPC",p="PERF";break}const A=8,h=r/(y==="temperature"?100:y==="frequency"?5:y==="ipc"?4:100),B=Math.floor(h*A);if(a.fillStyle=e.text+"40",a.fillText("█".repeat(A),c+i,s+i*5.5),B>0){let x=e.core;y==="temperature"?x=r>85?e.critical:r>70?e.hot:e.active:x=h>.9?e.critical:h>.7?e.hot:e.active,a.fillStyle=x,a.fillText("█".repeat(B),c+i,s+i*5.5)}a.fillStyle=e.text,a.fillText(`${p}: ${r.toFixed(y==="ipc"?1:0)}${u}`,c+i*10,s+i*5.5),N&&l.pipeline_stages.forEach((x,O)=>{const q=s+i*(1+O*.7),D=c+i*12;a.fillStyle=x.stalled?e.critical:x.progress>.5?e.active:e.core,a.fillText(x.name.substr(0,3),D,q),a.fillText(x.instruction,D+i*4,q);const W=6,G=Math.floor(x.progress*W);a.fillStyle=e.text+"40",a.fillText("─".repeat(W),D+i*8,q),G>0&&!x.stalled&&(a.fillStyle=e.active,a.fillText("█".repeat(G),D+i*8,q))}),a.fillStyle=e.cache,a.fillText(`L1:${l.cache_l1}K`,c,s+i*6.5),a.fillText(`L2:${l.cache_l2}K`,c+i*6,s+i*6.5)},v=l=>{if(!E)return;const i=S[_];Array.from(R.current.values()).forEach((s,e)=>{const n=10*l,r=(35+e*3)*l;a.fillStyle=i.text,a.fillText(`${s.type} Bus`,n,r),a.fillText(`${s.bandwidth}GB/s`,n+l*10,r),a.fillText(`${s.latency}cy`,n+l*16,r);const u=12,p=Math.floor(s.utilization/100*u);a.fillStyle=i.text+"40",a.fillText("█".repeat(u),n,r+l),p>0&&(a.fillStyle=s.utilization>80?i.critical:s.utilization>60?i.hot:i.active,a.fillText("█".repeat(p),n,r+l)),a.fillStyle=i.text,a.fillText(`${s.utilization.toFixed(0)}%`,n+l*13,r+l),a.fillText(`${s.transactions.length} tx`,n+l*18,r+l)})},z=l=>{if(!k)return;const i=S[_];Array.from(U.current.values()).forEach((s,e)=>{const n=50*l,r=(5+e*4)*l;a.fillStyle=i.text,a.fillText(s.name,n,r),a.fillText(`${s.throughput} ops/cy`,n+l*12,r);const u=10,p=Math.floor(s.utilization/100*u);a.fillStyle=i.text+"40",a.fillText("█".repeat(u),n,r+l),p>0&&(a.fillStyle=s.utilization>80?i.critical:s.utilization>60?i.hot:i.active,a.fillText("█".repeat(p),n,r+l)),a.fillStyle=i.text,a.fillText(`${s.utilization.toFixed(0)}%`,n+l*11,r+l),s.queue_depth>0&&(a.fillStyle=i.hot,a.fillText(`Q:${s.queue_depth}`,n,r+l*2))})},V=()=>{if(!T)return;const l=S[_],i=10;a.fillStyle=l.bg,a.fillRect(0,0,o.width,o.height),a.font='10px "Courier New", monospace',a.textBaseline="top",Math.random()<.1*F&&b(),P.current.forEach(d=>{j(d,i)}),v(i),z(i);const c=P.current,s=c.filter(d=>d.status==="active").length,e=c.filter(d=>d.status==="overheating").length,n=c.reduce((d,h)=>d+h.utilization,0)/c.length,r=c.reduce((d,h)=>d+h.temperature,0)/c.length,u=c.reduce((d,h)=>d+h.frequency,0)/c.length,p=c.reduce((d,h)=>d+h.instructions_per_cycle,0)/c.length;a.fillStyle=l.text,a.fillText(`CPU Architecture: ${M.toUpperCase()} | Workload: ${f}`,10,o.height-120),a.fillText(`Cores: ${s}/${c.length} active | ${e} overheating | Thermal: ${$}`,10,o.height-105),a.fillText(`Average: ${n.toFixed(1)}% utilization | ${r.toFixed(0)}°C | ${u.toFixed(1)}GHz`,10,o.height-90),a.fillText(`Performance: ${p.toFixed(2)} IPC | Power: ${w} | Display: ${y}`,10,o.height-75);const A=Array.from(R.current.values()).reduce((d,h)=>d+h.transactions.length,0);a.fillText(`Memory: ${A} active transactions | Pipeline: ${N?"visible":"hidden"}`,10,o.height-60),L.current=requestAnimationFrame(V)};return g(),window.addEventListener("resize",g),T&&V(),()=>{window.removeEventListener("resize",g),L.current&&cancelAnimationFrame(L.current)}},[T,F,y,M,f,_,N,E,k,$,w]),t.jsxs("div",{className:"flex flex-col h-screen bg-black",children:[t.jsxs("div",{className:"flex-shrink-0 bg-gray-900 p-4 border-b border-gray-700",children:[t.jsx("h1",{className:"text-2xl font-bold text-blue-400 mb-4",children:"🔬 ASCII CPU Architecture Monitor"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 text-sm mb-4",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-blue-300 mb-2",children:"Animation"}),t.jsx("button",{onClick:()=>K(!T),className:`px-3 py-2 rounded font-medium transition-colors ${T?"bg-red-600 hover:bg-red-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,children:T?"Pause":"Play"})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("label",{className:"text-blue-300 mb-2",children:["Speed: ",F.toFixed(1),"x"]}),t.jsx("input",{type:"range",min:"0.1",max:"3",step:"0.1",value:F,onChange:o=>Q(Number.parseFloat(o.target.value)),className:"w-full"})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-blue-300 mb-2",children:"Architecture"}),t.jsxs("select",{value:M,onChange:o=>Y(o.target.value),className:"px-2 py-1 bg-gray-800 text-blue-300 rounded border border-gray-600",children:[t.jsx("option",{value:"x86_64",children:"x86-64 Intel"}),t.jsx("option",{value:"amd_zen",children:"AMD Zen"}),t.jsx("option",{value:"arm_big_little",children:"ARM Big.LITTLE"}),t.jsx("option",{value:"risc_v",children:"RISC-V"})]})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-blue-300 mb-2",children:"Display Metric"}),t.jsxs("select",{value:y,onChange:o=>X(o.target.value),className:"px-2 py-1 bg-gray-800 text-blue-300 rounded border border-gray-600",children:[t.jsx("option",{value:"utilization",children:"CPU Utilization"}),t.jsx("option",{value:"temperature",children:"Temperature"}),t.jsx("option",{value:"frequency",children:"Frequency"}),t.jsx("option",{value:"ipc",children:"Instructions/Cycle"})]})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-blue-300 mb-2",children:"Workload Type"}),t.jsxs("select",{value:f,onChange:o=>Z(o.target.value),className:"px-2 py-1 bg-gray-800 text-blue-300 rounded border border-gray-600",children:[t.jsx("option",{value:"mixed",children:"Mixed Workload"}),t.jsx("option",{value:"cpu_intensive",children:"CPU Intensive"}),t.jsx("option",{value:"memory_bound",children:"Memory Bound"}),t.jsx("option",{value:"floating_point",children:"Floating Point"}),t.jsx("option",{value:"vector_simd",children:"Vector/SIMD"}),t.jsx("option",{value:"branch_heavy",children:"Branch Heavy"})]})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-blue-300 mb-2",children:"Color Scheme"}),t.jsxs("select",{value:_,onChange:o=>J(o.target.value),className:"px-2 py-1 bg-gray-800 text-blue-300 rounded border border-gray-600",children:[t.jsx("option",{value:"intel",children:"Intel Blue"}),t.jsx("option",{value:"amd",children:"AMD Red"}),t.jsx("option",{value:"arm",children:"ARM Green"}),t.jsx("option",{value:"risc",children:"RISC Purple"}),t.jsx("option",{value:"thermal",children:"Thermal View"})]})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-blue-300 mb-2",children:"Thermal State"}),t.jsxs("select",{value:$,onChange:o=>ie(o.target.value),className:"px-2 py-1 bg-gray-800 text-blue-300 rounded border border-gray-600",children:[t.jsx("option",{value:"normal",children:"Normal"}),t.jsx("option",{value:"hot",children:"Hot Environment"}),t.jsx("option",{value:"overheating",children:"Overheating"})]})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-blue-300 mb-2",children:"Power Management"}),t.jsxs("select",{value:w,onChange:o=>le(o.target.value),className:"px-2 py-1 bg-gray-800 text-blue-300 rounded border border-gray-600",children:[t.jsx("option",{value:"balanced",children:"Balanced"}),t.jsx("option",{value:"performance",children:"Performance"}),t.jsx("option",{value:"powersave",children:"Power Save"}),t.jsx("option",{value:"ondemand",children:"On Demand"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm mb-4",children:[t.jsxs("label",{className:"flex items-center text-blue-300",children:[t.jsx("input",{type:"checkbox",checked:N,onChange:o=>ee(o.target.checked),className:"mr-2"}),"Show Pipeline Stages"]}),t.jsxs("label",{className:"flex items-center text-blue-300",children:[t.jsx("input",{type:"checkbox",checked:E,onChange:o=>te(o.target.checked),className:"mr-2"}),"Show Memory Subsystem"]}),t.jsxs("label",{className:"flex items-center text-blue-300",children:[t.jsx("input",{type:"checkbox",checked:k,onChange:o=>ae(o.target.checked),className:"mr-2"}),"Show Execution Units"]})]}),t.jsxs("div",{className:"mt-4 text-blue-400 text-sm",children:[t.jsxs("p",{children:["🔬 ",t.jsx("strong",{children:"Deep CPU architecture visualization"})," with real-time pipeline stages and memory subsystem!"]}),t.jsxs("p",{children:["⚡ ",t.jsx("strong",{children:"Multiple architectures"})," - Intel x86-64, AMD Zen, ARM Big.LITTLE, and RISC-V!"]}),t.jsxs("p",{children:["🌡️ ",t.jsx("strong",{children:"Thermal and power management"})," with frequency scaling, thermal throttling, and power states!"]}),t.jsx("p",{children:"Monitor instruction pipelines, cache hierarchies, execution units, and memory bus utilization in real-time"})]})]}),t.jsx("div",{className:"flex-1 relative",children:t.jsx("canvas",{ref:H,className:"absolute inset-0 w-full h-full",style:{background:S[_].bg}})})]})};export{se as component};
