var O=Math.PI*2,Q=Math.PI/2,U=Math.PI/4;var W=(1+Math.sqrt(5))/2;var y=(r,t)=>({x:r,y:t}),m=(r,t)=>({x:r.x+t.x,y:r.y+t.y}),p=(r,t)=>({x:r.x-t.x,y:r.y-t.y}),c=(r,t)=>({x:r.x*t===-0?0:r.x*t,y:r.y*t===-0?0:r.y*t});var e=(r)=>{return Math.sqrt(r.x*r.x+r.y*r.y)};var z=(r)=>{let t=r.x*r.x+r.y*r.y;if(t===0)return y(0,0);if(!isFinite(t))return y(NaN,NaN);let o=Math.sqrt(t);return{x:r.x/o,y:r.y/o}},N=(r,t)=>{let o=r.x-t.x,n=r.y-t.y;return Math.sqrt(o*o+n*n)};var A=(r=1,t=9.81)=>y(0,r*t),B=(r,t=0.1)=>c(r,-t),G=(r,t=0.01)=>{let o=e(r);return c(z(r),-t*o*o)},h=(r,t,o=1,n=1,b=1)=>{let u=p(t,r),x=e(u);if(x===0)return y(0,0);let V=b*o*n/(x*x);return c(z(u),V)},F=(r,t,o=1,n=1,b=1)=>{let u=h(r,t,o,n,b);return c(u,-1)},R=(r,t,o,n=0.1,b=0.99)=>{let u=p(t,r),x=e(u),V=x-o;if(x===0)return y(0,0);let M=V*n;return c(z(u),M*b)};class P{position;velocity;acceleration;mass;lifetime;maxLifetime;isDead;constructor(r=0,t=0,o=0,n=0,b=1,u=1/0){this.position=y(r,t),this.velocity=y(o,n),this.acceleration=y(0,0),this.mass=b,this.lifetime=u,this.maxLifetime=u,this.isDead=!1}addForce(r){let t=c(r,1/this.mass);this.acceleration=m(this.acceleration,t)}update(r=1){if(this.velocity=m(this.velocity,c(this.acceleration,r)),this.position=m(this.position,c(this.velocity,r)),this.acceleration=y(0,0),this.lifetime!==1/0){if(this.lifetime-=r,this.lifetime<=0)this.isDead=!0}}distanceTo(r){return N(this.position,r.position)}attractTo(r,t=1){let o=h(this.position,r.position,this.mass,r.mass,t);this.addForce(o)}repelFrom(r,t=1){let o=F(this.position,r.position,this.mass,r.mass,t);this.addForce(o)}applySpring(r,t=0,o=0.1){let n=R(this.position,r,t,o);this.addForce(n)}getAge(){return this.maxLifetime-this.lifetime}getAgeRatio(){if(this.maxLifetime===1/0)return 0;return this.getAge()/this.maxLifetime}}class _{particles;forces;constructor(){this.particles=[],this.forces=[]}addParticle(r){this.particles.push(r)}addForce(r){this.forces.push(r)}update(r=1){for(let t=0;t<this.particles.length;t++){let o=this.particles[t];for(let n of this.forces)o.addForce(n(o,t,this.particles));o.update(r)}this.particles=this.particles.filter((t)=>!t.isDead)}getParticles(){return this.particles}getAliveCount(){return this.particles.length}clear(){this.particles=[]}}class D{position;oldPosition;acceleration;mass;pinned;constructor(r=0,t=0,o=1){this.position=y(r,t),this.oldPosition=y(r,t),this.acceleration=y(0,0),this.mass=o,this.pinned=!1}addForce(r){let t=c(r,1/this.mass);this.acceleration=m(this.acceleration,t)}update(r=1){if(this.pinned)return;let t=p(this.position,this.oldPosition);this.oldPosition={...this.position};let o=r*r,n=c(this.acceleration,o);this.position=m(m(this.position,t),n),this.acceleration=y(0,0)}pin(){this.pinned=!0}unpin(){this.pinned=!1}}class q{p1;p2;restLength;stiffness;constructor(r,t,o=1){this.p1=r,this.p2=t,this.restLength=N(r.position,t.position),this.stiffness=o}update(){let r=p(this.p2.position,this.p1.position),t=e(r);if(t===0)return;let o=(this.restLength-t)/t,n=c(r,o*0.5*this.stiffness);if(!this.p1.pinned)this.p1.position=p(this.p1.position,n);if(!this.p2.pinned)this.p2.position=m(this.p2.position,n)}}class H{particles;constraints;width;height;constructor(r,t,o=10,n=1){this.width=r,this.height=t,this.particles=[],this.constraints=[];let b=Math.floor(r/o),u=Math.floor(t/o);for(let x=0;x<=u;x++){this.particles[x]=[];for(let V=0;V<=b;V++){let M=V/b*r,I=x/u*t;this.particles[x][V]=new D(M,I)}}for(let x=0;x<=u;x++)for(let V=0;V<=b;V++){let M=this.particles[x][V];if(V<b)this.constraints.push(new q(M,this.particles[x][V+1],n));if(x<u)this.constraints.push(new q(M,this.particles[x+1][V],n))}}update(){for(let r of this.particles)for(let t of r)t.update();for(let r=0;r<3;r++)for(let t of this.constraints)t.update()}pinCorners(){let r=this.particles.length-1,t=this.particles[0].length-1;this.particles[0][0].pin(),this.particles[0][t].pin()}addWind(r){for(let t of this.particles)for(let o of t)o.addForce(r)}addGravity(r=0.1){for(let t of this.particles)for(let o of t)o.addForce(y(0,r))}}var J=(r,t,o,n=0)=>{let b=r.x+Math.cos(n)*t,u=r.y+Math.sin(n)*t,x=-Math.sin(n)*o,V=Math.cos(n)*o;return{position:y(b,u),velocity:y(x,V)}},K=(r,t,o=1,n=5,b=100)=>{let u=[];for(let x=0;x<t;x++){let V=x/t*Math.PI*2,M=o+Math.random()*(n-o),I=Math.cos(V)*M,E=Math.sin(V)*M;u.push(new P(r.x,r.y,I,E,1,b+Math.random()*b*0.5))}return u};export{R as springForce,F as repulsion,A as gravity,B as friction,G as drag,J as createOrbit,K as createExplosion,h as attraction,D as VerletParticle,q as VerletConstraint,_ as ParticleSystem,P as Particle,H as Cloth};
